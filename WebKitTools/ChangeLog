2010-07-07  Tor Arne Vestbø  <tor.arne.vestbo@nokia.com>

        Reviewed by Darin Adler.

        Prevent assertion/duplicate loads for non-deferred subtitute-data loads

        https://bugs.webkit.org/show_bug.cgi?id=30879

        MainResourceLoader uses the member m_initialRequest to store requests for future
        deferred loads. When doing the actual load in handleDataLoadNow(), we therefore
        have to clear this request so that subsequent entries into the loader will not
        start yet another load.

        This can happen as a result of a PageGroupLoadDeferrer going out of scope when
        returning from Chrome::runJavaScriptAlert(), which calls setDeferredLoading(false),
        but only in the case of using both substitute-data and non-deferred main resource
        load together. That's why two new DRT functions were added:

         * queueLoadHTMLString()
         * setDeferMainResourceLoad()

        The change adds DRT hooks for Mac, Win and Qt for these two functions. For Mac
        and Win the hook uses new SPI in WebDataSource. For Qt a new static member was
        added to the FrameLoaderClientQt and accessed though DumpRenderTreeSupportQt.

        * DumpRenderTree/LayoutTestController.cpp:
        (LayoutTestController::LayoutTestController):
        (queueLoadHTMLStringCallback):
        (setDeferMainResourceDataLoadCallback):
        (LayoutTestController::staticFunctions):
        (LayoutTestController::queueLoadHTMLString):
        * DumpRenderTree/LayoutTestController.h:
        (LayoutTestController::deferMainResourceDataLoad):
        (LayoutTestController::setDeferMainResourceDataLoad):
        * DumpRenderTree/WorkQueueItem.h:
        (LoadHTMLStringItem::LoadHTMLStringItem):
        * DumpRenderTree/gtk/WorkQueueItemGtk.cpp:
        (LoadHTMLStringItem::invoke):
        * DumpRenderTree/mac/ResourceLoadDelegate.mm:
        (-[ResourceLoadDelegate webView:resource:willSendRequest:redirectResponse:fromDataSource:]):
        * DumpRenderTree/mac/WorkQueueItemMac.mm:
        (LoadHTMLStringItem::invoke):
        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::reset):
        (LayoutTestController::setDeferMainResourceDataLoad):
        (LayoutTestController::queueLoadHTMLString):
        * DumpRenderTree/qt/LayoutTestControllerQt.h:
        * DumpRenderTree/qt/WorkQueueItemQt.cpp:
        (LoadHTMLStringItem::invoke):
        * DumpRenderTree/qt/WorkQueueItemQt.h:
        (LoadHTMLStringItem::LoadHTMLStringItem):
        * DumpRenderTree/win/ResourceLoadDelegate.cpp:
        (ResourceLoadDelegate::willSendRequest):
        * DumpRenderTree/win/WorkQueueItemWin.cpp:
        (LoadHTMLStringItem::invoke):
        * DumpRenderTree/wx/WorkQueueItemWx.cpp:
        (LoadHTMLStringItem::invoke):

2010-07-13  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Nikolas Zimmermann.

        Activate test fonts for layout tests in WebKitTestRunner (on Mac)
        https://bugs.webkit.org/show_bug.cgi?id=42153

        * WebKitTestRunner/InjectedBundle/ActivateFonts.h: Added.
        * WebKitTestRunner/InjectedBundle/InjectedBundle.cpp:
        (WTR::InjectedBundle::initialize): Activate fonts on startup.
        * WebKitTestRunner/InjectedBundle/mac: Added.
        * WebKitTestRunner/InjectedBundle/mac/ActivateFonts.mm: Added.
        (WTR::activateFonts): Activate our fonts.
        * WebKitTestRunner/InjectedBundle/win: Added.
        * WebKitTestRunner/InjectedBundle/win/ActivateFonts.cpp: Added.
        (WTR::activateFonts): Dummy version.
        * WebKitTestRunner/WebKitTestRunner.xcodeproj/project.pbxproj: Copy fonts to bundle;
        add more files.
        * WebKitTestRunner/fonts: Added.
        * WebKitTestRunner/fonts/AHEM____.TTF: Added.
        * WebKitTestRunner/fonts/ColorBits-A.png: Added.
        * WebKitTestRunner/fonts/ColorBits.ttf: Added.
        * WebKitTestRunner/fonts/WebKit Layout Tests 2.ttf: Added.
        * WebKitTestRunner/fonts/WebKit Layout Tests.ttf: Added.
        * WebKitTestRunner/fonts/WebKitWeightWatcher100.ttf: Added.
        * WebKitTestRunner/fonts/WebKitWeightWatcher200.ttf: Added.
        * WebKitTestRunner/fonts/WebKitWeightWatcher300.ttf: Added.
        * WebKitTestRunner/fonts/WebKitWeightWatcher400.ttf: Added.
        * WebKitTestRunner/fonts/WebKitWeightWatcher500.ttf: Added.
        * WebKitTestRunner/fonts/WebKitWeightWatcher600.ttf: Added.
        * WebKitTestRunner/fonts/WebKitWeightWatcher700.ttf: Added.
        * WebKitTestRunner/fonts/WebKitWeightWatcher800.ttf: Added.
        * WebKitTestRunner/fonts/WebKitWeightWatcher900.ttf: Added.

2010-07-13  Dumitru Daniliuc  <dumi@chromium.org>

        Reviewed by Eric Seidel.

        Remove check-header-includes, as it didn't turn out to be very useful.
        https://bugs.webkit.org/show_bug.cgi?id=41970

        * Scripts/check-header-includes: Removed.

2010-07-12  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Maciej Stachowiak.

        Make WebKit2 be built by build-webkit (so it will be built by build.webkit.org bots)
        https://bugs.webkit.org/show_bug.cgi?id=40922
        
        Always build WebKit2 on Windows. Necessary since our WebKit build on
        Windows is packaged into a DLL with WebKit2.

        * Scripts/build-webkit: Always build WebKit2 on Windows.

2010-07-12  Brian Weinstein  <bweinstein@apple.com>

        Reviewed by Steve Falkenburg.

        One http test timing out on Windows can cause all future tests to time out
        https://bugs.webkit.org/show_bug.cgi?id=42146
        
        There have been multiple times on the Windows bots where one http test timing out causes all future
        http tests to time out. This is because the httpd process becomes unresponsive. When an http test
        times out, we should restart httpd on Cygwin to prevent this.

        * Scripts/old-run-webkit-tests: If an http test timed out on Cygwin, close httpd and restart it.
        * Scripts/webkitperl/httpd.pm: Add additional logic to closeHTTPD to teach it about taskkill if
            using kill fails.

2010-07-12  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Dan Bernstein.

        Remove use of auto_ptr in WebKitTestRunner
        https://bugs.webkit.org/show_bug.cgi?id=42134
        
        Replaced auto_ptr with PassOwnPtr / OwnPtr.

        * WebKitTestRunner/InjectedBundle/InjectedBundlePage.cpp:
        (WTR::WKStringToUTF8):
        (WTR::InjectedBundlePage::dump):
        (WTR::InjectedBundlePage::addMessageToConsole):
        * WebKitTestRunner/TestInvocation.cpp:
        (WTR::WKStringToUTF8):
        (WTR::TestInvocation::didRecieveMessageFromInjectedBundle):

2010-07-12  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Sam Weinig.

        Need support for a WebKit2-specific Skipped list (and initially add accessibility tests to it)
        https://bugs.webkit.org/show_bug.cgi?id=42132

        * Scripts/old-run-webkit-tests: In --webkit-test-runner mode, add mac-wk2 to list of
        platform directories.

2010-07-12  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Anders Carlsson.

        Make WebKitTestRunner resize the view specially for the W3C SVG tests.
        https://bugs.webkit.org/show_bug.cgi?id=42126

        * WebKitTestRunner/PlatformWebView.h:
        * WebKitTestRunner/TestInvocation.cpp:
        (WTR::TestInvocation::TestInvocation): Store the path as a C
        string for later use.
        (WTR::TestInvocation::~TestInvocation):
        (WTR::sizeWebViewForCurrentTest): Resize the WebView to the proper
        size, depending on whether this is a W3C SVG test.
        (WTR::TestInvocation::invoke): Call the size function.
        * WebKitTestRunner/TestInvocation.h:
        * WebKitTestRunner/mac/PlatformWebViewMac.mm:
        (WTR::PlatformWebView::resizeTo): Implement.
        * WebKitTestRunner/win/PlatformWebViewWin.cpp:
        (WTR::PlatformWebView::resizeTo): Placeholder.

2010-07-12  Mario Sanchez Prada  <msanchez@igalia.com>

        Reviewed by Xan Lopez.

        Ensure DRT loads GAIL (Gtk+ module), for a11y tests
        https://bugs.webkit.org/show_bug.cgi?id=38648

        Add the GTK_MODULES envvar (set to "gail") to the clean
        environment when running DRT for the Gtk+ port

        * Scripts/old-run-webkit-tests:

2010-07-12  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Dirk Schulze.

        [GTK] Support pixel tests
        https://bugs.webkit.org/show_bug.cgi?id=31518

        Finish support for pixel tests on GTK+.

        * DumpRenderTree/PixelDumpSupport.cpp: Remove unecessary RetainPtr include (only
        works on CoreFoundation systems) and add missing cstdio include.
        * DumpRenderTree/cairo/PixelDumpSupportCairo.cpp: Switch to using the MD5 support found
        in JSC library. MD5.cpp and MD5.h are only available for the Windows build.
        (computeMD5HashStringForBitmapContext): The number of bytes per row should be the row stride
        of the image, not the row stride multiplied by the width. Use JSC MD5 implementation to calculate
        the MD5 hash here. According to glibc manpages, using snprintf to build a string in unsupported
        by the ANSI standard and this fails on Linux, so unroll the loop here.
        * DumpRenderTree/cairo/PixelDumpSupportCairo.h: Correct some constructor misbehavior.
        (BitmapContext::BitmapContext): There is no reason to check the value of the
        m_context member in the constructor and it certainly should not be freed. Instead
        just initialize it with the incoming value.
        * DumpRenderTree/gtk/DumpRenderTree.cpp: Fix the order of includes.
        (dump): Actually call dumpWebViewAsPixelsAndCompareWithExpected when it is time to
        dump pixels.
        * DumpRenderTree/gtk/PixelDumpSupportGtk.cpp: Added.
        (createBitmapContextFromWebView):
        * GNUmakefile.am: Add new files to the build.

2010-07-12  Adam Barth  <abarth@webkit.org>

        Unreviewed.

        Remove stray "raise e" that got included in a previous patch.  This
        caused the EWS bots to turn red instead of purple when a patch failed
        to apply.

        * Scripts/webkitpy/tool/commands/stepsequence.py:

2010-07-12  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r63101.
        http://trac.webkit.org/changeset/63101
        https://bugs.webkit.org/show_bug.cgi?id=42103

        Broke one API test (Requested by xan_ on #webkit).

        * Scripts/old-run-webkit-tests:

2010-07-12  Alexey Proskuryakov  <ap@apple.com>

        Reviewed by Adam Roben.

        https://bugs.webkit.org/show_bug.cgi?id=13075
        XMLHttpRequest with failed authentication should set status to 401

        https://bugs.webkit.org/show_bug.cgi?id=6871
        <rdar://problem/3363403> 401 error page is never shown

        Fix crashes in Windows DumpRenderTree.

        * DumpRenderTree/win/ResourceLoadDelegate.cpp: (ResourceLoadDelegate::didReceiveAuthenticationChallenge):
        If we return an error, WebKit will call continueWithoutCredentialForAuthenticationChallenge()
        again on a destroyed sender.

2010-07-12  Adam Roben  <aroben@apple.com>

        Windows failure-to-launch fix

        * DumpRenderTree/win/DumpRenderTree.vcproj: Copy CoreVideo.dll and
        CoreVideo.pdb into WebKitOutputDir in the post-build event, too, like
        we already do for CoreFoundation, CFNetwork, etc.

2010-07-12  Mario Sanchez Prada  <msanchez@igalia.com>

        Reviewed by Xan Lopez.

        Ensure DRT loads GAIL (Gtk+ module), for a11y tests
        https://bugs.webkit.org/show_bug.cgi?id=38648

        Add the GTK_MODULES envvar (set to "gail") to the clean
        environment when running DRT for the Gtk+ port

        * Scripts/old-run-webkit-tests:

2010-07-09  Alexey Proskuryakov  <ap@apple.com>

        Reviewed by Darin Adler.

        https://bugs.webkit.org/show_bug.cgi?id=13075
        XMLHttpRequest with failed authentication should set status to 401

        https://bugs.webkit.org/show_bug.cgi?id=6871
        <rdar://problem/3363403> 401 error page is never shown

        * DumpRenderTree/mac/ResourceLoadDelegate.mm:
        (-[ResourceLoadDelegate webView:resource:didReceiveAuthenticationChallenge:fromDataSource:]):
        * DumpRenderTree/win/ResourceLoadDelegate.cpp:
        (ResourceLoadDelegate::didReceiveAuthenticationChallenge):
        Do respond even if handlesAuthenticationChallenges() is false. Pretend that the user pressed
        the Cancel button.

2010-07-12  Andreas Kling  <andreas.kling@nokia.com>

        Reviewed by Tor Arne Vestbø.

        [Qt] Add location bar (Ctrl+L) shortcut in QtTestBrowser
        https://bugs.webkit.org/show_bug.cgi?id=42082

        * QtTestBrowser/main.cpp:
        (LauncherWindow::createChrome):
        * QtTestBrowser/mainwindow.cpp:
        (MainWindow::openLocation):
        * QtTestBrowser/mainwindow.h:

2010-07-12  Adam Roben  <aroben@apple.com>

        Make the Python autoinstaller not use a dead SourceForge server

        Fixes <http://webkit.org/b/42080> webkit-patch is broken due to
        offline SourceForge server

        Reviewed by Anders Carlsson.

        * Scripts/webkitpy/thirdparty/__init__.py: Use
        surfnet.dl.sourceforge.net instead of hivelocity.dl.sourceforge.net,
        which seems to be down.

2010-07-12  Adam Roben  <aroben@apple.com>

        Make run-webkit-tests print how many tests timed out when exiting
        early

        The number of timed-out tests is taken into account when deciding
        whether to exit early. Leaving it out of the output just makes the
        script look buggy (because it might say something like "Exiting early
        after 0 crashes.").

        Fixes <http://webkit.org/b/42077> run-webkit-tests prints confusing
        messages when exiting early due to crashes and time-outs

        Reviewed by Anders Carlsson.

        * Scripts/old-run-webkit-tests:
        (stopRunningTestsEarlyIfNeeded): When stopping, print the number of
        timed-out tests, too.

2010-07-11  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Dan Bernstein.

        Implement animation-related methods for WebKitTestRunner
        https://bugs.webkit.org/show_bug.cgi?id=42053
        
        Implemented numberOfActiveAnimatiosn and pauseAnimationAtTimeOnElementWithId. Many
        animation tests were hanging otherwise.

        * WebKitTestRunner/InjectedBundle/LayoutTestController.cpp:
        (WTR::LayoutTestController::numberOfActiveAnimations):
        (WTR::LayoutTestController::pauseAnimationAtTimeOnElementWithId):
        (WTR::numberOfActiveAnimationsCallback):
        (WTR::pauseAnimationAtTimeOnElementWithIdCallback):
        (WTR::LayoutTestController::staticFunctions):
        * WebKitTestRunner/InjectedBundle/LayoutTestController.h:

2010-07-11  Daniel Bates  <dbates@rim.com>

        Reviewed by David Kilzer.

        Enable executable support for svn-apply and svn-unapply
        https://bugs.webkit.org/show_bug.cgi?id=39409

        Connect up the Git and SVN executable bit support in parseDiff() so that
        executable bit changes are propagated via the returned diff hash to the
        patch function in svn-apply and svn-unapply.

        * Scripts/VCSUtils.pm:
          - Modified parseDiff() to call parseSvnDiffProperties when
            it finds the start of an SVN property change diff.
          - Removed FIXME comment above parseSvnDiffProperties() since
            it is now being used by parseDiff().
          - Export method scmToggleExecutableBit() now that we added the
            executableBitDelta hash key. (This should have been exported
            when we added this function in Bug #38423 <https://bugs.webkit.org/show_bug.cgi?id=38423>).
        * Scripts/webkitperl/VCSUtils_unittest/parseDiff.pl:
          - Updated results for:
            "rename (with executable bit change)"
              - Test value of executableBitDelta (now that we have support).
            "SVN: binary file (isBinary true)"
              - Remove the property change diff from svnConvertedText. We plan
                to remove svnConvertedText in the future. So, we decided
                against adding such support to any new code, such as the
                property parsing routines. Therefore, we do not keep SVN
                converted text for property change diffs.
          - Added unit tests:
            "SVN: file change diff with property change diff"
            "SVN: file change diff, followed by property change diff on different file"
            "SVN: property diff, followed by file change diff"
            "SVN: copied file with property change"
            "SVN: two consecutive property diffs"
            "SVN: binary file with executable bit change"
            "SVN: binary file followed by property change on different file"
            "SVN: binary file followed by file change on different file"
            "SVN: file change diff with property change, followed by property change diff"
            "SVN: file change diff with property change, followed by file change diff"

2010-07-11  Maciej Stachowiak  <mjs@apple.com>

        Reviewed by Dan Bernstein.

        Implement waitUntilDone and notifyDone for WebKitTestRunner
        https://bugs.webkit.org/show_bug.cgi?id=42049

        With this fix, most of the DOM tests pass.
        
        * WebKitTestRunner/InjectedBundle/InjectedBundle.cpp:
        (WTR::InjectedBundle::didCreatePage): Track the main page. Not
        a great way to do it in the future case where we may get multiple
        pages - we really need a way to send it over from the ui process.
        * WebKitTestRunner/InjectedBundle/InjectedBundle.h:
        (WTR::InjectedBundle::page): A way to get the main page.
        * WebKitTestRunner/InjectedBundle/InjectedBundlePage.cpp:
        (WTR::InjectedBundlePage::InjectedBundlePage): Initialize m_isLoading to false.
        (WTR::InjectedBundlePage::didStartProvisionalLoadForFrame): Track that we
        are loading.
        (WTR::InjectedBundlePage::dump): Factor into a method so this can be
        called by the layout test controller. Also, cancel any pending watchdogs.
        (WTR::InjectedBundlePage::didFinishLoadForFrame): Note that we are done loading.
        (WTR::InjectedBundlePage::didFailLoadWithErrorForFrame): Ditto.
        * WebKitTestRunner/InjectedBundle/InjectedBundlePage.h:
        (WTR::InjectedBundlePage::isLoading): A way to track if we are loading.
        * WebKitTestRunner/InjectedBundle/LayoutTestController.cpp:
        (WTR::LayoutTestController::LayoutTestController): Initialize m_waitToDump
        to false.
        (WTR::LayoutTestController::invalidateWaitToDumpWatchdog): Invalidate 
        the watchdog.
        (WTR::waitUntilDoneWatchdogFired): Static helper for the watchdog timer.
        (WTR::LayoutTestController::setWaitToDump): Set the flag.
        (WTR::LayoutTestController::waitToDumpWatchdogTimerFired): Handle the case
        where waitUntilDone times out.
        (WTR::LayoutTestController::notifyDone): Dump, if loading is done.
        (WTR::waitUntilDoneCallback): JS glue for waitUntilDone.
        (WTR::notifyDoneCallback): JS glue for notifyDone.
        (WTR::LayoutTestController::staticFunctions): Add waitUntilDone and notifyDone
        to the layoutController.
        * WebKitTestRunner/InjectedBundle/LayoutTestController.h:
        (WTR::LayoutTestController::waitToDump): Inline method to get the wait state.

2010-07-09  Brian Weinstein  <bweinstein@apple.com>

        Rubber-stamped by Dan Bernstein.

        Windows testers running Windows 7 were hanging during test_kill_process. Changing the
        number of attempts from 3 to 10 fixes the problem on the new bots (and doesn't seem to
        slow down the tests).

        * Scripts/webkitpy/common/system/executive.py:

2010-07-09  Luiz Agostini  <luiz.agostini@openbossa.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Mac build fix
        https://bugs.webkit.org/show_bug.cgi?id=41967

        Adding file PluginObjectMac.mm and frameworks Cocoa and QuartzCore.

        * DumpRenderTree/qt/TestNetscapePlugin/TestNetscapePlugin.pro:

2010-07-09  Diego Gonzalez  <diegohcg@webkit.org>

        Reviewed by Antonio Gomes.

        [Qt] [WebKit2] Add navigation actions to MiniBrowser toolbar
        https://bugs.webkit.org/show_bug.cgi?id=41966

        * MiniBrowser/qt/BrowserWindow.cpp:
        (BrowserWindow::BrowserWindow):

2010-07-09  Leon Clarke  <leonclarke@google.com>

        Reviewed by Adam Barth.

        add support for link prefetching
        https://bugs.webkit.org/show_bug.cgi?id=3652

        * Scripts/build-webkit:

2010-07-09  Ojan Vafai  <ojan@chromium.org>

        Reviewed by Adam Barth.

        r63004 broke some python tests
        https://bugs.webkit.org/show_bug.cgi?id=42007

        AbstractStep now checks options.no_squash and options.squash, so
        they needed to have real values. Mock would return an object for those,
        which would then act as if the values were True.

        * Scripts/webkitpy/tool/commands/commandtest.py:
        * Scripts/webkitpy/tool/commands/download_unittest.py:
        * Scripts/webkitpy/tool/commands/stepsequence.py:
        * Scripts/webkitpy/tool/commands/upload_unittest.py:
        * Scripts/webkitpy/tool/mocktool.py:
        * Scripts/webkitpy/tool/steps/closebugforlanddiff_unittest.py:
        * Scripts/webkitpy/tool/steps/preparechangelog_unittest.py:
        * Scripts/webkitpy/tool/steps/steps_unittest.py:
        * Scripts/webkitpy/tool/steps/updatechangelogswithreview_unittest.py:
        * Scripts/webkitpy/tool/steps/validatereviewer_unittest.py:

2010-07-09  Ojan Vafai  <ojan@chromium.org>

        Reviewed by Adam Barth.

        --squash should go away and become the default
        https://bugs.webkit.org/show_bug.cgi?id=39624

        If there are local commits and working copy changes, then prompt the user
        whether to continue. Setting git config webkit-patch.commit_should_always_squash
        true bypasses the prompt.

        --git-commit=HEAD.. operates on working copy changes only.
        --git-commit=committish operates on a range of commits as a single commit.
            e.g. --git-commit=HEAD only operates on the HEAD commit.
            --git-commit=HEAD~4..HEAD~2 will operate on HEAD~3 and HEAD~2 as a single commit.

        --no-squash and --squash are left in with descriptive error messages if used.

        * Scripts/check-webkit-style:
        * Scripts/webkitpy/common/checkout/api.py:
        * Scripts/webkitpy/common/checkout/api_unittest.py:
        * Scripts/webkitpy/common/checkout/scm.py:
        * Scripts/webkitpy/common/checkout/scm_unittest.py:
        * Scripts/webkitpy/common/net/rietveld.py:
        * Scripts/webkitpy/common/system/user.py:
        * Scripts/webkitpy/style/optparser.py:
        * Scripts/webkitpy/style_references.py:
        * Scripts/webkitpy/tool/commands/download.py:
        * Scripts/webkitpy/tool/commands/upload.py:
        * Scripts/webkitpy/tool/mocktool.py:
        * Scripts/webkitpy/tool/steps/abstractstep.py:
        * Scripts/webkitpy/tool/steps/applypatchwithlocalcommit.py:
        * Scripts/webkitpy/tool/steps/checkstyle.py:
        * Scripts/webkitpy/tool/steps/checkstyle_unittest.py: Removed.
        * Scripts/webkitpy/tool/steps/commit.py:
        * Scripts/webkitpy/tool/steps/options.py:
        * Scripts/webkitpy/tool/steps/preparechangelog.py:
        * Scripts/webkitpy/tool/steps/preparechangelogforrevert.py:
        * Scripts/webkitpy/tool/steps/updatechangelogswithreviewer.py:
        * Scripts/webkitpy/tool/steps/validatereviewer.py:

2010-07-09  Mark Rowe  <mrowe@apple.com>

        Add two new Windows test build slaves.

        * BuildSlaveSupport/build.webkit.org-config/config.json:

2010-07-09  Albert J. Wong  <ajwong@chromium.org>

        Reviewed by David Levin.

        rebaseline_chromium_webkit_tests missing --use_drt option on linux
        https://bugs.webkit.org/show_bug.cgi?id=41985

        This adds in the --use_drt option for rebaseline_chromium_webkit_tests
        so that it works on linux. This is essentially a "compile-fix" for the
        script.

        * Scripts/webkitpy/layout_tests/rebaseline_chromium_webkit_tests.py:

2010-07-09  Nico Weber  <thakis@chromium.org>

        Unreviewed. Adding myself as committer.

        * Scripts/webkitpy/common/config/committers.py:

2010-07-09  David Kilzer  <ddkilzer@apple.com>

        Revert "<http://webkit.org/b/41788> commit-log-editor: wrong ChangeLog read when invoked from subdir with git"

        This reverts commit r62692.

        * Scripts/commit-log-editor:

2010-07-08  Kinuko Yasuda  <kinuko@chromium.org>

        Reviewed by Ojan Vafai.

        cleanup json_results_generator dependencies so that non-layout-tests can also use it safely
        https://bugs.webkit.org/show_bug.cgi?id=38693

        Introduced a new base class JSONResultsGeneratorBase that doesn't
        have any dependency on layout_tests packages.
        Turned JSONResultsGenerator into a wrapper class of the base class
        so that the old code can work with it during the cleanup.

        Added json_results_generator_unittest.py.

        * Scripts/webkitpy/layout_tests/layout_package/json_layout_results_generator.py:
        * Scripts/webkitpy/layout_tests/layout_package/json_results_generator.py:
        * Scripts/webkitpy/layout_tests/layout_package/json_results_generator_unittest.py: Added

2010-07-09  Abhishek Arya  <inferno@chromium.org>

        Unreviewed.

        Marking myself as a committer.

        * Scripts/webkitpy/common/config/committers.py:

2010-07-09  Kenneth Rohde Christiansen  <kenneth.christiansen@openbossa.org>

        Reviewed by Antti Koivisto.

        Implement MiniBrowser for Qt.
        https://bugs.webkit.org/show_bug.cgi?id=40233

        * MiniBrowser/qt/BrowserWindow.cpp: Added.
        (createNewPage):
        (BrowserView::BrowserView):
        (BrowserView::resizeEvent):
        (BrowserView::load):
        (BrowserView::view):
        (BrowserWindow::BrowserWindow):
        (BrowserWindow::load):
        (BrowserWindow::changeLocation):
        (BrowserWindow::~BrowserWindow):
        * MiniBrowser/qt/BrowserWindow.h: Added.
        (BrowserView::~BrowserView):
        * MiniBrowser/qt/MiniBrowser.pro: Added.
        * MiniBrowser/qt/main.cpp: Added.
        (main):

2010-07-09  Jedrzej Nowacki  <jedrzej.nowacki@nokia.com>

        Reviewed by Simon Hausmann.

        Introduce the Qt autotest launcher.

        Qt autotests should be executed more frequently, ideally by the Qt
        build bot. This is the first step to provide the tests more accessible.

        [Qt] It should be easier to run all Qt's autotests.
        https://bugs.webkit.org/show_bug.cgi?id=31625

        * Scripts/run-qtwebkit-tests: Added.

2010-07-09  Adam Barth  <abarth@webkit.org>

        Reviewed by Eric Seidel.

        commit-queue should merge to TOT when checkout needs update
        https://bugs.webkit.org/show_bug.cgi?id=41944

        There are a bunch of different designs that are possible here.  This
        one merges to top of tree by cleaning out the working copy and
        re-applying the patch.  Once you decide to merge that way, you need to
        decide who's going to retry.  In this patch, we retry in the child
        process instead of plumbing the failure reason to the master process.

        This patch is difficult to test end-to-end, but hopefully it will work.
        :)

        * Scripts/webkitpy/tool/commands/queues.py:
        * Scripts/webkitpy/tool/commands/stepsequence.py:
        * Scripts/webkitpy/tool/multicommandtool.py:
        * Scripts/webkitpy/tool/multicommandtool_unittest.py:

2010-07-09  Dumitru Daniliuc  <dumi@chromium.org>

        Reviewed by Darin Adler.

        Add a script to check for unnecessary includes in header files.
        https://bugs.webkit.org/show_bug.cgi?id=41894

        * Scripts/check-header-includes: Added.

2010-07-09  Adam Barth  <abarth@webkit.org>

        Reviewed by Eric Seidel.

        Add --html5-treebuilder option to run-webkit-tests
        https://bugs.webkit.org/show_bug.cgi?id=41922

        We're down to one or two regressions in the HTML5lib test suite.  It's
        getting to be time to look at fixing LayoutTests.

        * Scripts/old-run-webkit-tests:

2010-07-08  Simon Fraser  <simon.fraser@apple.com>

        Fix Tiger plugin test failures; the #ifdefs were incorrect, resulting
        in the drawing model never getting set on Tiger.

        * DumpRenderTree/TestNetscapePlugIn/main.cpp:
        (NPP_New):

2010-07-08  Aaron Boodman  <aa@chromium.org>

        Reviewed by Timothy Hatcher.

        Add the ability for user scripts and user styles to affect just the top frame.

        https://bugs.webkit.org/show_bug.cgi?id=41529

        * DumpRenderTree/LayoutTestController.h: Added new allFrames param.
        * DumpRenderTree/LayoutTestController.cpp: Ditto.
        (addUserScriptCallback):
        (addUserStyleSheetCallback):
        * DumpRenderTree/chromium/LayoutTestController.cpp: Ditto.
        (LayoutTestController::addUserScript):
        (LayoutTestController::addUserStyleSheet):
        * DumpRenderTree/gtk/LayoutTestControllerGtk.cpp: Ditto.
        (LayoutTestController::addUserScript):
        (LayoutTestController::addUserStyleSheet):
        * DumpRenderTree/mac/LayoutTestControllerMac.mm: Ditto.
        (LayoutTestController::addUserScript):
        (LayoutTestController::addUserStyleSheet):
        * DumpRenderTree/win/LayoutTestControllerWin.cpp: Ditto.
        (LayoutTestController::addUserScript):
        (LayoutTestController::addUserStyleSheet):
        * DumpRenderTree/wx/LayoutTestControllerWx.cpp: Ditto.
        (LayoutTestController::addUserScript):
        (LayoutTestController::addUserStyleSheet):

2010-07-08  Adele Peterson  <adele@apple.com>

        Reviewed by Jon Honeycutt, Adam Roben, and Darin Adler.

        Test infrastructure for https://bugs.webkit.org/show_bug.cgi?id=41721
        <rdar://problem/8158561> Missing plug-in indicator should have a pressed state

        Log when the missing plugin button is pressed.

        * DumpRenderTree/mac/UIDelegate.mm:
        (-[UIDelegate webView:didPressMissingPluginButton:]):
        * DumpRenderTree/win/UIDelegate.cpp:
        (UIDelegate::QueryInterface):
        (UIDelegate::createWebViewWithRequest):
        (UIDelegate::drawBackground):
        (UIDelegate::decidePolicyForGeolocationRequest):
        (UIDelegate::didPressMissingPluginButton):
        * DumpRenderTree/win/UIDelegate.h:

2010-07-08  Simon Fraser  <simon.fraser@apple.com>

        Fix the Tiger build.

        * DumpRenderTree/TestNetscapePlugIn/main.cpp:
        (NPP_New):

2010-07-08  Simon Fraser  <simon.fraser@apple.com>

        Fix windows build.

        #ifdef code for Mac.

        * DumpRenderTree/TestNetscapePlugIn/main.cpp:
        (NPP_New):

2010-07-08  Simon Fraser  <simon.fraser@apple.com>

        Reviewed by Anders Carlsson.

        Allow the TestPlugin to use Core Animation rendering for testing
        https://bugs.webkit.org/show_bug.cgi?id=41872
        
        Add the ability for the TestPlugin to use the CoreAnimation rendering model
        when available, based on the "drawingmodel" attribute of the embed tag:
            drawingmodel="coreanimation"

        * DumpRenderTree/DumpRenderTree.xcodeproj/project.pbxproj: Add PluginObjectMac.mm
        * DumpRenderTree/TestNetscapePlugIn/PluginObject.h: Add some macros so we can detect
        when building on Tiger. Add a void* coreAnimationLayer member.
        
        * DumpRenderTree/TestNetscapePlugIn/PluginObjectMac.mm: Added.
        (createCoreAnimationLayer): Obj-C method to create the CALayer.
        
        * DumpRenderTree/TestNetscapePlugIn/main.cpp:
        (NPP_New): Look for the drawingmodel attribute to decide which drawing
        model to use.
        (NPP_Destroy): Release the CALayer if we have one.
        (NPP_GetValue): Return the retained CALayer.

2010-07-08  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Xan Lopez.

        [GTK] Support pixel tests
        https://bugs.webkit.org/show_bug.cgi?id=31518

        Convert this file from CRLF to NL line endings. It will soon
        be used on more than just the WinCairo platform.

        * DumpRenderTree/cairo/PixelDumpSupportCairo.cpp:
        (writeFunction):
        (printPNG):
        (computeMD5HashStringForBitmapContext):
        (dumpBitmap):

2010-07-08  Steve Falkenburg  <sfalken@apple.com>

        Reviewed by Darin Adler.

        Enable Data Execution Prevention for our test harnesses on Windows
        https://bugs.webkit.org/show_bug.cgi?id=41882

        * DumpRenderTree/win/DumpRenderTree.vcproj:
        * DumpRenderTree/win/ImageDiff.vcproj:
        * WebKitAPITest/WebKitAPITest.vcproj:
        * WebKitTestRunner/win/WebKitTestRunner.vcproj:

2010-07-07  Robert Hogan  <robert@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Add DRT support for pageProperty etc.

        https://bugs.webkit.org/show_bug.cgi?id=41584

        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::isPageBoxVisible):
        (LayoutTestController::pageSizeAndMarginsInPixels):
        (LayoutTestController::pageProperty):
        (LayoutTestController::addUserStyleSheet):
        * DumpRenderTree/qt/LayoutTestControllerQt.h:

2010-07-08  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Xan Lopez.

        Remove a warnings from the ImageDiff build by using the proper
        printf format string for the gsize data type.

        * DumpRenderTree/gtk/ImageDiff.cpp:
        (printImage): Use the proper printf format string for the gsize data type.

2010-07-08  Alice Liu  <alice.liu@apple.com>

        Reviewed by Sam Weinig.

        https://bugs.webkit.org/show_bug.cgi?id=41653
        Add new WebKitTestRunner project for Windows

        * WebKitTestRunner/WebKitTestRunnerPrefix.h: 
        Similar to how it's done in DumpRenderTree, define max and min early
        on so that they don't get replaced by a macro requiring 2 arguments.

        * WebKitTestRunner/win: Added.
        * WebKitTestRunner/win/WebKitTestRunner.sln: Added.
        * WebKitTestRunner/win/WebKitTestRunner.vcproj: Added.
        * WebKitTestRunner/win/main.cpp: Added.
        (main): Implemented

        Added these files with stubbed out functions:
        * WebKitTestRunner/win/PlatformWebViewWin.cpp: Added.
        (WTR::PlatformWebView::PlatformWebView):
        (WTR::PlatformWebView::~PlatformWebView):
        (WTR::PlatformWebView::page):
        * WebKitTestRunner/win/TestControllerWin.cpp: Added.
        (WTR::TestController::initializeInjectedBundlePath):
        * WebKitTestRunner/win/TestInvocationWin.cpp: Added.
        (WTR::TestInvocation::runUntil):

2010-07-07  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Gustavo Noronha Silva.

        [GTK] Implement ImageDiff and add it to the build system
        https://bugs.webkit.org/show_bug.cgi?id=41779

        Add the initial implementation of the ImageDiff tool for the GTK+
        port. This is an essential tool for doing pixel tests. The implementation
        is based on the Mac and Chromium ports.

        * DumpRenderTree/gtk/ImageDiff.cpp: Added.
        (readPixbufFromStdin): Added.
        (differenceImageFromDifferenceBuffer): Ditto.
        (calculateDifference): Ditto.
        (printImage): Ditto.
        (printImageDifferences): Ditto.
        (main): Ditto.
        * GNUmakefile.am: Add ImageDiff to the WebKitTools build scripts.

2010-07-08  Jay Civelli  <jcivelli@chromium.org>

        Unreviewed. Adding myself as a committer.

        * Scripts/webkitpy/common/config/committers.py:

2010-07-08  Adam Roben  <aroben@apple.com>

        Make Windows stop running tests from platform/mac

        r62742 made a change (at my suggestion!) that caused us to start
        looking for tests in platform/mac, rather than just looking for
        expected results in platform/mac. This patch just undoes that part of
        r62742.

        Fixes <http://webkit.org/b/41855> REGRESSION (r62742): Windows runs
        tests from platform/mac, but shouldn't

        Reviewed by Antti Koivisto and Anders Carlsson.

        * Scripts/old-run-webkit-tests:
        (top level): Removed "mac-snowleopard" and "mac" from @winPlatforms,
        so we won't look in those directories for tests to run.
        (expectedDirectoryForTest): Added back code from pre-r62742 to look in
        platform/mac-snowleopard and platform/mac for expected results.

2010-07-08  Antonio Gomes  <tonikitoo@webkit.org>

        Unreviewed. Adding myself as a reviewer.

        * Scripts/webkitpy/common/config/committers.py:

2010-07-08  Tor Arne Vestbø  <tor.arne.vestbo@nokia.com>

        Update my e-mail in committers.py

        * Scripts/webkitpy/common/config/committers.py:

2010-07-07  Daniel Bates  <dbates@rim.com>

        Reviewed by Dumitru Daniliuc.

        VCSUtils.pm complains about uninitialized value $newLine
        https://bugs.webkit.org/show_bug.cgi?id=41333

        Fixes an issue where VCSUtils::fixChangeLogPatch() may read off the end of
        an array when fixing a change log entry that overlaps with an earlier
        entry. In particular, when a patch contains a change log entry inserted
        earlier in the change log file, but after an entry with the same author
        and date.

        * Scripts/VCSUtils.pm:
            - Added for-loop constraint to fixChangeLogPatch() so that it does not
              read off the end of the @overlappingLines array.
        * Scripts/webkitperl/VCSUtils_unittest/fixChangeLogPatch.pl: Added unit test.

2010-07-07  Anders Carlsson  <andersca@apple.com>

        Comment out a part of TestNetscapePlugin that caused tests to fail on Tiger and Leopard.

        * DumpRenderTree/TestNetscapePlugIn/main.cpp:
        (NPP_New):

2010-07-07  Kent Tamura  <tkent@chromium.org>

        Reviewed by Adam Barth.

        [DRT/Chromium] Support for indeterminate checkbox
        https://bugs.webkit.org/show_bug.cgi?id=41747

        Import http://src.chromium.org/viewvc/chrome?view=rev&revision=51499

        * DumpRenderTree/chromium/WebThemeControlDRT.cpp:
        (WebThemeControlDRT::draw):
        * DumpRenderTree/chromium/WebThemeControlDRT.h:
        (WebThemeControlDRT::):
        * DumpRenderTree/chromium/WebThemeEngineDRT.cpp:
        (WebThemeEngineDRT::paintButton):

2010-07-07  Sam Weinig  <sam@webkit.org>

        Reviewed by Mark Rowe.

        Clean up MiniBrowser Xcode project.

        - Use xcconfig files.
        - Rename plists to canonical Info.plist
        - Remove localizations.

        * MiniBrowser/Configurations: Added.
        * MiniBrowser/Configurations/Base.xcconfig: Added.
        * MiniBrowser/Configurations/DebugRelease.xcconfig: Added.
        * MiniBrowser/Configurations/MiniBrowser.xcconfig: Added.
        * MiniBrowser/Configurations/WebBundle.xcconfig: Added.
        * MiniBrowser/MiniBrowser.xcodeproj/project.pbxproj:
        * MiniBrowser/WebBundle-Info.plist: Removed.
        * MiniBrowser/mac/BrowserStatisticsWindowController.m:
        (-[BrowserStatisticsWindowController initWithThreadedWKContextRef:processWKContextRef:]):
        * MiniBrowser/mac/BrowserWindow.xib: Added.
        * MiniBrowser/mac/BrowserWindowController.m:
        (-[BrowserWindowController initWithPageNamespace:]):
        * MiniBrowser/mac/English.lproj: Removed.
        * MiniBrowser/mac/English.lproj/BrowserWindow.xib: Removed.
        * MiniBrowser/mac/English.lproj/InfoPlist.strings: Removed.
        * MiniBrowser/mac/English.lproj/MainMenu.xib: Removed.
        * MiniBrowser/mac/Info.plist: Copied from MiniBrowser/mac/MiniBrowser-Info.plist.
        * MiniBrowser/mac/MainMenu.xib: Added.
        * MiniBrowser/mac/MiniBrowser-Info.plist: Removed.
        * MiniBrowser/mac/WebBundle/Info.plist: Copied from MiniBrowser/WebBundle-Info.plist.

2010-07-07  Kent Tamura  <tkent@chromium.org>

        Reviewed by Dimitri Glazkov.

        [DRT/Chromium] Fix two regressions
        https://bugs.webkit.org/show_bug.cgi?id=41745

        * DumpRenderTree/chromium/WebViewHost.cpp:
        (WebViewHost::paintInvalidatedRegion):
         Repaint three times to fix svg/W3C-SVG-1.1/struct-use-01-t.svg
         and svg/custom/use-on-g-containing-foreignObject-and-image.svg
         though test_shell does it twice. Probably DRT needs it because
         DRT delays painting as possible.

2010-07-07  Anders Carlsson  <andersca@apple.com>

        Try to fix build.

        * DumpRenderTree/unix/TestNetscapePlugin/TestNetscapePlugin.cpp:
        (webkit_test_plugin_destroy_stream):

2010-07-07  Anders Carlsson  <andersca@apple.com>

        Try to fix the GTK+ and Qt test failures by merging the newly added code from TestNetscapePlugin/main.cpp

        * DumpRenderTree/unix/TestNetscapePlugin/TestNetscapePlugin.cpp:
        (webkit_test_plugin_new_stream):
        (webkit_test_plugin_destroy_stream):
        (webkit_test_plugin_write_ready):
        (webkit_test_plugin_write):

2010-07-07  Sam Weinig  <sam@webkit.org>

        Reviewed by Mark Rowe.

        Don't hard code the Mac OS X 10.6 SDK for MiniBrowser. 

        * MiniBrowser/MiniBrowser.xcodeproj/project.pbxproj:

2010-07-07  Anders Carlsson  <andersca@apple.com>

        Use the correct XP_MACOSX define instead of XP_MAC. This was causing test failures on some platforms.

        * DumpRenderTree/TestNetscapePlugIn/main.cpp:
        (NPP_New):
        (NPP_HandleEvent):

2010-07-07  Brian Weinstein  <bweinstein@apple.com>

        Reviewed by Adam Roben.

        Need to have a way to specify different results for Windows XP and 7
        https://bugs.webkit.org/show_bug.cgi?id=41776
        
        Add the ability to have platform/win-xp, platform/win-vista, and platform/win-7
        subdirectories, so we can have different results for tests on Windows XP, Windows
        Vista, and Windows 7.

        Windows XP will try the order: win-xp, win-vista, win-7, win, mac-snowleopard, mac.
        Windows Vista will try the order: win-vista, win-7, win, mac-snowleopard, mac.
        Windows 7 will try the order: win-7, win, mac-snowleopard, mac.

        This matches the behavior of the mac.

        * Scripts/old-run-webkit-tests: Add multiple platforms for Windows, and if we are on XP
            or Vista, try looking in other win-* subdirectories before win.
        * Scripts/webkitdirs.pm: Add some helper functions to determine what version of Windows
            we are running.

2010-07-07  Kent Tamura  <tkent@chromium.org>

        Reviewed by Dimitri Glazkov.

        [DRT/Chromium] Remove ASSERT_NOT_REACHED in some functions
        https://bugs.webkit.org/show_bug.cgi?id=41753

        The original code of the following functions in
        test_shell_devtools_client.cc have NOTIMPLEMENTED(), not
        ASSERT_NOT_REACHED(). The program shouldn't stop at these
        functions.

        * DumpRenderTree/chromium/DRTDevToolsClient.cpp:
        (DRTDevToolsClient::activateWindow):
        (DRTDevToolsClient::closeWindow):
        (DRTDevToolsClient::dockWindow):
        (DRTDevToolsClient::undockWindow):

2010-07-07  Anders Carlsson  <andersca@apple.com>

        Reviewed by Sam Weinig.

        Test that we call NPP_DestroyStream if a plug-in returns -1 from its NPP_Write function
        https://bugs.webkit.org/show_bug.cgi?id=41821

        * DumpRenderTree/TestNetscapePlugIn/PluginObject.cpp:
        (pluginGetProperty):
        (pluginSetProperty):
        (pluginAllocate):
        * DumpRenderTree/TestNetscapePlugIn/PluginObject.h:
        Add and initialize the returnNegativeOneFromWrite property.

        * DumpRenderTree/TestNetscapePlugIn/main.cpp:
        (NPP_NewStream):
        Set the stream type to NP_NORMAL so we'll get write callbacks.

        (NPP_DestroyStream):
        Treat the onstreamdestroy attribute as a function name and not a string.

        (NPP_WriteReady):
        Have this return a nonzero value.

        (NPP_Write):
        If returnNegativeOneFromWrite is true return -1.

2010-07-07  Kevin Ollivier  <kevino@theolliviers.com>

        [wx] Build fix for machines with both MSVC 2005 and 2008 installed. Ensures the
        latest version is selected by default, and allows the version to be specified.

        * wx/build/settings.py:

2010-07-07  Chris Fleizach  <cfleizach@apple.com>

        Reviewed by Darin Adler.

        AX: TextArea should return AXSelectedTextRange of 0,0 if the cursor is not in the text area
        https://bugs.webkit.org/show_bug.cgi?id=41810

        * DumpRenderTree/mac/AccessibilityUIElementMac.mm:
        (AccessibilityUIElement::selectedTextRange):

2010-07-07  Martin Robinson  <mrobinson@igalia.com>

        Unreviewed.

        Build fix after r62700.

        * GNUmakefile.am: Update the source list to reflect the new TestNetscapePlugIn
        source file locations.

2010-07-07  Ojan Vafai  <ojan@chromium.org>

        Reviewed by David Levin.

        change --exit-after-n-crashes to --exit-after-n-crashes-or-timeouts
        https://bugs.webkit.org/show_bug.cgi?id=41814

        * BuildSlaveSupport/build.webkit.org-config/master.cfg:
        * Scripts/old-run-webkit-tests:

2010-07-07  Ojan Vafai  <ojan@chromium.org>

        Reviewed by David Levin.

        add --exit-after-n-crashes to run-webkit-tests
        https://bugs.webkit.org/show_bug.cgi?id=41811

        Change the bots at build.webkit.org to use --exit-after-n-crashes
        instead of --exit-after-n-failures since we want to be able to have
        more than 20 failures on those bots, but more than 20 crashes means
        something should be rolled out.

        * Scripts/old-run-webkit-tests:
        * Scripts/webkitpy/layout_tests/run_webkit_tests.py:

2010-07-07  Brian Weinstein  <bweinstein@apple.com>

        Fix the Windows build by removing win/TestNetscapePlugin/main.cpp from the
        TestNetscapePlugin project, because this was removed from the tree.

        * DumpRenderTree/TestNetscapePlugIn/win/TestNetscapePlugin.vcproj:

2010-07-07  Anders Carlsson  <andersca@apple.com>

        Reviewed by Simon Fraser.

        Unify Mac and Windows TestNetscapePlugin main.cpp files
        https://bugs.webkit.org/show_bug.cgi?id=41798
        
        * DumpRenderTree/DumpRenderTree.sln:
        * DumpRenderTree/TestNetscapePlugIn/main.cpp:
        (strcasecmp):
        (NP_Initialize):
        (NP_GetEntryPoints):
        (NP_Shutdown):
        (NPP_New):
        (NPP_Destroy):
        (NPP_HandleEvent):
        * DumpRenderTree/TestNetscapePlugIn/win/TestNetscapePlugin.vcproj:
        * DumpRenderTree/win/TestNetscapePlugin/main.cpp: Removed.

2010-07-07  Kevin Ollivier  <kevino@theolliviers.com>

        [wx] Build fix. pageProperty needs to return a value.

        * DumpRenderTree/wx/LayoutTestControllerWx.cpp:
        (LayoutTestController::pageProperty):

2010-07-07  David Kilzer  <ddkilzer@apple.com>

        <http://webkit.org/b/41788> commit-log-editor: wrong ChangeLog read when invoked from subdir with git

        Reviewed by Anders Carlsson.

        For both svn and git, commit-log-editor is invoked from the root
        of the working directory.  Unlike svn, git returns a list of
        changed files that are relative to the directory where the
        command was invoked.  This caused the ChangeLog file in the root
        directory to be read instead of the ChangeLog in the current
        directory.

        The fix is to use $ENV{PWD} as the base directory when fixing
        the path to the ChangeLog files.  With svn, this has no net
        effect since $ENV{PWD} is the root of the working directory and
        the ChangeLog paths are already relative to that directory.
        With git, $ENV{PWD} is the directory that the commit was invoked
        from, which fixes the ChangeLog paths so that the correct files
        are read when creating the commit log entry.

        Note that the call to makeFilePathRelative() was supposed to
        address this issue, but it doesn't because (a) it does nothing
        with svn working directories by design, and (b) it does nothing
        with git working directories because it's invoked when the
        current directory is the root of the working directory, thus
        giving no relative path.

        * Scripts/commit-log-editor: Removed call to
        makeFilePathRelative() since since it does nothing.  Moved code
        to fix up $changeLog path so that it's fixed before trying to
        open the file, and use $ENV{PWD} as the base path.  Also use
        canonicalizePath() to clean up paths with "../" in them.

2010-07-07  Anders Carlsson  <andersca@apple.com>

        Another attempt at fixing the Qt build.

        * DumpRenderTree/qt/TestNetscapePlugin/TestNetscapePlugin.pro:

2010-07-07  Anders Carlsson  <andersca@apple.com>

        Try to fix Qt build.

        * DumpRenderTree/qt/TestNetscapePlugin/TestNetscapePlugin.pro:

2010-07-07  Anders Carlsson  <andersca@apple.com>

        Reviewed by Simon Fraser.

        Rename TestNetscapePlugin.subproj and move platform specific files to subdirectories
        https://bugs.webkit.org/show_bug.cgi?id=41781

        * DumpRenderTree/DumpRenderTree.xcodeproj/project.pbxproj:
        * DumpRenderTree/TestNetscapePlugIn/PluginObject.cpp: Renamed from WebKitTools/DumpRenderTree/TestNetscapePlugIn.subproj/PluginObject.cpp.
        * DumpRenderTree/TestNetscapePlugIn/PluginObject.h: Renamed from WebKitTools/DumpRenderTree/TestNetscapePlugIn.subproj/PluginObject.h.
        * DumpRenderTree/TestNetscapePlugIn/TestObject.cpp: Renamed from WebKitTools/DumpRenderTree/TestNetscapePlugIn.subproj/TestObject.cpp.
        * DumpRenderTree/TestNetscapePlugIn/TestObject.h: Renamed from WebKitTools/DumpRenderTree/TestNetscapePlugIn.subproj/TestObject.h.
        * DumpRenderTree/TestNetscapePlugIn/mac/Info.plist: Renamed from WebKitTools/DumpRenderTree/TestNetscapePlugIn.subproj/Info.plist.
        * DumpRenderTree/TestNetscapePlugIn/main.cpp: Renamed from WebKitTools/DumpRenderTree/TestNetscapePlugIn.subproj/main.cpp.
        * DumpRenderTree/TestNetscapePlugIn/win/TestNetscapePlugin.def: Renamed from WebKitTools/DumpRenderTree/win/TestNetscapePlugin/TestNetscapePlugin.def.
        * DumpRenderTree/TestNetscapePlugIn/win/TestNetscapePlugin.rc: Renamed from WebKitTools/DumpRenderTree/win/TestNetscapePlugin/TestNetscapePlugin.rc.
        * DumpRenderTree/TestNetscapePlugIn/win/TestNetscapePlugin.vcproj: Added.
        * DumpRenderTree/TestNetscapePlugIn/win/TestNetscapePlugin_debug.def: Renamed from WebKitTools/DumpRenderTree/win/TestNetscapePlugin/TestNetscapePlugin_debug.def.
        * DumpRenderTree/TestNetscapePlugIn/win/resource.h: Renamed from WebKitTools/DumpRenderTree/win/TestNetscapePlugin/resource.h.
        * DumpRenderTree/win/TestNetscapePlugin/TestNetscapePlugin.vcproj: Removed.

2010-07-07  Andras Becsi  <abecsi@webkit.org>

        Unreviewed trivial fix.

        Remove DUMPRENDERTREE_TEMP environment variable from NRWT
        which was checked in accidentally in r62635.

        * Scripts/webkitpy/layout_tests/port/webkit.py:

2010-07-07  Gabor Rapcsanyi  <rgabor@inf.u-szeged.hu>

        Reviewed by Eric Seidel.

        Pass port specific environment to server process.
        https://bugs.webkit.org/show_bug.cgi?id=41593

        * Scripts/webkitpy/layout_tests/port/qt.py:
        * Scripts/webkitpy/layout_tests/port/webkit.py:

2010-07-06  Kent Tamura  <tkent@chromium.org>

        Reviewed by Shinichiro Hamaji.

        Fix a wrong dup detection of rebaseline-chromium-webkit-tests
        https://bugs.webkit.org/show_bug.cgi?id=41644

        rebaseline-chromium-webkit-tests used ImageDiff with 0.1%
        tolerance. We don't need tolerance for rebaseline.

        * Scripts/webkitpy/layout_tests/port/base.py:
          Add optional tolerance parameter to diff_image().
        * Scripts/webkitpy/layout_tests/port/test.py:
          Add optional tolerance parameter to diff_image().
        * Scripts/webkitpy/layout_tests/port/webkit.py:
          Add optional tolerance parameter to diff_image(), and pass it to ImageDiff command.
        * Scripts/webkitpy/layout_tests/test_types/image_diff.py:
          diff_files() always calls diff_image() with tolerance=0.
          diff_files() is used only by rebaseline-chromium-webkit-tests.

2010-07-06  Sam Weinig  <sam@webkit.org>

        Fix MiniBrowser build.

        * MiniBrowser/mac/WebBundle/WebBundleMain.m:

2010-07-06  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Add support for dumping the contents of messages to the console to WebKitTestRunner

        * WebKitTestRunner/InjectedBundle/InjectedBundlePage.cpp:
        (WTR::InjectedBundlePage::InjectedBundlePage):
        (WTR::InjectedBundlePage::_addMessageToConsole):
        (WTR::InjectedBundlePage::addMessageToConsole):
        * WebKitTestRunner/InjectedBundle/InjectedBundlePage.h:

2010-07-06  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Patch for https://bugs.webkit.org/show_bug.cgi?id=41708
        Add dumpAsText support for WebKitTestRunner

        * WebKitTestRunner/InjectedBundle/InjectedBundle.cpp:
        (WTR::InjectedBundle::InjectedBundle):
        (WTR::InjectedBundle::reset): Reset the LayoutTestController for each test.
        * WebKitTestRunner/InjectedBundle/InjectedBundlePage.cpp:
        (WTR::InjectedBundlePage::didFinishLoadForFrame): Use the new WKBundleFrameCopyInnerText
        API to dump the main frames text.

2010-07-06  Darin Adler  <darin@apple.com>

        Fix Chromium build.

        * DumpRenderTree/chromium/WebViewHost.cpp:
        (WebViewHost::didCreateDataSource): Call leakPtr instead of release.
        (WebViewHost::didNavigateWithinPage): Ditto.
        (WebViewHost::updateURL): Ditto.

2010-07-06  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Xan Lopez.

        [GTK] build-webkit should not run autogen.sh unconditionally
        https://bugs.webkit.org/show_bug.cgi?id=41704

        * Scripts/webkitdirs.pm: Only run autogen.sh during a build if GNUmakefile
        doesn't exist. Autotools should re-run autogen.sh when necessary. Also do
        some very minor cleanup.

2010-07-06  Darin Adler  <darin@apple.com>

        Try to fix Chromium build.

        * DumpRenderTree/chromium/WebViewHost.cpp: Added include of PassOwnPtr.h.

2010-07-06  Darin Adler  <darin@apple.com>

        Fix build.

        * WebKitAPITest/TestsController.cpp:
        (WebKitAPITest::TestsController::addTest): Use leakPtr instead of release.

2010-07-06  Roland Steiner  <rolandsteiner@chromium.org>

        Reviewed by Kent Tamura.

        Bug 40558 - [DRT/Chromium] Upstream TestShellDevTools for Chromium DRT
        https://bugs.webkit.org/show_bug.cgi?id=40558

        Upstream DevTools for Chromium DRT.
        (original Chromium files rev. 51287)

        * DumpRenderTree/DumpRenderTree.gypi:
        * DumpRenderTree/chromium/DRTDevToolsAgent.cpp: Added.
        (DRTDevToolsAgent::DRTDevToolsAgent):
        (DRTDevToolsAgent::setWebView):
        (DRTDevToolsAgent::sendMessageToFrontend):
        (DRTDevToolsAgent::forceRepaint):
        (DRTDevToolsAgent::runtimeFeatureStateChanged):
        (DRTDevToolsAgent::injectedScriptSource):
        (DRTDevToolsAgent::injectedScriptDispatcherSource):
        (DRTDevToolsAgent::debuggerScriptSource):
        (DRTDevToolsAgent::asyncCall):
        (DRTDevToolsAgent::call):
        (DRTDevToolsAgent::webDevToolsAgent):
        (DRTDevToolsAgent::attach):
        (DRTDevToolsAgent::detach):
        (DRTDevToolsAgent::setTimelineProfilingEnabled):
        (DRTDevToolsAgent::evaluateInWebInspector):
        (DRTDevToolsAgent::dispatchMessageLoop):
        * DumpRenderTree/chromium/DRTDevToolsAgent.h: Added.
        (DRTDevToolsAgent::~DRTDevToolsAgent):
        (DRTDevToolsAgent::hostIdentifier):
        * DumpRenderTree/chromium/DRTDevToolsCallArgs.cpp:
        * DumpRenderTree/chromium/DRTDevToolsCallArgs.h:
        (DRTDevToolsCallArgs::DRTDevToolsCallArgs):
        (DRTDevToolsCallArgs::~DRTDevToolsCallArgs):
        (DRTDevToolsCallArgs::callsCount):
        * DumpRenderTree/chromium/DRTDevToolsClient.cpp: Added.
        (DRTDevToolsClient::DRTDevToolsClient):
        (DRTDevToolsClient::~DRTDevToolsClient):
        (DRTDevToolsClient::sendMessageToAgent):
        (DRTDevToolsClient::sendDebuggerCommandToAgent):
        (DRTDevToolsClient::activateWindow):
        (DRTDevToolsClient::closeWindow):
        (DRTDevToolsClient::dockWindow):
        (DRTDevToolsClient::undockWindow):
        (DRTDevToolsClient::asyncCall):
        (DRTDevToolsClient::call):
        (DRTDevToolsClient::allMessagesProcessed):
        * DumpRenderTree/chromium/DRTDevToolsClient.h:
        * DumpRenderTree/chromium/EventSender.cpp:
        * DumpRenderTree/chromium/LayoutTestController.cpp:
        (LayoutTestController::LayoutTestController):
        (LayoutTestController::closeWebInspector):
        (LayoutTestController::setTimelineProfilingEnabled):
        (LayoutTestController::evaluateInWebInspector):
        * DumpRenderTree/chromium/LayoutTestController.h:
        * DumpRenderTree/chromium/TestShell.cpp:
        (TestShell::TestShell):
        (TestShell::~TestShell):
        (TestShell::createDRTDevToolsClient):
        (TestShell::showDevTools):
        (TestShell::closeDevTools):
        (TestShell::runFileTest):
        (TestShell::createNewWindow):
        * DumpRenderTree/chromium/TestShell.h:
        (TestShell::drtDevToolsAgent):
        (TestShell::drtDevToolsClient):
        * DumpRenderTree/chromium/config.h:

2010-07-06  Gabor Rapcsanyi  <rgabor@inf.u-szeged.hu>

        Reviewed by Eric Seidel.

        Don't pass image hash to DRT when pixel tests are disabled.
        https://bugs.webkit.org/show_bug.cgi?id=41597

        * Scripts/webkitpy/layout_tests/layout_package/dump_render_tree_thread.py:

2010-07-05  Csaba Osztrogonác  <ossy@webkit.org>

        Reviewed by Eric Seidel.

        REGRESSION(r60652): WebKitTools/Scripts/ensure-valid-python should cleanup temporary directory
        https://bugs.webkit.org/show_bug.cgi?id=41612

        * Scripts/ensure-valid-python: File::Temp::tempdir call fixed.

2010-07-05  Adam Barth  <abarth@webkit.org>

        Reviewed by Eric Seidel.

        We should be able to specify a bug to block for webkit-patch upload
        https://bugs.webkit.org/show_bug.cgi?id=41648

        This will be useful for working on the HTML5 parser.

        * Scripts/webkitpy/tool/steps/createbug.py:
        * Scripts/webkitpy/tool/steps/options.py:

2010-07-05  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Oliver Hunt.

        The style checker exempts gtk2drawing.h when it should exempt gtkdrawing.h
        https://bugs.webkit.org/show_bug.cgi?id=41017

        * Scripts/webkitpy/style/checker.py: Exempt gtkdrawing.h instead of gtk2drawing.h
        * Scripts/webkitpy/style/checker_unittest.py: Update the unit test to reflect the change.

2010-07-04  MORITA Hajime  <morrita@google.com>

        rebaseline-chromium-webkit-tests: UnicodeDecodeError
        https://bugs.webkit.org/show_bug.cgi?id=41589

        * run() method can result non-utf-8 bytes, that causes utf-8
          decoding fail.  Fixed to disable decoding.
        * Fixed Git.find_checkout_root() to make a test pass.

        * Scripts/webkitpy/common/checkout/scm.py:
        * Scripts/webkitpy/common/checkout/scm_unittest.py:

2010-07-03  Patrick Gansterer  <paroga@paroga.com>

        Reviewed by Simon Hausmann.

        [Qt] Fix DumpRenderTree userStyleSheet handling.
        https://bugs.webkit.org/show_bug.cgi?id=41570

        DumpRenderTree did only set the userStyleSheet at
        layoutTestController.setUserStyleSheetEnabled().

        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::reset):
        (LayoutTestController::setUserStyleSheetLocation):
        (LayoutTestController::setUserStyleSheetEnabled):
        * DumpRenderTree/qt/LayoutTestControllerQt.h:

2010-07-03  Robert Hogan  <robert@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] support dumpChildFrameScrollPositions

        https://bugs.webkit.org/show_bug.cgi?id=41088

        Unskip:

        http/tests/navigation/anchor-subframeload.html
        http/tests/navigation/relativeanchor-frames.html

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::DumpRenderTree::dumpFrameScrollPosition):
        (WebCore::DumpRenderTree::dump):
        * DumpRenderTree/qt/DumpRenderTreeQt.h:
        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::reset):
        * DumpRenderTree/qt/LayoutTestControllerQt.h:
        (LayoutTestController::shouldDumpChildFrameScrollPositions):
        (LayoutTestController::dumpChildFrameScrollPositions):

2010-07-02  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Rename new scripts so that they don't make autocompleting run-webkit-tests annoying.

        * Scripts/debug-test-runner: Copied from Scripts/debug-webkittestrunner.
        * Scripts/debug-webkittestrunner: Removed.
        * Scripts/run-test-runner: Copied from Scripts/run-webkittestrunner.
        * Scripts/run-webkittestrunner: Removed.

2010-07-02  Brian Weinstein  <bweinstein@apple.com>

        Reviewed by Steve Falkenburg.

        Some http tests fail on Windows with Cygwin 1.7
        https://bugs.webkit.org/show_bug.cgi?id=41537
        
        With Cygwin 1.7, the registry key at SOFTWARE\\Cygnus Solutions\\Cygwin\\mounts v2\\/
        doesn't exist anymore, because the mount points are stored in /etc/fstab. However, we
        just need root mount point, which is defined in SOFTWARE\\Cygwin\\setup.

        * DumpRenderTree/win/LayoutTestControllerWin.cpp:
        (resolveCygwinPath): Fall back to SOFTWARE\\Cygwin\\setup if 
            SOFTWARE\\Cygnus Solutions\\Cygwin\\mounts v2\\/ doesn't work.

2010-06-23  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Gustavo Noronha Silva.

        [GTK] Separate DerivedSources per-project
        https://bugs.webkit.org/show_bug.cgi?id=41109

        The JavaScriptCore cppflags used to include the top-level DerivedSources directory
        allowing the tools to build as a side-effect. Now that the top-level directory
        is no longer in the list of JavaScriptCore includes, include it explicitly.

        * GNUmakefile.am:

2010-07-01  Tor Arne Vestbø  <tor.arne.vestbo@nokia.com>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Make context menus show up in the right place in QTestBrowser

        Context menus were shown at scene-relative coordinates for
        QGraphicsWebView while QMenu expects them to be global. The
        change to the QWidget case was to get rid of the mapToGlobal.

        * QtTestBrowser/webview.cpp:

2010-07-01  Robert Hogan <robert@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] dump frames in ascending alphabetical order of title

        https://bugs.webkit.org/show_bug.cgi?id=41261

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::dumpHistoryItem):

2010-07-01  Martin Robinson  <mrobinson@igalia.com>

        Unreviewed. 

        Fix the GTK+ build after r62278.

        * Scripts/webkitdirs.pm: If the make arguments have already been specified,
        let them override the automatic CPU detection for autotools builds.

2010-07-01  Martin Robinson  <mrobinson@igalia.com>

        Unreviewed.

        Fix the Windows build after r62278.

        * Scripts/num-cpus: Use FindBin to add the Scripts directory to the list of library directories.

2010-07-01  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Gustavo Noronha Silva.

        [GTK] build-webkit does not detect the number of CPUs
        https://bugs.webkit.org/show_bug.cgi?id=41469

        Pass the appropriate -j<#> flag to make when building autotools builds.
        This causes make to spawn that many number of child processes for doing
        parallel builds.

        * Scripts/num-cpus: Use the newly abstracted numberOfCPUs to return the number
        of CPUs. This makes the script work across more platforms.
        * Scripts/webkitdirs.pm: Create a numberOfCPUs/determineNumberOfCPUs to determine the
        number of CPUs across several platforms. Use this new function to determine the appropriate
        arguments to pass to make for doing parallel builds with autotools build files.

2010-07-01  Simon Hausmann  <simon.hausmann@nokia.com>

        Rubber-stamped by Laszlo Gombos.

        [Qt][Symbian] Bumped up the maximum heap size to 96MB

        * QtTestBrowser/QtTestBrowser.pro: Removed explicit heap size declaration
        and use the one from WebKit.pri instead.

2010-07-01  Adam Barth  <abarth@webkit.org>

        Reviewed by Eric Seidel.

        Promote webkit-patch land-safely to main help
        https://bugs.webkit.org/show_bug.cgi?id=41446

        I've been using this command a bunch and recommending it to folks.  We
        should show it in main help as it's past the experimental phase.

        * Scripts/webkitpy/tool/commands/upload.py:

2010-06-28  MORITA Hajime  <morrita@google.com>

        Reviewed by Shinichiro Hamaji.

        rebaseline-chromium-webkit-tests doesn't do diffs right with a Git checkout of WebKit
        https://bugs.webkit.org/show_bug.cgi?id=38775

        - Introduced SCM.show_head() and SCM.diff_for_file().
        - Replaced direct svn invocations with newly implement SCM methods.

        * Scripts/webkitpy/common/checkout/scm.py:
        * Scripts/webkitpy/common/checkout/scm_unittest.py:
        * Scripts/webkitpy/layout_tests/rebaseline_chromium_webkit_tests.py:

2010-06-30  Simon Fraser  <simon.fraser@apple.com>

        Reviewed by Sam Weinig.

        Allow MiniBrowser to open local files
        https://bugs.webkit.org/show_bug.cgi?id=41104

        Wire up the openDocument: message with an NSOpenPanel, so we can open
        local files.
        
        Also change the xib so that the window remembers its size.
        
        * MiniBrowser/mac/AppDelegate.m:
        (-[BrowserAppDelegate frontmostBrowserWindowController]):
        (-[BrowserAppDelegate openDocument:]):
        (-[BrowserAppDelegate openPanelDidEnd:returnCode:contextInfo:]):
        * MiniBrowser/mac/English.lproj/BrowserWindow.xib:

2010-06-30  Sam Weinig  <sam@webkit.org>

        Rubber-stamped by Anders Carlsson.

        Add debug-webkittestrunner and cleanup related scripts.

        * Scripts/debug-webkittestrunner: Added.
        * Scripts/run-webkittestrunner:
        * Scripts/webkitdirs.pm:

2010-06-30  Kevin Ollivier  <kevino@theolliviers.com>

        [wx] Build fix after recent changes to LayoutTestController.

        * DumpRenderTree/wx/LayoutTestControllerWx.cpp:
        (LayoutTestController::pageSizeAndMarginsInPixels):

2010-06-29  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Patch for https://bugs.webkit.org/show_bug.cgi?id=41389
        Make WebKitTestRunner work with more than one test at a time.

        This converts WebKitTestRunner to a similar model as DumpRenderTree,
        where there is a single WKView and each test is run it, rather than
        the design I was using where each test got its own WKView.

        * WebKitTestRunner/InjectedBundle/InjectedBundle.cpp:
        (WTR::InjectedBundle::didRecieveMessage):
        (WTR::InjectedBundle::reset):
        * WebKitTestRunner/InjectedBundle/InjectedBundle.h:
        * WebKitTestRunner/TestController.cpp:
        (WTR::TestController::initialize):
        (WTR::TestController::runTest):
        (WTR::TestController::_didRecieveMessageFromInjectedBundle):
        (WTR::TestController::didRecieveMessageFromInjectedBundle):
        * WebKitTestRunner/TestController.h:
        (WTR::TestController::mainWebView):
        (WTR::TestController::pageNamespace):
        (WTR::TestController::context):
        * WebKitTestRunner/TestInvocation.cpp:
        (WTR::TestInvocation::TestInvocation):
        (WTR::TestInvocation::~TestInvocation):
        (WTR::TestInvocation::invoke):
        (WTR::TestInvocation::didRecieveMessageFromInjectedBundle):
        * WebKitTestRunner/TestInvocation.h:

2010-06-30  Simon Hausmann  <simon.hausmann@nokia.com>

        Reviewed by Laszlo Gombos.

        [Qt][Symbian] Only 10 websites can be loaded consecutively when using QtWebkit 2.0
        https://bugs.webkit.org/show_bug.cgi?id=40446

        We quickly run out of memory on Symbian when loading web pages. This is
        caused by the default heap size, which is not suited for a web browser.

        This change bumps the max heap size to 32MB.

        * QtTestBrowser/QtTestBrowser.pro:

2010-06-30  Eric Seidel  <eric@webkit.org>

        Reviewed by Adam Barth.

        webkit-patch land allow the user to continue even if the builders are red
        https://bugs.webkit.org/show_bug.cgi?id=41395

        I don't think it's good that we've been teaching people
        to always pass --ignore-builders.  At least land is now
        useable w/o --ignore-builders.

        * Scripts/webkitpy/tool/steps/ensurebuildersaregreen.py:

2010-06-29  Robert Hogan  <robert@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] support dumpResourceResponseMIMETypes
        https://bugs.webkit.org/show_bug.cgi?id=41260

        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::reset):
        (LayoutTestController::dumpResourceResponseMIMETypes):
        * DumpRenderTree/qt/LayoutTestControllerQt.h:

2010-06-29  Diego Gonzalez  <diegohcg@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Resize scene when Qt DRT WebPage receives a geometry change request
        https://bugs.webkit.org/show_bug.cgi?id=41173

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::WebPage::setViewGeometry):
        * DumpRenderTree/qt/DumpRenderTreeQt.h:

2010-06-29  Diego Gonzalez  <diegohcg@webkit.org>

        Reviewed by Simon Hausmann.

        [Qt] Deal with postEvent in case of graphics based DRT
        https://bugs.webkit.org/show_bug.cgi?id=41174

        QGraphicsScene does not have a postEvent method, so make scene
        send the event, in case of graphics based DRT, and delete it after that.

        * DumpRenderTree/qt/EventSenderQt.cpp:
        (EventSender::scheduleAsynchronousClick):
        (EventSender::replaySavedEvents):
        (EventSender::postEvent):
        * DumpRenderTree/qt/EventSenderQt.h:

2010-06-29  Diego Gonzalez  <diegohcg@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Make switchFocus() method works with QGraphicsWebView in Qt DRT
        https://bugs.webkit.org/show_bug.cgi?id=41172

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::DumpRenderTree::switchFocus):

2010-06-29  Mario Sanchez Prada  <msanchez@igalia.com>

        Reviewed by Xan Lopez.

        [Gtk] Make DRT more coherent with other ports to allow reusing more tests
        https://bugs.webkit.org/show_bug.cgi?id=40009

        Make sure "AXRole: ", "AXTitle: " and "AXDescription: " prefixes
        are used when returning those values, for coherency with other ports.

        * DumpRenderTree/gtk/AccessibilityUIElementGtk.cpp:
        (AccessibilityUIElement::role):
        (AccessibilityUIElement::title):
        (AccessibilityUIElement::description):

2010-06-29  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r62106.
        http://trac.webkit.org/changeset/62106
        https://bugs.webkit.org/show_bug.cgi?id=41346

        "Broke editing tests" (Requested by xan_ on #webkit).

        * Scripts/old-run-webkit-tests:

2010-06-29  Mario Sanchez Prada  <msanchez@igalia.com>

        Reviewed by Xan Lopez.

        Ensure DRT loads GAIL (Gtk+ module), for a11y tests
        https://bugs.webkit.org/show_bug.cgi?id=38648

        Add the GTK_MODULES envvar (set to "gail") to the clean
        environment when running DRT for the Gtk+ port

        * Scripts/old-run-webkit-tests:

2010-06-28  Adam Barth  <abarth@webkit.org>

        Unreviewed.

        Switch test-html5-parser back to using runner.html.

        * Scripts/test-html5-parser:

2010-06-28  Adam Barth  <abarth@webkit.org>

        Reviewed by Eric Seidel.

        Restore webkit-runner.html for use with new tree builder
        https://bugs.webkit.org/show_bug.cgi?id=41317

        For now, we just want to run webkit-runner when we test-html5-parser.

        * Scripts/test-html5-parser:

2010-06-23  John Gregg  <johnnyg@google.com>

        Reviewed by Kent Tamura.

        add ENABLE_DIRECTORY_UPLOAD build support
        https://bugs.webkit.org/show_bug.cgi?id=41100

        * Scripts/build-webkit:

2010-06-28  Gustavo Noronha Silva  <gns@gnome.org>

        Rubber-stamped by Xan Lopez.

        Update webkitdirs's knowledge of our library's name.

        * Scripts/webkitdirs.pm:

2010-06-28  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Patch for https://bugs.webkit.org/show_bug.cgi?id=41299
        Build up WebKitTestRunner output in the InjectedBundle

        Simplify WebKitTestRunner by building up the output in the InjectedBundle
        and sending it over postMessage when done, instead of using the async
        WKPageRenderTreeExternalRepresentation.

        * WebKitTestRunner/InjectedBundle/InjectedBundle.cpp:
        (WTR::InjectedBundle::done):
        (WTR::InjectedBundle::didRecieveMessage):
        * WebKitTestRunner/InjectedBundle/InjectedBundle.h:
        (WTR::InjectedBundle::os):
        * WebKitTestRunner/InjectedBundle/InjectedBundlePage.cpp:
        (WTR::WKStringToUTF8):
        (WTR::InjectedBundlePage::didFinishLoadForFrame):
        (WTR::InjectedBundlePage::didFailLoadWithErrorForFrame):
        * WebKitTestRunner/TestInvocation.cpp:
        (WTR::WKStringToUTF8):
        (WTR::TestInvocation::TestInvocation):
        (WTR::TestInvocation::invoke):
        (WTR::TestInvocation::initializeMainWebView):
        (WTR::TestInvocation::_didRecieveMessageFromInjectedBundle):
        (WTR::TestInvocation::didRecieveMessageFromInjectedBundle):
        * WebKitTestRunner/TestInvocation.h:

2010-06-28  Robert Hogan  <robert@webkit.org>

        Unreviewed, rolling out r62021.
        http://trac.webkit.org/changeset/62021
        https://bugs.webkit.org/show_bug.cgi?id=41261

        Broke http/navigation tests among other

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::DumpRenderTree::dumpFramesAsText):

2010-06-28  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Add run-webkittestrunner to run WebKitTestRunner with the appropriate
        environment.

        * Scripts/run-webkittestrunner: Added.
        * Scripts/webkitdirs.pm:

2010-06-28  Robert Hogan  <robert@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] dump frames in ascending alphabetical order of title

        https://bugs.webkit.org/show_bug.cgi?id=41261

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::DumpRenderTree::dumpFramesAsText):

2010-06-28  Robert Hogan  <robert@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] dump bf history of child windows

        https://bugs.webkit.org/show_bug.cgi?id=41266

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::DumpRenderTree::dumpBackForwardList):
        (WebCore::DumpRenderTree::dump):
        * DumpRenderTree/qt/DumpRenderTreeQt.h:

2010-06-28  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Patch for https://bugs.webkit.org/show_bug.cgi?id=41288
        WebKit2: Add frame API for InjectedBundle code

        * MiniBrowser/mac/WebBundle/WebBundleMain.m:
        (_didClearWindowForFrame):

2010-06-28  Jesus Sanchez-Palencia  <jesus.palencia@openbossa.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] QtTestBrowser does not have a "Load" button ; therefore, unable to load pages on touch only symbian devices (portrait mode).
        https://bugs.webkit.org/show_bug.cgi?id=38597

        Fix behavior so reload button really acts as a load and a reload button.

        * QtTestBrowser/mainwindow.cpp:
        (MainWindow::changeLocation):

2010-06-28  Xan Lopez  <xlopez@igalia.com>

        Reviewed by Gustavo Noronha.

        [GTK] Does not compile with -DGSEAL_ENABLE
        https://bugs.webkit.org/show_bug.cgi?id=37851

        Fix build with GSEAL enabled.

        * DumpRenderTree/gtk/EventSender.cpp:
        (gtk_widget_get_window):
        (prepareMouseButtonEvent):
        (mouseMoveToCallback):
        (mouseWheelToCallback):
        (keyDownCallback):

2010-06-28  Xan Lopez  <xlopez@igalia.com>

        Reviewed by Gustavo Noronha.

        [GTK] Add support for GTK+3
        https://bugs.webkit.org/show_bug.cgi?id=41253

        Adapt build system for 3.x support.

        * GNUmakefile.am:

2010-06-10  Mahesh Kulkarni  <mahesh.kulkarni@nokia.com>

        Reviewed by Simon Hausmann.

        [QT][S60] build-webkit scripts picks wrong make spec for windows build
        https://bugs.webkit.org/show_bug.cgi?id=41198

        Instead of checking for existence of %EPOCROOT% on windows, mandatory use of --symbian flag for symbian builds. 

        * Scripts/webkitdirs.pm:
        (determineIsSymbian): remove check for %EPOCROOT% as one can build for windows port of QT as well

2010-06-28  Eric Seidel  <eric@webkit.org>

        Reviewed by Adam Barth.

        Make it possible to test the new HTML5 TreeBuilder
        https://bugs.webkit.org/show_bug.cgi?id=41276

        Adam was concerned that someone might make their port
        depend on this setting (I guess we had some trouble with that
        with the HTML5Parser setting), so I littered the code with warnings.

        test-html5-parser now tests this code path.

        * DumpRenderTree/mac/DumpRenderTree.mm:
        (resetDefaultsToConsistentValues):
        (initializeGlobalsFromCommandLineOptions):
        * Scripts/test-html5-parser:

2010-06-27  MORITA Hajime  <morrita@google.com>

        Unreviewed. 
        
        Some never-called @staticmethods touched self. 
        Fixed it to replace these self with a class.

        * Scripts/webkitpy/common/checkout/scm.py:

2010-06-27  MORITA Hajime  <morrita@google.com>

        Unreviewed.
        
        Fixed exception raising syntax that is pointed out at
        https://bugs.webkit.org/show_bug.cgi?id=41153

        * Scripts/webkitpy/common/checkout/scm.py:
        * Scripts/webkitpy/common/checkout/scm_unittest.py: 
          Removed a bad line that I accidentally checked-in at last revision.

2010-06-24  MORITA Hajime  <morrita@google.com>

        Reviewed by Eric Seidel.

        rebaseline-chromium-webkit-tests should add or remove files to local git repository
        https://bugs.webkit.org/show_bug.cgi?id=41153

        - Added SCM.add() and SCM.remove()
        - Replaced "svn add" and "svn remove"
          rebaseline_chromium_webkit_tests.py: in with SCM method equivalents.
        - add "-U" and "-q" options to rebaseline_chromium_webkit_tests.py
          for debugging purpose.

        * Scripts/webkitpy/common/checkout/scm.py:
        * Scripts/webkitpy/common/checkout/scm_unittest.py:
        * Scripts/webkitpy/layout_tests/rebaseline_chromium_webkit_tests.py:

2010-06-25  Yuzo Fujishima  <yuzo@google.com>

        Reviewed by Shinichiro Hamaji.

        Improve default value handling for page format properties.
        https://bugs.webkit.org/show_bug.cgi?id=41150

        * DumpRenderTree/LayoutTestController.cpp:
        (parsePageNumber):
        (parsePageNumberSizeMarings):
        (pageSizeAndMarginsInPixelsCallback):
        (LayoutTestController::staticFunctions):
        * DumpRenderTree/LayoutTestController.h:
        * DumpRenderTree/gtk/LayoutTestControllerGtk.cpp:
        (LayoutTestController::pageSizeAndMarginsInPixels):
        * DumpRenderTree/mac/LayoutTestControllerMac.mm:
        (LayoutTestController::pageSizeAndMarginsInPixels):
        * DumpRenderTree/win/LayoutTestControllerWin.cpp:
        (LayoutTestController::pageSizeAndMarginsInPixels):

2010-06-21  Robert Hogan  <robert@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] DRT Support for setCustomPolicyDelegate

        https://bugs.webkit.org/show_bug.cgi?id=39564

        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::setCustomPolicyDelegate):
        * DumpRenderTree/qt/LayoutTestControllerQt.h:

2010-06-26  Robert Hogan  <robert@webkit.org>

        Unreviewed, Qt build fix following http://trac.webkit.org/changeset/61879
        
        Remove qwebscriptworld.h from LayoutTestControllerQt.cpp - it is no longer
        exported.

        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:

2010-06-26  Tony Gentilcore  <tonyg@chromium.org>

        Reviewed by Dimitri Glazkov.

        Add a build-webkit option for enabling Web Timing support.
        https://bugs.webkit.org/show_bug.cgi?id=38924

        * Scripts/build-webkit:

2010-06-25  Jesus Sanchez-Palencia  <jesus.palencia@openbossa.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] QtTestBrowser does not have a "Load" button ; therefore, unable to load pages on touch only symbian devices (portrait mode).
        https://bugs.webkit.org/show_bug.cgi?id=38597

        Make the reload button act as a load button as well.

        * QtTestBrowser/mainwindow.cpp:
        (MainWindow::buildUI):
        (MainWindow::changeLocation):

2010-06-25  Prasad Tammana  <prasadt@chromium.org>

        Reviewed by Dmitry Titov.

        Add empty abortModal() method to all platforms.
        https://bugs.webkit.org/show_bug.cgi?id=40864

        Add an empty abortModal() stub to LayoutTestController on all platforms to get rid of platform specific #ifs in
        platform independent LayoutTestController code.  Without this change, layout tests using LayoutTestController tests
        that use abortModal will become mac specific which is not desirable.

        * DumpRenderTree/LayoutTestController.cpp:
        (abortModalCallback):
        (LayoutTestController::staticFunctions):
        * DumpRenderTree/LayoutTestController.h:
        * DumpRenderTree/chromium/LayoutTestController.cpp:
        (LayoutTestController::LayoutTestController):
        (LayoutTestController::abortModal):
        * DumpRenderTree/chromium/LayoutTestController.h:
        * DumpRenderTree/gtk/LayoutTestControllerGtk.cpp:
        (LayoutTestController::abortModal):
        * DumpRenderTree/qt/LayoutTestControllerQt.h:
        (LayoutTestController::abortModal):
        * DumpRenderTree/win/LayoutTestControllerWin.cpp:
        (LayoutTestController::abortModal):
        * DumpRenderTree/wx/LayoutTestControllerWx.cpp:
        (LayoutTestController::abortModal):

2010-06-25  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Patch for https://bugs.webkit.org/show_bug.cgi?id=41226
        Flesh out injected bundle code for WebKitTestRunner and add basic LayoutTestController.

        * WebKitTestRunner/InjectedBundle/InjectedBundle.cpp: Added.
        (WTR::InjectedBundle::shared):
        (WTR::InjectedBundle::InjectedBundle):
        (WTR::InjectedBundle::_didCreatePage):
        (WTR::InjectedBundle::_willDestroyPage):
        (WTR::InjectedBundle::_didRecieveMessage):
        (WTR::InjectedBundle::initialize):
        (WTR::InjectedBundle::didCreatePage):
        (WTR::InjectedBundle::willDestroyPage):
        (WTR::InjectedBundle::didRecieveMessage):
        * WebKitTestRunner/InjectedBundle/InjectedBundle.h: Added.
        (WTR::InjectedBundle::layoutTestController):
        * WebKitTestRunner/InjectedBundle/InjectedBundleMain.cpp:
        (WKBundleInitialize):
        * WebKitTestRunner/InjectedBundle/InjectedBundlePage.cpp: Added.
        (WTR::InjectedBundlePage::InjectedBundlePage):
        (WTR::InjectedBundlePage::~InjectedBundlePage):
        (WTR::InjectedBundlePage::_didStartProvisionalLoadForFrame):
        (WTR::InjectedBundlePage::_didReceiveServerRedirectForProvisionalLoadForFrame):
        (WTR::InjectedBundlePage::_didFailProvisionalLoadWithErrorForFrame):
        (WTR::InjectedBundlePage::_didCommitLoadForFrame):
        (WTR::InjectedBundlePage::_didFinishLoadForFrame):
        (WTR::InjectedBundlePage::_didFailLoadWithErrorForFrame):
        (WTR::InjectedBundlePage::_didReceiveTitleForFrame):
        (WTR::InjectedBundlePage::_didClearWindowForFrame):
        (WTR::InjectedBundlePage::didStartProvisionalLoadForFrame):
        (WTR::InjectedBundlePage::didReceiveServerRedirectForProvisionalLoadForFrame):
        (WTR::InjectedBundlePage::didFailProvisionalLoadWithErrorForFrame):
        (WTR::InjectedBundlePage::didCommitLoadForFrame):
        (WTR::InjectedBundlePage::didFinishLoadForFrame):
        (WTR::InjectedBundlePage::didFailLoadWithErrorForFrame):
        (WTR::InjectedBundlePage::didReceiveTitleForFrame):
        (WTR::InjectedBundlePage::didClearWindowForFrame):
        * WebKitTestRunner/InjectedBundle/InjectedBundlePage.h: Added.
        (WTR::InjectedBundlePage::page):
        * WebKitTestRunner/InjectedBundle/LayoutTestController.cpp: Added.
        (WTR::LayoutTestController::create):
        (WTR::LayoutTestController::LayoutTestController):
        (WTR::LayoutTestController::~LayoutTestController):
        (WTR::dumpAsTextCallback):
        (WTR::layoutTestControllerObjectFinalize):
        (WTR::LayoutTestController::makeWindowObject):
        (WTR::LayoutTestController::getJSClass):
        (WTR::LayoutTestController::staticFunctions):
        * WebKitTestRunner/InjectedBundle/LayoutTestController.h: Added.
        (WTR::LayoutTestController::dumpAsText):
        (WTR::LayoutTestController::setDumpAsText):
        * WebKitTestRunner/WebKitTestRunner.xcodeproj/project.pbxproj:

2010-06-25  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Make WebKitTestRunner really work with run-webkit-tests. 

        - Add Forwarding headers to allow some cleanup.

        * WebKitTestRunner/ForwardingHeaders: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/ASCIICType.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/Assertions.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/Atomics.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/FastMalloc.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/HashMap.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/HashSet.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/HashTraits.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/Locker.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/MainThread.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/MathExtras.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/Noncopyable.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/OwnPtr.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/OwnPtrCommon.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/PassOwnPtr.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/PassRefPtr.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/Platform.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/RefCounted.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/RefPtr.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/RetainPtr.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/StringExtras.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/ThreadSafeShared.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/Threading.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/ThreadingPrimitives.h: Added.
        * WebKitTestRunner/ForwardingHeaders/wtf/Vector.h: Added.
        * WebKitTestRunner/TestInvocation.cpp:
        (WTR::TestInvocation::dump): Dump the right number of #EOFs.
        * WebKitTestRunner/TestInvocation.h:

2010-06-25  Sam Weinig  <sam@webkit.org>

        Reviewed by Mark Rowe.

        Add support for WebKitTestRunner to old-run-webkit-tests

        - Also adds a script to build WebKitTestRunner for old-run-webkit-tests to use.

        * Scripts/build-webkittestrunner: Added.
        * Scripts/old-run-webkit-tests:

2010-06-25  Adam Barth  <abarth@webkit.org>

        Reviewed by David Levin.

        Incremental build failed on Chromium ews
        https://bugs.webkit.org/show_bug.cgi?id=41011

        The division of responsibility between update-webkit --chromium and
        build-webkit --chromium is slightly unclear.  In this patch, we make
        build-webkit --chromium also update DEPS and re-run GYP in case the
        developer has changed either since they updated.

        This change is also helpful for the EWS, which wants to update DEPS and
        re-run GYP after applying patches, but the EWS doesn't want to run
        update-webkit --chromium because it has a dirty working copy.

        * Scripts/webkitdirs.pm:

2010-06-25  Robert Hogan  <robert@webkit.org>

        Reviewed by Simon Hausmann.

        [Qt] Support evaluateScriptInIsolatedWorld()

        https://bugs.webkit.org/show_bug.cgi?id=40079

        Remove evaluateScriptInIsolatedWorld() from QtWebKit API.
        Remove QWebScriptWorld from exported headers.
        Confine support to DumpRenderTreeSupportQt so that the tests can pass.

        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::reset):
        (LayoutTestController::evaluateScriptInIsolatedWorld):
        * DumpRenderTree/qt/LayoutTestControllerQt.h:

2010-06-25  Anders Carlsson  <andersca@apple.com>

        Revert accidental part and add a newline.

        * MiniBrowser/mac/AppDelegate.m:
        * MiniBrowser/mac/MiniBrowser_Prefix.pch:

2010-06-25  Anders Carlsson  <andersca@apple.com>

        Rubber-stamped by Dan Bernstein.

        Add a LOG macro that expands to a no-op by default.

        * MiniBrowser/MiniBrowser.xcodeproj/project.pbxproj:
        * MiniBrowser/mac/AppDelegate.m:
        (_didRecieveMessageFromInjectedBundle):
        * MiniBrowser/mac/BrowserWindowController.m:
        (-[BrowserWindowController windowShouldClose:]):
        (_didStartProvisionalLoadForFrame):
        (_didReceiveServerRedirectForProvisionalLoadForFrame):
        (_didFailProvisionalLoadWithErrorForFrame):
        (_didCommitLoadForFrame):
        (_didFinishLoadForFrame):
        (_didFailLoadWithErrorForFrame):
        (_didReceiveTitleForFrame):
        (_didFirstLayoutForFrame):
        (_didFirstVisuallyNonEmptyLayoutForFrame):
        (_didBecomeUnresponsive):
        (_didBecomeResponsive):
        (_decidePolicyForNavigationAction):
        (_decidePolicyForNewWindowAction):
        (_createNewPage):
        (_showPage):
        (_closePage):
        (_didNavigateWithNavigationData):
        (_didPerformClientRedirect):
        (_didPerformServerRedirect):
        (_didUpdateHistoryTitle):
        * MiniBrowser/mac/MiniBrowser_Prefix.pch:
        * MiniBrowser/mac/WebBundle/WebBundleMain.m:
        (_didClearWindowForFrame):
        (_didCreatePage):
        (_willDestroyPage):
        (_didRecieveMessage):

2010-06-24  Adam Barth  <abarth@webkit.org>

        Reviewed by Eric Seidel.

        commit-queue is taking too long to land patches because of red trees
        https://bugs.webkit.org/show_bug.cgi?id=41194

        Instead of checking for the tree to be green, we'll just spin hot
        trying to land patches.  This is probably too extreme in ignoring the
        tree, but I think we should try it for a while to see if we have
        trouble.  That will help us find the right balance.

        * Scripts/webkitpy/tool/commands/queues.py:
        * Scripts/webkitpy/tool/commands/queues_unittest.py:

2010-06-24  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Xan Lopez.

        [GTK] Clean up the use of gdk_window_get_root_coords in EventSender
        https://bugs.webkit.org/show_bug.cgi?id=40843

        Define the version for old GTK+s in a way that is forward-compatible
        and clean up the logic a bit.

        * DumpRenderTree/gtk/EventSender.cpp:
        (gdk_window_get_root_coords): Renamed and cleaned up.
        (prepareMouseButtonEvent): Remove #ifdefs.
        (mouseMoveToCallback): Remove #ifdefs.

2010-06-24  Dimitri Glazkov  <dglazkov@chromium.org>

        Reviewed by Eric Seidel.

        Fix NewRunWebKitTests to work on Windows.
        https://bugs.webkit.org/show_bug.cgi?id=41180

        * BuildSlaveSupport/build.webkit.org-config/master.cfg: Added "perl" as first arguments,
            because Windows fails to understand what we're asking of it.

2010-06-24  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Xan Lopez.

        [GTK] The url passed to the WebView during layout tests is invalid
        https://bugs.webkit.org/show_bug.cgi?id=40832

        Set the test URL to the full real file URL and do a small cleanup.
        Previously a URL like file://relative/path/to/test.html was passed
        to the WebView. This malformed file URL would be returned by
        webkit_web_view_get_url and webkit_web_frame_get_url.

        * DumpRenderTree/gtk/DumpRenderTree.cpp:
        (shouldLogFrameLoadDelegates): Change to take a const string& as the argument.
        (shouldOpenWebInspector): Change to take a const string& as the argument.
        (shouldEnableDeveloperExtras): Change to take a const string& as the argument.
        (runTest): Pass the full file:// URL to the view. Remove the superfluous url variable.

2010-06-24  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Fix WebKitTestRunner Makefile typos.

        * WebKitTestRunner/Makefile:

2010-06-24  Adele Peterson  <adele@apple.com>

        Reviewed by Eric Carlson.

        DumpRenderTree part of testing <rdar://problem/8093680> "Paste and Match Style" should fire paste events
        https://bugs.webkit.org/show_bug.cgi?id=41085

        * DumpRenderTree/mac/DumpRenderTree.mm: (resetWebViewToConsistentStateBeforeTesting):
        Clear the general pasteboard in between tests so Cut,Copy, and setData on ClipboardData won't have lasting effects.

2010-06-23  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Patch for https://bugs.webkit.org/show_bug.cgi?id=41086
        Add new WebKitTestRunner project (ie. DRT for WebKit2).

        - Mac only.
        - run-webkit-tests has not been modified to call it yet.
        - Only dumps the render tree at this time. 

        * WebKitTestRunner: Added.
        * WebKitTestRunner/Configurations: Added.
        * WebKitTestRunner/Configurations/Base.xcconfig: Added.
        * WebKitTestRunner/Configurations/DebugRelease.xcconfig: Added.
        * WebKitTestRunner/Configurations/InjectedBundle.xcconfig: Added.
        * WebKitTestRunner/Configurations/WebKitTestRunner.xcconfig: Added.
        * WebKitTestRunner/InjectedBundle: Added.
        * WebKitTestRunner/InjectedBundle-Info.plist: Added.
        * WebKitTestRunner/InjectedBundle/InjectedBundleMain.cpp: Added.
        (_didStartProvisionalLoadForFrame):
        (_didReceiveServerRedirectForProvisionalLoadForFrame):
        (_didFailProvisionalLoadWithErrorForFrame):
        (_didCommitLoadForFrame):
        (_didFinishLoadForFrame):
        (_didFailLoadWithErrorForFrame):
        (_didReceiveTitleForFrame):
        (_didClearWindow):
        (_didCreatePage):
        (_willDestroyPage):
        (_didRecieveMessage):
        (WKBundleInitialize):
        * WebKitTestRunner/Makefile: Added.
        * WebKitTestRunner/PlatformWebView.h: Added.
        (WTR::PlatformWebView::platformView):
        * WebKitTestRunner/TestController.cpp: Added.
        (WTR::TestController::shared):
        (WTR::TestController::TestController):
        (WTR::TestController::initialize):
        (WTR::TestController::runTest):
        (WTR::TestController::runTestingServerLoop):
        (WTR::TestController::run):
        * WebKitTestRunner/TestController.h: Added.
        (WTR::TestController::verbose):
        (WTR::TestController::injectedBundlePath):
        * WebKitTestRunner/TestInvocation.cpp: Added.
        (WTR::createWKURL):
        (WTR::TestInvocation::TestInvocation):
        (WTR::TestInvocation::~TestInvocation):
        (WTR::TestInvocation::invoke):
        (WTR::TestInvocation::dump):
        (WTR::TestInvocation::initializeMainWebView):
        (WTR::TestInvocation::didStartProvisionalLoadForFrame):
        (WTR::TestInvocation::didReceiveServerRedirectForProvisionalLoadForFrame):
        (WTR::TestInvocation::didFailProvisionalLoadWithErrorForFrame):
        (WTR::TestInvocation::didCommitLoadForFrame):
        (WTR::TestInvocation::didFinishLoadForFrame):
        (WTR::TestInvocation::didFailLoadForFrame):
        (WTR::TestInvocation::renderTreeExternalRepresentationFunction):
        (WTR::TestInvocation::renderTreeExternalRepresentationDisposeFunction):
        * WebKitTestRunner/TestInvocation.h: Added.
        * WebKitTestRunner/WebKitTestRunner.xcodeproj: Added.
        * WebKitTestRunner/WebKitTestRunner.xcodeproj/project.pbxproj: Added.
        * WebKitTestRunner/WebKitTestRunnerPrefix.h: Added.
        * WebKitTestRunner/mac: Added.
        * WebKitTestRunner/mac/PlatformWebViewMac.mm: Added.
        (WTR::PlatformWebView::PlatformWebView):
        (WTR::PlatformWebView::~PlatformWebView):
        (WTR::PlatformWebView::page):
        * WebKitTestRunner/mac/TestInvocationMac.mm: Added.
        (WTR::TestInvocation::runUntil):
        * WebKitTestRunner/mac/main.mm: Added.
        (main):

2010-06-24  Luiz Agostini  <luiz.agostini@openbossa.org>

        Unreviewed. Adding myself to the committers list.

        * Scripts/webkitpy/common/config/committers.py:

2010-06-23  Kevin Ollivier  <kevino@theolliviers.com>

        [wx] Build fix, adding new LayoutTestController methods and enabling SVG_FOREIGN_OBJECT.

        * DumpRenderTree/wx/LayoutTestControllerWx.cpp:
        (LayoutTestController::isPageBoxVisible):
        (LayoutTestController::pageAreaRectInPixels):
        (LayoutTestController::preferredPageSizeInPixels):
        * wx/build/settings.py:

2010-06-23  James Robinson  <jamesr@chromium.org>

        Unreviewed.  Add my IRC handle to committers.py so the sheriffbot can yell at me.

        * Scripts/webkitpy/common/config/committers.py:

2010-06-23  Kent Tamura  <tkent@chromium.org>

        Reviewed by Dimitri Glazkov.

        Correct Chromium test configuration
        https://bugs.webkit.org/show_bug.cgi?id=41057

        * BuildSlaveSupport/build.webkit.org-config/master.cfg:
         - Add "--use-drt" option for NRWT. It is required for Chromium and
           ignored for other platforms.
         - Skip JSC test on Chromium
        * BuildSlaveSupport/test-result-archive:
          Add Chromium support.

2010-06-23  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Fix for https://bugs.webkit.org/show_bug.cgi?id=41073
        WebKit2: Flesh out more of the InjectedBundle client API

        * MiniBrowser/mac/WebBundle/WebBundleMain.m:
        (_didStartProvisionalLoadForFrame):
        (_didReceiveServerRedirectForProvisionalLoadForFrame):
        (_didFailProvisionalLoadWithErrorForFrame):
        (_didCommitLoadForFrame):
        (_didFinishLoadForFrame):
        (_didFailLoadWithErrorForFrame):
        (_didReceiveTitleForFrame):
        (_didClearWindowForFrame):
        (_didCreatePage):
        (_willDestroyPage):
        (WKBundleInitialize):

2010-06-23  Yuzo Fujishima  <yuzo@google.com>

        Reviewed by Shinichiro Hamaji.

        Implement page format data programming interface.
        Add methods for testing.
        https://bugs.webkit.org/show_bug.cgi?id=37538

        * DumpRenderTree/LayoutTestController.cpp:
        (parsePageNumber):
        (isPageBoxVisibleCallback):
        (pageAreaRectInPixelsCallback):
        (preferredPageSizeInPixelsCallback):
        (LayoutTestController::staticFunctions):
        * DumpRenderTree/LayoutTestController.h:
        * DumpRenderTree/gtk/LayoutTestControllerGtk.cpp:
        (LayoutTestController::isPageBoxVisible):
        (LayoutTestController::pageAreaRectInPixels):
        (LayoutTestController::preferredPageSizeInPixels):
        * DumpRenderTree/mac/LayoutTestControllerMac.mm:
        (LayoutTestController::isPageBoxVisible):
        (LayoutTestController::pageAreaRectInPixels):
        (LayoutTestController::preferredPageSizeInPixels):
        * DumpRenderTree/win/LayoutTestControllerWin.cpp:
        (LayoutTestController::isPageBoxVisible):
        (LayoutTestController::pageAreaRectInPixels):
        (LayoutTestController::preferredPageSizeInPixels):

2010-06-23  Sam Magnuson  <smagnuson@netflix.com>

        Reviewed by Shinichiro Hamaji.

        Follow proper convention for if/switch/while as I've discovered
        them to be through my review processes.
        https://bugs.webkit.org/show_bug.cgi?id=40723

        Modified test so that if( foo ) is not allowed as it appears not
        to be the accepted convention.

        * Scripts/webkitpy/style/checkers/cpp.py:
        * Scripts/webkitpy/style/checkers/cpp_unittest.py:

2010-06-22  Eric Seidel  <eric@webkit.org>

        Reviewed by Adam Barth.

        Run clean-header-guards to fix some header guards
        https://bugs.webkit.org/show_bug.cgi?id=41044

        No functional changes, thus no tests.

        This entire change was generated by running
        clean-header-guards, and then reverting changes
        to files which shouldn't be changed.  Those which
        are left all should be updated.

        Some of these changes are just fixing 755 permissions
        to be 644, since it seems various files have the wrong
        execute bit which don't need it.  clean-header-guards
        made those (welcome) permission fixes unintentionally.

        * DumpRenderTree/chromium/WebThemeControlDRT.h:
        * DumpRenderTree/chromium/WebThemeEngineDRT.h:
        * QtTestBrowser/fpstimer.h:

2010-06-22  Adam Barth  <abarth@webkit.org>

        Reviewed by Eric Seidel.

        Rename HTMLDocumentParser to LegacyHTMLDocumentParser
        https://bugs.webkit.org/show_bug.cgi?id=41043

        Update the hash.

        * Scripts/do-webcore-rename:

2010-06-22  Sam Magnuson  <smagnuson@netflix.com>

        Reviewed by Shinichiro Hamaji.

        Follow proper convention for variable declaration spacing.
        https://bugs.webkit.org/show_bug.cgi?id=40724

        Modified test so that 'int   a;' is not allowed.

        * Scripts/webkitpy/style/checkers/cpp.py:
        * Scripts/webkitpy/style/checkers/cpp_unittest.py:

2010-06-22  Eric Seidel  <eric@webkit.org>

        Unreviewed.  Add Tony Gentilcore now that he's a committer.

        * Scripts/webkitpy/common/config/committers.py:

2010-06-22  Eric Seidel  <eric@webkit.org>

        Reviewed by Adam Barth.

        Remove Gtk 64-Release bot from core since it's broken
        https://bugs.webkit.org/show_bug.cgi?id=41022

        This bot alone has been responsible for more than 72 hours of
        commit-queue blockage in the last week.  The bot is broken -- keeps
        losing its display server or similar.  Until the Gtk folks can fix the
        bot, we need to remove it from core.  The WebKit community can't keep
        it green as is.

        * Scripts/webkitpy/common/net/buildbot.py:
        * Scripts/webkitpy/common/net/buildbot_unittest.py:

2010-06-21  Dumitru Daniliuc  <dumi@chromium.org>

        Reviewed by Eric Seidel.

        Fix the Windows build.
        https://bugs.webkit.org/show_bug.cgi?id=40972

        * DumpRenderTree/win/ImageDiff.vcproj:

2010-06-21  Prasad Tammana  <prasadt@chromium.org>

        Reviewed by Darin Adler, Dmitry Titov.

        DumpRenderTree should allow tests with modal dialogs
        https://bugs.webkit.org/show_bug.cgi?id=35350

        * DumpRenderTree/LayoutTestController.cpp:
        (abortModalCallback):
        (LayoutTestController::staticFunctions):
        * DumpRenderTree/LayoutTestController.h:
        * DumpRenderTree/mac/LayoutTestControllerMac.mm:
        (LayoutTestController::abortModal):
        Add abortModal method to LayoutTestController and make it available from script.

        * DumpRenderTree/mac/UIDelegate.mm: Add support for showModalDialog.
        (-[UIDelegate modalWindowWillClose:]): Observer for NSWindowWillCloseNotifications to call
        abortModal from when modal window closes.
        (-[UIDelegate webViewRunModal:]): Delegate method for showModalDialog to run the modal loop.

2010-06-21  Simon Fraser  <simon.fraser@apple.com>

        Reviewed by Anders Carlsson.
        
        Rename DrawingAreaProxyUpdateChunk to ChunkedUpdateDrawingArea
        https://bugs.webkit.org/show_bug.cgi?id=40948
        
        Have the script look in WebKit2.

        * Scripts/do-webcore-rename:

2010-06-21  Robert Hogan  <robert@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Unskip plugins/get-url-that-the-resource-load-delegate-will-disallow.html

        It's a Mac-specific test so just add the required LayoutTestController
        function as a no-op to avoid failing. Similar approach adopted by other
        ports.

        https://bugs.webkit.org/show_bug.cgi?id=33344

        * DumpRenderTree/qt/LayoutTestControllerQt.h:
        (LayoutTestController::addDisallowedURL):

2010-06-21  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Patch for https://bugs.webkit.org/show_bug.cgi?id=40940
        Add message passing support to the WebKit2 API.

        - Add some test messages.

        * MiniBrowser/mac/AppDelegate.m:
        (_didRecieveMessageFromInjectedBundle):
        (-[BrowserAppDelegate init]):
        * MiniBrowser/mac/WebBundle/WebBundleMain.m:
        (_didClearWindow):
        (_didCreatePage):
        (_didRecieveMessage):
        (WKBundleInitialize):

2010-06-21  Drew Wilson  <atwilson@chromium.org>

        Unreviewed.

        Rolling back 61551 and 61555 due to test failures.

        * DumpRenderTree/LayoutTestController.cpp:
        (LayoutTestController::staticFunctions):
        * DumpRenderTree/LayoutTestController.h:
        * DumpRenderTree/mac/LayoutTestControllerMac.mm:
        (LayoutTestController::setEditingBehavior):
        * DumpRenderTree/mac/UIDelegate.mm:

2010-06-21  Anders Carlsson  <andersca@apple.com>

        Reviewed by Sam Weinig.

        Make DumpRenderTree build with clang++

        * DumpRenderTree/mac/DumpRenderTreePasteboard.m:
        (-[LocalPasteboard setPropertyList:forType:]):
        * DumpRenderTree/mac/DumpRenderTreeWindow.mm:
        (-[DumpRenderTreeWindow keyDown:]):
        * DumpRenderTree/mac/LayoutTestControllerMac.mm:
        (LayoutTestController::elementDoesAutoCompleteForElementWithId):
        (LayoutTestController::isCommandEnabled):

2010-06-21  Satish Sampath  <satish@chromium.org>

        Reviewed by Steve Block.

        Speech Input Patch 0: Added compilation argument to conditionally compile pending patches.
        https://bugs.webkit.org/show_bug.cgi?id=40878

        * Scripts/build-webkit:

2010-06-21  Kent Tamura  <tkent@chromium.org>

        Reviewed by Dimitri Glazkov.

        [DRT/Chromium] Initialization for http/tests/loading/
        https://bugs.webkit.org/show_bug.cgi?id=40902

        * DumpRenderTree/chromium/TestShell.cpp:
        (TestShell::runFileTest):

2010-06-21  Jocelyn Turcotte  <jocelyn.turcotte@nokia.com>

        Unreviewed.

        Adding myself to the committers list.

        * Scripts/webkitpy/common/config/committers.py:

2010-06-20  Kent Tamura  <tkent@chromium.org>

        Reviewed by Dimitri Glazkov.

        [DRT/Chromium] Add --allow-external-pages option
        https://bugs.webkit.org/show_bug.cgi?id=40762

        Add --allow-external-pages introduced by Chromium r45403.
        http://src.chromium.org/viewvc/chrome?view=rev&revision=45403

        * DumpRenderTree/chromium/DumpRenderTree.cpp:
        (main):
        * DumpRenderTree/chromium/TestShell.cpp:
        (TestShell::TestShell):
        * DumpRenderTree/chromium/TestShell.h:
        (TestShell::allowExternalPages):
        (TestShell::setAllowExternalPages):
        * DumpRenderTree/chromium/WebViewHost.cpp:
        (WebViewHost::willSendRequest):

2010-06-20  Joseph Pecoraro  <joepeck@webkit.org>

        Reviewed by Adam Barth.

        Sheriffbot: Should allow "r" in SVN_REVISION
        https://bugs.webkit.org/show_bug.cgi?id=40889

        * Scripts/webkitpy/tool/bot/irc_command.py: remove a leading "r" from SVN_REVISION if it exists
        * Scripts/webkitpy/tool/bot/sheriffircbot_unittest.py: test an SVN_REVISION with a leading r.

2010-06-20  Joseph Pecoraro  <joepeck@webkit.org>

        Reviewed by Dimitri Glazkov.

        Python Tests Fail after r61508
        https://bugs.webkit.org/show_bug.cgi?id=40891

        Test's regex list needed to be updated to match the new
        regex list in the source code. Added new bots to the
        example_buildbots list.

        Regex list fixed in r61512. Updated bot list.

        * Scripts/webkitpy/common/net/buildbot_unittest.py:

2010-06-20  Dimitri Glazkov  <dglazkov@chromium.org>

        Unreviewed, build fix.

        Tweak test regexp list to match the change in http://trac.webkit.org/changeset/61508.

        * Scripts/webkitpy/common/net/buildbot_unittest.py: Tweaked regexp.

2010-06-19  Justin Schuh  <jschuh@chromium.org>

        Unreviewed.

        Adding myself to the committers list.

        * Scripts/webkitpy/common/config/committers.py:

2010-06-19  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Fix for https://bugs.webkit.org/show_bug.cgi?id=40882
        Add ability to have a WebProcess per WebContext.

        Move to use new shared contexts API.

        * MiniBrowser/mac/AppDelegate.h:
        * MiniBrowser/mac/AppDelegate.m:
        (-[BrowserAppDelegate init]):
        (-[BrowserAppDelegate getCurrentPageNamespace]):
        (-[BrowserAppDelegate validateMenuItem:]):
        (-[BrowserAppDelegate _setProcessModel:]):
        (-[BrowserAppDelegate setSharedProcessProcessModel:]):
        (-[BrowserAppDelegate setSharedThreadProcessModel:]):
        * MiniBrowser/win/BrowserView.cpp:
        (BrowserView::create):

2010-06-02  Robert Hogan  <robert@webkit.org>

        Reviewed by Adam Barth.

        [Qt] Support evaluateScriptInIsolatedWorld()

        https://bugs.webkit.org/show_bug.cgi?id=40079

        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::evaluateScriptInIsolatedWorld):
        * DumpRenderTree/qt/LayoutTestControllerQt.h:

2010-06-18  Dimitri Glazkov  <dglazkov@chromium.org>

        Reviewed by Darin Adler.

        Add three more non-core Chromium builders to start testing DumpRenderTree.
        https://bugs.webkit.org/show_bug.cgi?id=40335

        * BuildSlaveSupport/build.webkit.org-config/config.json: Added 3 builders.

2010-06-18  Drew Wilson  <atwilson@chromium.org>

        Reviewed by Darin Fisher.

        [Chromium] Plumbing for top-level frame names
        https://bugs.webkit.org/show_bug.cgi?id=40430

        * DumpRenderTree/chromium/WebViewHost.cpp:
        (WebViewHost::reset):
        Changed obsolete call to clearName() to use setName(WebString()) instead.

2010-06-18  Sam Weinig  <weinig@apple.com>

        Rolling http://trac.webkit.org/changeset/61297 back in.

        * MiniBrowser/MiniBrowser.xcodeproj/project.pbxproj:
        * MiniBrowser/mac/WebBundle/WebBundleMain.c: Removed.
        * MiniBrowser/mac/WebBundle/WebBundleMain.m: Added.
        (_didClearWindow):
        (_didCreatePage):
        (WKBundleInitialize):

2010-06-18  Alexey Proskuryakov  <ap@apple.com>

        Reviewed by Darin Adler.

        https://bugs.webkit.org/show_bug.cgi?id=40803
        TestNetscapePlugin has an incorrect implementation of "property" property

        * DumpRenderTree/TestNetscapePlugIn.subproj/PluginObject.cpp: (pluginGetProperty): Don't
        pass a static string back, it's going to be released by NPAPI implementation.

2010-06-18  Leandro Pereira  <leandro@profusion.mobi>

        Unreviewed.

        Adding myself to the committers list.

        * Scripts/webkitpy/common/config/committers.py:

2010-06-17  Tony Chang  <tony@chromium.org>

        Reviewed by Kent Tamura.

        [chromium] cleanup redundant DEPS value and remove buildbot cleanup code
        https://bugs.webkit.org/show_bug.cgi?id=40615

        * Scripts/update-webkit-chromium: remove directory removal of third_party in old checkouts

2010-06-17  Ada Chan  <adachan@apple.com>

        Rolling out http://trac.webkit.org/changeset/61297 due to build errors.

        * MiniBrowser/MiniBrowser.xcodeproj/project.pbxproj:
        * MiniBrowser/mac/WebBundle/WebBundleMain.c: Copied from MiniBrowser/mac/WebBundle/WebBundleMain.c.
        * MiniBrowser/mac/WebBundle/WebBundleMain.m: Removed.

2010-06-17  Darin Adler  <darin@apple.com>

        One more try at fix for Chromium build.

        * DumpRenderTree/chromium/TestShell.cpp:
        (TestShell::TestShell): Use set again instead of =.

2010-06-17  Darin Adler  <darin@apple.com>

        Fix Chromium build.

        I didn't realize that neither Chromium nor Qt share the DumpRenderTree
        code with all the other platforms! Wow, that should be fixed at some point.

        * DumpRenderTree/chromium/TestShell.cpp:
        (TestShell::TestShell): Changed back to using "new".
        * DumpRenderTree/chromium/TestShell.h: Changed back to OwnPtr.

2010-06-17  Simon Hausmann  <simon.hausmann@nokia.com>

        Unreviewed Qt build fix.

        LayoutTestController in the Qt DRT is not using refs :)

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::DumpRenderTree::DumpRenderTree):

2010-06-17  Darin Adler  <darin@apple.com>

        Reviewed by Sam Weinig.

        Use adoptRef and create functions in more code paths
        https://bugs.webkit.org/show_bug.cgi?id=40760

        * DumpRenderTree/DumpRenderTree.h: Change gLayoutTestController to a RefPtr.

        * DumpRenderTree/LayoutTestController.cpp:
        (LayoutTestController::create): Added.
        * DumpRenderTree/LayoutTestController.h: Declare the create function.

        * DumpRenderTree/chromium/TestShell.cpp:
        (TestShell::TestShell): Use create instead of new.
        * DumpRenderTree/chromium/TestShell.h: Use RefPtr instead of OwnPtr.

        * DumpRenderTree/gtk/DumpRenderTree.cpp:
        (runTest): Use RefPtr and create instead of OwnPtr and new.

        * DumpRenderTree/mac/DumpRenderTree.mm:
        (runTest): Use RefPtr and create instead of OwnPtr and new.

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::DumpRenderTree::DumpRenderTree): Use create and releaseRef
        instead of new.

        * DumpRenderTree/win/DumpRenderTree.cpp:
        (runTest): Use RefPtr and create instead of OwnPtr and new.

        * DumpRenderTree/wx/DumpRenderTreeWx.cpp:
        (runTest): Use RefPtr and create instead of OwnPtr and new.
        (MyApp::OnInit): Removed unneeded code to delete the layout
        test controller. This is done during each test.

2010-06-17  Kent Tamura  <tkent@chromium.org>

        Reviewed by Shinichiro Hamaji.

        [DRT/Chromium] Fix a bug of Windows pixel tests
        https://bugs.webkit.org/show_bug.cgi?id=40763

        * DumpRenderTree/chromium/TestEventPrinter.cpp:
        (TestShellPrinter::handleImage):

2010-06-16  Kent Tamura  <tkent@chromium.org>

        Reviewed by Shinichiro Hamaji.

        [DRT/Chromium] Fix crash on Mac Release
        https://bugs.webkit.org/show_bug.cgi?id=40759

        * DumpRenderTree/chromium/WebViewHost.cpp:
        (WebViewHost::paintRect): We should not use m_canvas directly because
          it is created lazily in canvas().

2010-06-16  Kevin Ollivier  <kevino@theolliviers.com>

        [wx] Build fix after new method addition.

        * DumpRenderTree/wx/LayoutTestControllerWx.cpp:
        (LayoutTestController::pageProperty):

2010-06-16  Kent Tamura  <tkent@chromium.org>

        Reviewed by Dimitri Glazkov.

        [DRT/Chromium] Set current working directory for each of tests
        https://bugs.webkit.org/show_bug.cgi?id=40668

        This change fixes tests with eventSender.beginDragWithFiles().

        * DumpRenderTree/chromium/DumpRenderTree.cpp:
        (runTest):

2010-06-16  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Gustavo Noronha Silva.

        [GTK] r60803 broke media/controls-drag-timebar.html
        https://bugs.webkit.org/show_bug.cgi?id=40269

        Only queue events while the mouse button is down, if drag mode is enabled. Some
        tests may disable drag mode, to prevent the queuing of events in this situation.

        * DumpRenderTree/gtk/EventSender.cpp:
        (sendOrQueueEvent): Only queue events here if dragMode is true.

2010-06-16  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Gustavo Noronha Silva.

        [GTK] Remove the abuse of GDK_CURRENT_TIME in the DRT
        https://bugs.webkit.org/show_bug.cgi?id=40600

        * DumpRenderTree/gtk/EventSender.cpp:
        (prepareMouseButtonEvent): Remove logic adding an offset to GDK_CURRENT_TIME.

2010-06-16  Adam Barth  <abarth@webkit.org>

        Reviewed by Dimitri Glazkov.

        Add a hidden land-cowboy command to webkit-patch to help land quick
        build fixes.

        * Scripts/webkitpy/tool/commands/download.py:
        * Scripts/webkitpy/tool/steps/preparechangelog.py:

2010-06-16  Adam Roben  <aroben@apple.com>

        Convert console messages to UTF-8 before printing them

        Speculative fix for <http://webkit.org/b/40731> REGRESSION (r61234):
        http/tests/security/xssAuditor/embed-tag-null-char.html and
        http/tests/security/xssAuditor/object-embed-tag-null-char.html fail on
        Windows. (I can't test the fix because Apache is crashing on my
        computer.)

        Reviewed by Alexey Proskuryakov.

        * DumpRenderTree/win/DumpRenderTree.cpp:
        (toUTF8): Extracted the code into an overload that takes a wide string
        and a length, then added an overload that takes a wstring.

        * DumpRenderTree/win/DumpRenderTreeWin.h: Declare the new toUTF8
        overload.

        * DumpRenderTree/win/UIDelegate.cpp:
        (UIDelegate::webViewAddMessageToConsole): Use toUTF8 to convert to
        UTF-8 instead of letting printf convert to the current code page.

2010-06-16  Drew Wilson  <atwilson@chromium.org>

        Reviewed by Kent Tamura.

        [Chromium] Plumbing for top-level frame names
        https://bugs.webkit.org/show_bug.cgi?id=40430

        * DumpRenderTree/chromium/WebViewHost.cpp:
        (WebViewHost::createView):
        Migrate to new createView() API.
        * DumpRenderTree/chromium/WebViewHost.h:
        Remove obsolete createView() methods, add new createView() API that takes a frameName parameter.

2010-06-16  Diego Gonzalez  <diegohcg@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Scroll wheel event support to graphics based DRT
        https://bugs.webkit.org/show_bug.cgi?id=40577

        * DumpRenderTree/qt/EventSenderQt.cpp:
        (EventSender::continuousMouseScrollBy):
        (EventSender::createGraphicsSceneWheelEvent):
        * DumpRenderTree/qt/EventSenderQt.h:

2010-06-16  Adam Roben  <aroben@apple.com>

        Remove a stray newline from the Windows version of TestNetscapePlugin

        Reviewed by Alexey Proskuryakov.

        Fixes <http://webkit.org/b/40728>
        plugins/geturlnotify-during-document-teardown.html fails on Windows

        * DumpRenderTree/win/TestNetscapePlugin/main.cpp:
        (NPP_Destroy): Removed extra newline that the Mac version doesn't
        have.

2010-06-16  Adam Roben  <aroben@apple.com>

        Respect LayoutTestController::isPrinting on Windows

        This gets some printing tests closer to passing (like
        printing/page-rule-in-media-query.html).

        Fixes <http://webkit.org/b/40727>.

        Reviewed by Dan Bernstein.

        * DumpRenderTree/win/DumpRenderTree.cpp:
        (dump): Pass LayoutTestController::isPrinting to
        IWebFramePrivate::renderTreeAsExternalRepresentation.

2010-06-15  Adam Barth  <abarth@webkit.org>

        Reviewed by Eric Seidel.

        Enable HTML5 lexer
        https://bugs.webkit.org/show_bug.cgi?id=40650

        * DumpRenderTree/mac/DumpRenderTree.mm:
        (initializeGlobalsFromCommandLineOptions):

2010-06-10  Yuzo Fujishima  <yuzo@google.com>

        Reviewed by Shinichiro Hamaji.

        Implement render style selection for pages to support CSS3 Paged Media.
        https://bugs.webkit.org/show_bug.cgi?id=35961

        * DumpRenderTree/LayoutTestController.cpp:
        (parsePagePropertyParameters):
        (pagePropertyCallback):
        (LayoutTestController::staticFunctions):
        * DumpRenderTree/LayoutTestController.h:
        * DumpRenderTree/gtk/LayoutTestControllerGtk.cpp:
        (LayoutTestController::pageProperty):
        * DumpRenderTree/mac/LayoutTestControllerMac.mm:
        (LayoutTestController::pageProperty):
        * DumpRenderTree/win/LayoutTestControllerWin.cpp:
        (LayoutTestController::pageProperty):

2010-06-15  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Fix for https://bugs.webkit.org/show_bug.cgi?id=40630
        WebKit2: Add mechanism to inject code into the WebProcess on startup

        Add initial InjectedBundle support.

        * MiniBrowser/MiniBrowser.xcodeproj/project.pbxproj:
        * MiniBrowser/WebBundle-Info.plist: Added.
        Add test InjectedBundle to the project.

        * MiniBrowser/mac/AppDelegate.m:
        (-[BrowserAppDelegate init]):
        Get the path to the WebBundle from the the main bundle and pass it to the new
        WKContextCreateWithInjectedBundlePath function.

        * MiniBrowser/mac/BrowserWindowController.m:
        (_didChangeProgress):
        Fix the build.  This has been broken for a while.

        * MiniBrowser/mac/WebBundle: Added.
        * MiniBrowser/mac/WebBundle/WebBundleMain.c: Added.
        (_didCreatePage):
        (WKBundleInitialize):
        Add really basic InjectedBundle.

        * MiniBrowser/win/BrowserView.cpp:
        (BrowserView::create):
        Switch from WKContextCreateWithProcessModel to WKContextCreate and remove commented out code.

2010-06-15  Dumitru Daniliuc  <dumi@chromium.org>

        Reviewed by Darin Adler.

        Adding myself to the reviewers list.
        https://bugs.webkit.org/show_bug.cgi?id=40693

        * Scripts/webkitpy/common/config/committers.py:

2010-06-15  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Xan Lopez.

        Switch to using GIO methods instead of realpath in GtkLauncher to determine
        the file URI. This should remove warnings about realpath being undefined
        when compiling with '-ansi'.

        * GtkLauncher/main.c:
        (filenameToURL): Use GIO instead of realpath to determine file URI.

2010-06-15  Adam Roben  <aroben@apple.com>

        Remove the redundant set-apple-windows-environment-variables script

        Apparently update-webkit does this for you these days.

        Rubber-stamped by Steve Falkenburg.

        * Scripts/set-apple-windows-environment-variables: Removed.

2010-06-14  Adam Roben  <aroben@apple.com>

        Add a script to set the WebKitOutputDir and WebKitLibrariesDir
        environment variables

        Fixes <http://webkit.org/b/40595>.

        Reviewed by Steve Falkenburg.

        * Scripts/set-apple-windows-environment-variables: Added.
        (to_windows_path): Passes the passed-in path through cygpath to
        generate a Windows-style path.
        (main): Sets the WebKitOutputDir and WebKitLibrariesDir environment
        variables to their defaults, if they aren't already set.

2010-06-14  Adam Roben  <aroben@apple.com>

        Speed up run-safari/debug-safari on Windows

        Fixes <http://webkit.org/b/40586>.

        Reviewed by Steve Falkenburg.

        * Scripts/webkitdirs.pm:
        (runSafari): When debugging, set up the environment to run Safari
        using the built WebKit.dll, then use "devenv /debugexe Safari.exe" to
        actually launch the debugger. When not debugging, just run WebKit.exe
        and it will do the rest for us.

2010-06-15  Diego Gonzalez  <diegohcg@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] DRT EventSender support to graphics context events
        https://bugs.webkit.org/show_bug.cgi?id=40324

        * DumpRenderTree/qt/EventSenderQt.cpp:
        (EventSender::contextClick):

2010-06-14  Tony Chang  <tony@chromium.org>

        Reviewed by Darin Fisher.

        [chromium] checkout chromium third_party directly
        https://bugs.webkit.org/show_bug.cgi?id=40556

        * Scripts/update-webkit-chromium: some migration code for the bots

2010-06-14  Alexey Proskuryakov  <ap@apple.com>

        Chromium build fix.

        * DumpRenderTree/chromium/EventSender.cpp: (EventSender::keyDown): Chromium uses differently
        named constants for Windows virtual key codes, replacing VK_DELETE with VKEY_DELETE.

2010-06-14  Alexey Proskuryakov  <ap@apple.com>

        Reviewed by Darin Adler.

        https://bugs.webkit.org/show_bug.cgi?id=40529
        eventSender.keyDown("delete") incorrectly sends a backspace on some platforms

        * DumpRenderTree/mac/EventSendingController.mm:
        (-[EventSendingController keyDown:withModifiers:withLocation:]): We were sending a broken
        event for "delete" - it had virtual key code from forward delete, and text from backspace.
        Fixed "delete" to mean forward delete.

        * DumpRenderTree/chromium/EventSender.cpp: (EventSender::keyDown):
        * DumpRenderTree/gtk/EventSender.cpp: (keyDownCallback):
        * DumpRenderTree/win/EventSender.cpp: (keyDownCallback):
        Mac DRT confusion has propagated to other platforms, fixing those.

2010-06-14  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Xan Lopez.

        Small GtkLauncher build fix for some systems.

        * GtkLauncher/main.c: Add <limit.h> include.

2010-06-14  Mahesh Kulkarni  <mahesh.kulkarni@nokia.com>

        Reviewed by Laszlo Gombos.

        [Qt] navigator.geolocation support for Qt port
        https://bugs.webkit.org/show_bug.cgi?id=39724

        Implementation for geolocation cases to DumpRenderTreeQt

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::WebPage::allowGeolocationRequest):
        * DumpRenderTree/qt/DumpRenderTreeQt.h:
        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::setGeolocationPermission):
        (LayoutTestController::setMockGeolocationError):
        (LayoutTestController::setMockGeolocationPosition):
        * DumpRenderTree/qt/LayoutTestControllerQt.h:
        (LayoutTestController::isGeolocationPermissionSet):
        (LayoutTestController::geolocationPermission):

2010-06-13  Nathan Lawrence  <nlawrence@apple.com>

        Reviewed by Darin Adler.

        Outside of Xcode (make or WebKitTools/Scripts), there doesn't seem to
        be a way of overwriting the Xcode system path.  Making
        $WEBKITOUTPUTDIR take precedence over the system default would make
        this possible.

        * Scripts/webkitdirs.pm:

2010-06-13  Chris Fleizach  <cfleizach@apple.com>

        Reviewed by Darin Adler.

        AX: link won't return linked element if URL contains #
        https://bugs.webkit.org/show_bug.cgi?id=40192

        * DumpRenderTree/AccessibilityUIElement.cpp:
        (linkedUIElementAtIndexCallback):
        (AccessibilityUIElement::getJSClass):
        * DumpRenderTree/AccessibilityUIElement.h:
        * DumpRenderTree/gtk/AccessibilityUIElementGtk.cpp:
        (AccessibilityUIElement::linkedUIElementAtIndex):
        * DumpRenderTree/mac/AccessibilityUIElementMac.mm:
        (AccessibilityUIElement::linkedUIElementAtIndex):
        * DumpRenderTree/win/AccessibilityUIElementWin.cpp:
        (AccessibilityUIElement::linkedUIElementAtIndex):

2010-06-13  Adam Barth  <abarth@webkit.org>

        Reviewed by Darin Adler.

        webkit-patch should add a bug URL to ChangeLogs if they don't have one yet
        https://bugs.webkit.org/show_bug.cgi?id=39550

        This can cause an extra request to bugs.webkit.org durig upload, but it
        shouldn't be too bad.  Also, this won't work if you remove the
        boilerplate created by prepare-ChangeLog.

        * Scripts/webkitpy/common/checkout/changelog.py:
        * Scripts/webkitpy/common/checkout/changelog_unittest.py:
        * Scripts/webkitpy/common/net/bugzilla.py:
        * Scripts/webkitpy/tool/steps/abstractstep.py:
        * Scripts/webkitpy/tool/steps/preparechangelog.py:
        * Scripts/webkitpy/tool/steps/preparechangelog_unittest.py: Added.

2010-06-08  Robert Hogan  <robert@webkit.org>

        Reviewed by Eric Seidel.

        [Qt] Add support for callShouldCloseOnWebView() to DRT
        https://bugs.webkit.org/show_bug.cgi?id=40330

        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::callShouldCloseOnWebView):
        * DumpRenderTree/qt/LayoutTestControllerQt.h:
        (LayoutTestController::setCallCloseOnWebViews):

2010-06-12  Eric Seidel  <eric@webkit.org>

        Reviewed by Daniel Bates.

        do-webcore-rename should have a --verbose option
        https://bugs.webkit.org/show_bug.cgi?id=40497

        * Scripts/do-webcore-rename:
         - Unified how we handle skipping files/directories
           this will allow us to "black list" certain files and
           directories when performing renames.
         - Made do-webcore-rename log what it's skipping when passed --verbose.

2010-06-12  Darin Adler  <darin@apple.com>

        * Scripts/run-bindings-tests: Fixed a typo in a message.

2010-06-12  Kent Tamura  <tkent@chromium.org>

        Reviewed by Dimitri Glazkov.

        [Chromium] new-run-webkit-tests --use-drt should work with Chromium checkout
        https://bugs.webkit.org/show_bug.cgi?id=40402

        _build_path() of each Chromium port check existence of build path
        of Chromium checkout first, then check existence of build path of
        WebKit-only checkout.

        * Scripts/webkitpy/layout_tests/port/chromium_linux.py:
        * Scripts/webkitpy/layout_tests/port/chromium_mac.py:
        * Scripts/webkitpy/layout_tests/port/chromium_win.py:

2010-06-12  Robert Hogan  <robert@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Back-forward list dumping is incorrect

        https://bugs.webkit.org/show_bug.cgi?id=36392

        Support dumping child history items in DRT.

        Unskip:

        fast/loader/frame-src-change-added-to-history.html
        fast/loader/frame-src-change-not-added-to-history.html
        fast/loader/frame-location-change-not-added-to-history.html

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::dumpHistoryItem):

2010-06-10  Ojan Vafai  <ojan@chromium.org>

        Reviewed by Eric Seidel.

        upload all patches that lack in-rietveld to rietveld
        https://bugs.webkit.org/show_bug.cgi?id=40444

        If it's a patch, then we'll try to upload it as long as it
        doesn't have in-rietveld set. No longer set in-rietveld? since
        it's not needed.

        * Scripts/webkitpy/common/net/bugzilla.py:

2010-06-10  Ojan Vafai  <ojan@chromium.org>

        Reviewed by Darin Fisher.

        Fix rietveld upload when message length > 100 characters
        https://bugs.webkit.org/show_bug.cgi?id=40457

        * Scripts/webkitpy/common/net/rietveld.py:

2010-06-11  Yael Aharon  <yael.aharon@nokia.com>

        Reviewed by Laszlo Gombos.

        [Qt] There should be a way to enable popups in QtTestBrowser
        https://bugs.webkit.org/show_bug.cgi?id=40427

        * QtTestBrowser/main.cpp:
        (LauncherWindow::toggleJavascriptCanOpenWindows):
        (LauncherWindow::createChrome):

2010-06-10  Adam Barth  <abarth@webkit.org>

        Reviewed by Daniel Bates.

        Make SheriffBot more chatty
        https://bugs.webkit.org/show_bug.cgi?id=40463

        People seem to like to talk to SheriffBot, so let's make him chat back.

        * Scripts/webkitpy/thirdparty/__init__.py:
        * Scripts/webkitpy/tool/bot/irc_command.py:
        * Scripts/webkitpy/tool/bot/irc_command_unittest.py: Added.
        * Scripts/webkitpy/tool/bot/sheriffircbot.py:
        * Scripts/webkitpy/tool/bot/sheriffircbot_unittest.py:

2010-06-10  Brian Weinstein  <bweinstein@apple.com>

        Reviewed by Darin Adler.

        Fix the Windows buildbot when WebKitAuxiliaryLibs.zip cannot be found on our server.
        
        Robustify update-webkit-auxiliary-libs to be able to handle the case when WebKitAuxiliaryLibs.zip doesn't exist,
        and allow the script to fall back to an existing file, only failing if there is no fallback file. Also switch to checking
        WEXITSTATUS on $result instead of just comparing $result to 0.

        * Scripts/update-webkit-auxiliary-libs:

2010-06-10  Ojan Vafai  <ojan@chromium.org>

        Reviewed by Alexey Proskuryakov.

        don't use Exception.message as it's deprecated in python 2.6+
        https://bugs.webkit.org/show_bug.cgi?id=40449

        * Scripts/webkitpy/tool/commands/queues.py:

2010-06-10  Ojan Vafai  <ojan@chromium.org>

        Reviewed by Adam Barth.

        fix handle_script_error in rietveld upload queue and add testing for handle_script_error
        https://bugs.webkit.org/show_bug.cgi?id=40436

        * Scripts/webkitpy/common/system/outputcapture.py:
        * Scripts/webkitpy/tool/commands/earlywarningsystem_unittest.py:
        * Scripts/webkitpy/tool/commands/queues.py:
        * Scripts/webkitpy/tool/commands/queues_unittest.py:
        * Scripts/webkitpy/tool/commands/queuestest.py:
        * Scripts/webkitpy/tool/mocktool.py:

2010-06-10  Jarkko Sakkinen  <jarkko.j.sakkinen@gmail.com>

        Reviewed by Simon Hausmann.

        [Qt] *All* WebGL layout tests fail!
        https://bugs.webkit.org/show_bug.cgi?id=40296

        Added test for WebKitWebGLEnabled to
        LayoutTestController::overridePreference().

        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::overridePreference):

2010-06-10  Diego Gonzalez  <diegohcg@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] DRT EventSender support to graphics mouse events activation
        https://bugs.webkit.org/show_bug.cgi?id=40017

        * DumpRenderTree/qt/EventSenderQt.cpp:
        (EventSender::mouseDown):
        (EventSender::mouseUp):
        (EventSender::mouseMoveTo):
        (EventSender::keyDown):
        (EventSender::contextClick):
        (EventSender::sendTouchEvent):
        (EventSender::sendOrQueueEvent):
        (EventSender::eventFilter):
        (EventSender::createGraphicsSceneMouseEvent):
        (EventSender::sendEvent):
        * DumpRenderTree/qt/EventSenderQt.h:
        (EventSender::isGraphicsBased):

2010-06-09  Adam Barth  <abarth@webkit.org>

        Reviewed by Ojan Vafai.

        webkit-patch upload fails for security bugs because there's no rietveld flag
        https://bugs.webkit.org/show_bug.cgi?id=40309

        There's probably a more elegant way of seeing whether the form control
        exists, but this seems to work.

        * Scripts/webkitpy/common/net/bugzilla.py:

2010-06-09  Ojan Vafai  <ojan@chromium.org>

        Reviewed by Adam Barth.

        make rietveld upload faster and avoid posting to bug on errors
        https://bugs.webkit.org/show_bug.cgi?id=40389

        Only grab the first item of the upload queue instead of trying
        to compute the whole list upfront (which is O(n) bugzilla lookups!).

        Also, don't post comments to the bug when uploading fails.

        * Scripts/webkitpy/common/net/bugzilla.py:
        * Scripts/webkitpy/tool/commands/queues.py:
        * Scripts/webkitpy/tool/commands/queues_unittest.py:
        * Scripts/webkitpy/tool/commands/stepsequence.py:
        * Scripts/webkitpy/tool/mocktool.py:

2010-06-09  Ojan Vafai  <ojan@chromium.org>

        Reviewed by Adam Barth.

        Rietveld upload queue fails when setting in-rietveld flag
        https://bugs.webkit.org/show_bug.cgi?id=40371

        Make the comment arguments to set_flag_on_attachment optional
        and add it to the MockBugzilla.

        * Scripts/webkitpy/common/net/bugzilla.py:
        * Scripts/webkitpy/tool/bot/queueengine.py:
        * Scripts/webkitpy/tool/commands/download_unittest.py:
        * Scripts/webkitpy/tool/commands/queues.py:
        * Scripts/webkitpy/tool/commands/queues_unittest.py:
        * Scripts/webkitpy/tool/mocktool.py:

2010-06-09  Kenneth Russell  <kbr@google.com>

        Reviewed by Dimitri Glazkov.

        Rename FloatArray to Float32Array
        https://bugs.webkit.org/show_bug.cgi?id=40323

        Used do-webcore-rename to perform renaming. Manually undid
        incorrect changes to WebCore/bridge/jni/jsc/JNIBridgeJSC.cpp,
        WebCore/manual-tests/resources/ArrayParameterTestApplet.java and
        ArrayParameterTestApplet.class. Updated LayoutTests. Built and ran
        all layout tests on Safari; built Chromium and ran selected WebGL
        tests.

        * Scripts/do-webcore-rename:

2010-06-08  Tony Chang  <tony@chromium.org>

        Reviewed by David Levin.

        [chromium] compile linux chromium in WebKit/out instead of WebKit/WebKit/chromium/out
        https://bugs.webkit.org/show_bug.cgi?id=40285

        * Scripts/webkitdirs.pm:
        * Scripts/webkitpy/layout_tests/port/chromium_linux.py:

2010-06-03  Roland Steiner  <rolandsteiner@chromium.org>

        Reviewed by Tamura Kent.

        Bug 40052 - [DRT/Chromium] Upstream test_shell_webthemeengine as WebThemeEngineDRT
        https://bugs.webkit.org/show_bug.cgi?id=40052
        
        Add WebThemeEngineDRT and WebThemeControlDRT ported from Chromium rev. 48907

        * DumpRenderTree/DumpRenderTree.gypi:
        * DumpRenderTree/chromium/TestShellWin.cpp:
        (platformInit):
        * DumpRenderTree/chromium/WebThemeControlDRT.cpp: Added.
        (WebKit::):
        (WebKit::WebThemeControlDRT::WebThemeControlDRT):
        (WebKit::WebThemeControlDRT::~WebThemeControlDRT):
        (WebKit::WebThemeControlDRT::box):
        (WebKit::WebThemeControlDRT::line):
        (WebKit::WebThemeControlDRT::triangle):
        (WebKit::WebThemeControlDRT::roundRect):
        (WebKit::WebThemeControlDRT::oval):
        (WebKit::WebThemeControlDRT::circle):
        (WebKit::WebThemeControlDRT::nestedBoxes):
        (WebKit::WebThemeControlDRT::markState):
        (WebKit::WebThemeControlDRT::draw):
        (WebKit::WebThemeControlDRT::drawTextField):
        (WebKit::WebThemeControlDRT::drawProgressBar):
        * DumpRenderTree/chromium/WebThemeControlDRT.h: Added.
        (WebKit::WebThemeControlDRT::):
        * DumpRenderTree/chromium/WebThemeEngineDRT.cpp: Added.
        (WebKit::):
        (WebKit::WebThemeEngineDRT::paintButton):
        (WebKit::WebThemeEngineDRT::paintMenuList):
        (WebKit::WebThemeEngineDRT::paintScrollbarArrow):
        (WebKit::WebThemeEngineDRT::paintScrollbarThumb):
        (WebKit::WebThemeEngineDRT::paintScrollbarTrack):
        (WebKit::WebThemeEngineDRT::paintTextField):
        (WebKit::WebThemeEngineDRT::paintTrackbar):
        (WebKit::WebThemeEngineDRT::paintProgressBar):
        * DumpRenderTree/chromium/WebThemeEngineDRT.h: Added.
        (WebKit::WebThemeEngineDRT::WebThemeEngineDRT):

2010-06-08  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r60878.
        http://trac.webkit.org/changeset/60878
        https://bugs.webkit.org/show_bug.cgi?id=40349

        broke linux build (Requested by tony^work on #webkit).

        * Scripts/webkitdirs.pm:
        * Scripts/webkitpy/layout_tests/port/chromium_linux.py:

2010-06-08  Tony Chang  <tony@chromium.org>

        Reviewed by David Levin.

        [chromium] compile linux chromium in WebKit/out instead of WebKit/WebKit/chromium/out
        https://bugs.webkit.org/show_bug.cgi?id=40285

        * Scripts/webkitdirs.pm:
        * Scripts/webkitpy/layout_tests/port/chromium_linux.py:

2010-06-08  Kenneth Russell  <kbr@google.com>

        Unreviewed, build fix.

        Fix build breakage from 38145
        https://bugs.webkit.org/show_bug.cgi?id=40346

        The fix for bug 38145 broke the Chromium Win build because
        Microsoft's cmath doesn't define log2. Suggested fix by zmo is to
        change log2(x) to log(x) / log(2). Built and ran WebGL layout
        tests in Safari on Mac OS X. Changed download mirrors for
        python-irclib to working ones.

        * Scripts/webkitpy/thirdparty/__init__.py:

2010-06-08  Fumitoshi Ukai  <ukai@chromium.org>

        Reviewed by Eric Seidel.

        old-run-webkit-tests should use ensure-valid-python to check if it can run the websockets tests
        https://bugs.webkit.org/show_bug.cgi?id=39058

        * Scripts/old-run-webkit-tests:
         use sourceDir() to find ensure-valid-python in checkPythonVersion()

2010-06-08  Andras Becsi  <abecsi@webkit.org>

        Unreviewed buildfix after r60479.

        [GTK] Move the declaration of getRootCoords higher up to fix the build on GTK
        versions other than 2.17.3.

        * DumpRenderTree/gtk/EventSender.cpp:
        (getRootCoords):

2010-06-07  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Oliver Hunt.

        [GTK] Mouse movement should not trigger a replay of saved events in the event sender
        https://bugs.webkit.org/show_bug.cgi?id=40267

        When a mouse button is down, automatically queue mouse motion events and
        do not play them back until the mouse button is released. This matches the
        behavior of other ports' EventSenders.

        * DumpRenderTree/gtk/EventSender.cpp:
        (mouseMoveToCallback): Don't automatically replaySavedEvents for mouse motion.
        (sendOrQueueEvent): Add a shouldReplaySavedEvents argument defaulting to true.

2010-06-07  Nikolas Zimmermann  <nzimmermann@rim.com>

        Reviewed by Sam Weinig.

        Add CPP bindings generator
        https://bugs.webkit.org/show_bug.cgi?id=38279

        Integrate CPP bindings in run-bindings-tests.

        * Scripts/run-bindings-tests:

2010-06-04  Tony Gentilcore  <tonyg@chromium.org>

        Reviewed by Ojan Vafai.

        Rename 'svn_merge_base' -> 'remote_merge_base'. This was left out of r60633.
        https://bugs.webkit.org/show_bug.cgi?id=40183

        * Scripts/webkitpy/tool/steps/preparechangelog.py:

2010-06-04  Martin Robinson  <mrobinson@igalia.com>

        Unreviewed.

        Add my new email and IRC nick to committers.py.

        * Scripts/webkitpy/common/config/committers.py:

2010-06-04  Kinuko Yasuda  <kinuko@chromium.org>

        Unreviewed.

        Revert changes in json_results_generator.py's _get_svn_revision.

        * Scripts/webkitpy/layout_tests/layout_package/json_results_generator.py:

2010-06-04  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Xan Lopez.

        [GTK] GtkLauncher should support relative file paths
        https://bugs.webkit.org/show_bug.cgi?id=39944

        Allow GtkLauncher to handle relative file paths passed via command-line arguments.

        * GtkLauncher/main.c:
        (filename_to_url): Added.
        (main): Try to resolve arguments as relative file URLs first.

2010-06-04  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Xan Lopez.

        [GTK] EventSender should call gtk_main_do_event instead of invoking signal handlers directly
        https://bugs.webkit.org/show_bug.cgi?id=40182

        Instead of invoking signal handlers directly via g_signal_emit_by_name, call
        gtk_main_do_event. This will allow us to call gtk_get_current_event() in WebKit
        without breaking DRT.

        * DumpRenderTree/gtk/EventSender.cpp:
        (dispatchEvent): Use gtk_main_do_event instead of invoking signal handlers directly.
        (keyDownCallback): Use dispatchEvent here which now uses gtk_main_do_event.

2010-06-04  Anders Carlsson  <andersca@apple.com>

        Reviewed by David Hyatt.

        Make the editing/spelling/context-menu-suggestions.html test more robust
        https://bugs.webkit.org/show_bug.cgi?id=40178

        Change the contextClick method to return an array of strings describing the context menu items.

        * DumpRenderTree/mac/EventSendingController.mm:
        (+[EventSendingController isSelectorExcludedFromWebScript:]):
        (+[EventSendingController webScriptNameForSelector:]):
        (-[EventSendingController contextClick]):

2010-06-03  Kinuko Yasuda  <kinuko@chromium.org>

        Reviewed by Shinichiro Hamaji.

        Clean up chromium-specific code from json_results_generator.py.
        https://bugs.webkit.org/show_bug.cgi?id=39665

        * Scripts/webkitpy/layout_tests/layout_package/json_layout_results_generator.py:
        * Scripts/webkitpy/layout_tests/layout_package/json_results_generator.py:
        * Scripts/webkitpy/layout_tests/port/base.py:
        * Scripts/webkitpy/layout_tests/port/chromium.py:

2010-06-04  Tony Gentilcore  <tonyg@chromium.org>

        Reviewed by Adam Barth.

        Utilize new takeFirst() method where appropriate.
        https://bugs.webkit.org/show_bug.cgi?id=40089

        * DumpRenderTree/chromium/EventSender.cpp:
        (EventSender::replaySavedEvents):
        * DumpRenderTree/chromium/LayoutTestController.cpp:
        (LayoutTestController::WorkQueue::processWork):
        (LayoutTestController::WorkQueue::reset):

2010-06-04  Yael Aharon  <yael.aharon@nokia.com>

        Reviewed by Simon Hausmann.

        [Qt] QtTestLauncher should allow notifications by default.
        https://bugs.webkit.org/show_bug.cgi?id=40078

        * QtTestBrowser/main.cpp:
        (NotificationsPermissionController::NotificationsPermissionController):
        (NotificationsPermissionController::checkPermission):
        (NotificationsPermissionController::requestPermission):
        (LauncherWindow::LauncherWindow):

2010-06-04  Tony Gentilcore  <tonyg@chromium.org>

        Reviewed by Adam Barth.

        Detect whether the user's environment can open a browser.
        https://bugs.webkit.org/show_bug.cgi?id=40136

        Some environments like cygwin silently fail webbrowser.open() causing
        webkit-patch upload not to display any diff. This detects environments
        where webbrowser.open() would fail by testing if webbrowser.get()
        raises an exception.

        * Scripts/webkitpy/common/system/user.py:
        * Scripts/webkitpy/tool/mocktool.py:
        * Scripts/webkitpy/tool/steps/confirmdiff.py:

2010-06-03  Tony Gentilcore  <tonyg@chromium.org>

        Reviewed by David Levin.

        Add dependencies required to link with VS Express 2005.
        https://bugs.webkit.org/show_bug.cgi?id=40038

        Visual Studio implicitly links against these libs.
        VC++ Express does not.

        * WebKitAPITest/WebKitAPITestCommon.vsprops:
        * WinLauncher/WinLauncher.vcproj:

2010-06-03  Fumitoshi Ukai  <ukai@chromium.org>

        Reviewed by David Levin.

        bad codecs.open in webkitpy/layout_tests/ports/websocket_server.py
        https://bugs.webkit.org/show_bug.cgi?id=40105

        * Scripts/webkitpy/layout_tests/port/websocket_server.py:
        - kill pywebsocket process when url is not alive and the process is not
          terminated, not to leave pywebsocket server running.
        - fix codecs.open parameters.

2010-06-03  Fumitoshi Ukai  <ukai@chromium.org>

        Reviewed by Alexey Proskuryakov.

        old-run-webkit-tests should use ensure-valid-python to check if it can run the websockets tests
        https://bugs.webkit.org/show_bug.cgi?id=39058

        * Scripts/ensure-valid-python:
          - Perl 5.8 doesn't have File::Temp->newdir().  Use File::Temp->tempdir() instead.
          - Add --check-only and --help option.
          - --check-only option only checks python version and don't try to install Python 2.5.
          - Set executable bit.
        * Scripts/old-run-webkit-tests:
          - Check if it can run the websocket tests by calling ensure-valid-python --check-only.

2010-05-14  Ojan Vafai  <ojan@chromium.org>

        Reviewed by Adam Barth.

        add a RietveldUploadQueue to upload in-rietveld? patches to rietveld
        https://bugs.webkit.org/show_bug.cgi?id=38918

        Patches with in-rietveld? get uploaded to rietveld and get marked
        in-rietveld+. If the upload fails, they are marked in-rietveld-
        and an error is logged to the bug, like the commit-queue.

        Also, get rid of --fancy-review and the ability to upload to rietveld
        using webkit-patch upload/post.

        * Scripts/webkitpy/common/net/bugzilla.py:
        * Scripts/webkitpy/common/net/bugzilla_unittest.py:
        * Scripts/webkitpy/tool/commands/download.py:
        * Scripts/webkitpy/tool/commands/download_unittest.py:
        * Scripts/webkitpy/tool/commands/queues.py:
        * Scripts/webkitpy/tool/commands/queues_unittest.py:
        * Scripts/webkitpy/tool/commands/upload.py:
        * Scripts/webkitpy/tool/commands/upload_unittest.py:
        * Scripts/webkitpy/tool/mocktool.py:
        * Scripts/webkitpy/tool/steps/options.py:
        * Scripts/webkitpy/tool/steps/postcodereview.py:

2010-05-24  Ojan Vafai  <ojan@chromium.org>

        Reviewed by Chris Jerdonek.

        many webkit-patch commands fail in a non-svn tracking git checkout
        https://bugs.webkit.org/show_bug.cgi?id=38156

        If the svn-tracking-branch (trunk) doesn't exist, fallback to the git remote-tracking-branch (master).
        If neither exists, then error out. This makes webkit-patch work
        for anyone that follows the intructions at http://trac.webkit.org/wiki/UsingGitWithWebKit
        to checkout webkit. The fallback to master is for people who don't
        do the steps on that page for tracking svn.

        * Scripts/webkitpy/common/checkout/scm.py:
        * Scripts/webkitpy/common/checkout/scm_unittest.py:

2010-06-03  Mike Fenton  <mifenton@rim.com>

        Unreviewed.

        Reverse e-mail for myself in committers.py to correspond with bugzilla account.

        * Scripts/webkitpy/common/config/committers.py:

2010-06-03  Pavel Feldman  <pfeldman@chromium.org>

        Reviewed by Yury Semikhatsky.

        Web Inspector: a number of fixes that make InspectorController
        happy with null redirects.

        https://bugs.webkit.org/show_bug.cgi?id=40109

        * DumpRenderTree/gtk/DumpRenderTree.cpp:
        (runTest):
        * DumpRenderTree/mac/DumpRenderTree.mm:
        (runTest):
        * DumpRenderTree/win/DumpRenderTree.cpp:
        (runTest):

2010-06-02  Tasuku Suzuki  <tasuku.suzuki@nokia.com>

        Reviewed by Shinichiro Hamaji.

        [Qt] Fix compilation with QT_NO_PROPERTIES
        https://bugs.webkit.org/show_bug.cgi?id=38324

        * QtTestBrowser/main.cpp:
        (LauncherWindow::init):

2010-06-02  Diego Gonzalez  <diegohcg@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Make possible run DRT with QGraphicsWebView
        https://bugs.webkit.org/show_bug.cgi?id=40016

        Make possible to use a environment variable for switching backend.
        Usage: QT_DRT_WEBVIEW_MODE=graphics WebKitTools/Scripts/run-webkit-tests --qt

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::WebViewGraphicsBased::WebViewGraphicsBased):
        (WebCore::DumpRenderTree::DumpRenderTree):
        * DumpRenderTree/qt/DumpRenderTreeQt.h:
        (WebCore::DumpRenderTree::setGraphicsBased):
        (WebCore::DumpRenderTree::isGraphicsBased):
        (WebCore::WebViewGraphicsBased::graphicsView):
        (WebCore::WebViewGraphicsBased::setPage):
        * Scripts/old-run-webkit-tests:

2010-06-02  Csaba Osztrogonác  <ossy@webkit.org>

        Reviewed by Eric Seidel.

        Slave lost shouldn't be recognized as build failed.
        https://bugs.webkit.org/show_bug.cgi?id=39282

        * Scripts/webkitpy/common/net/buildbot.py: Treat slave lost as green.
        * Scripts/webkitpy/common/net/buildbot_unittest.py: Add unit test for slave lost.

2010-06-01  Yael Aharon  <yael.aharon@nokia.com>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Fix the lifecycle of notification objects
        https://bugs.webkit.org/show_bug.cgi?id=40003

        Remove the dependency of notifications on QWebPage.

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::requestPermissionCallback):
        (WebCore::WebPage::WebPage):
        (WebCore::DumpRenderTree::requestPermission):
        * DumpRenderTree/qt/DumpRenderTreeQt.h:

2010-06-02  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r60559.
        http://trac.webkit.org/changeset/60559
        https://bugs.webkit.org/show_bug.cgi?id=40055

        It broke python unit test (Requested by Ossy on #webkit).

        * Scripts/webkitpy/common/net/buildbot.py:

2010-06-02  Csaba Osztrogonác  <ossy@webkit.org>

        Reviewed by Eric Seidel.

        Slave lost shouldn't be recognized as build failed.
        https://bugs.webkit.org/show_bug.cgi?id=39282

        * Scripts/webkitpy/common/net/buildbot.py:

2010-06-02  Tony Gentilcore  <tonyg@chromium.org>

        Reviewed by Eric Seidel.

        Fix crash caused when assigned_to is disabled
        https://bugs.webkit.org/show_bug.cgi?id=40039

        * Scripts/webkitpy/common/net/bugzilla.py:

2010-06-02  Sterling Swigart  <sswigart@google.com>

        Reviewed by David Levin.

        Image Resizer Patch 0: Added compilation argument to conditionally compile pending patches.
        https://bugs.webkit.org/show_bug.cgi?id=39906

        * Scripts/build-webkit:

2010-06-01  Raine Makelainen  <raine.makelainen@nokia.com>

        Reviewed by Simon Hausmann.

        Fixed tests to use QWebSettings::JavascriptCanAccessClipboard instead of QWebSettings::JavaScriptCanAccessClipboard.

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::WebPage::WebPage):
        (WebCore::WebPage::resetSettings):
        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::setJavaScriptCanAccessClipboard):

2010-06-01  Alexey Proskuryakov  <ap@apple.com>

        Reviewed by Mark Rowe.

        A nicer Tiger build fix.

        * DumpRenderTree/DumpRenderTree.xcodeproj/project.pbxproj:
        * DumpRenderTree/mac/Configurations/Base.xcconfig:
        Enable GCC_OBJC_CALL_CXX_CDTORS via .xcconfig.

2010-06-01  Alexey Proskuryakov  <ap@apple.com>

        A real Tiger build fix.

        * DumpRenderTree/DumpRenderTree.xcodeproj/project.pbxproj: Enable GCC_OBJC_CALL_CXX_CDTORS
        for all configurations, not just debug.

2010-06-01  Alexey Proskuryakov  <ap@apple.com>

        Tiger build fix.

        * DumpRenderTree/DumpRenderTree.xcodeproj/project.pbxproj: Enable GCC_OBJC_CALL_CXX_CDTORS.

2010-06-01  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Xan Lopez.

        [GTK] Get more mouse tests passing
        https://bugs.webkit.org/show_bug.cgi?id=39040

        Reproduce the logic from the Windows EventSender for mapping
        button numbers to GDK button numbers. Move this logic to the
        prepareMouseButtonEvent helper.

        * DumpRenderTree/gtk/EventSender.cpp:
        (prepareMouseButtonEvent): Reproduce Windows logic.
        (contextClickCallback): Move mapping logic to prepareMouseButtonEvent.
        (mouseDownCallback): Ditto.
        (mouseUpCallback): Ditto.

2010-06-01  Alexey Proskuryakov  <ap@apple.com>

        Reviewed by Sam Weinig.

        https://bugs.webkit.org/show_bug.cgi?id=39434
        REGRESSION (r59811): Geolocation callbacks cannot be created

        * DumpRenderTree/DumpRenderTree.xcodeproj/project.pbxproj: Added MockGeolocationProvider.

        * DumpRenderTree/mac/DumpRenderTree.mm:
        (createWebViewAndOffscreenWindow): Tell the view to use MockGeolocationProvider. 
        (resetWebViewToConsistentStateBeforeTesting): Make sure that mock notifications don't leak
        into subsequent tests.

        * DumpRenderTree/mac/LayoutTestControllerMac.mm:
        (LayoutTestController::setMockGeolocationPosition): Changed to use MockGeolocationProvider.
        (LayoutTestController::setMockGeolocationError): Ditto.

        * DumpRenderTree/mac/MockGeolocationProvider.h: Added.
        * DumpRenderTree/mac/MockGeolocationProvider.mm: Added.
        (+[MockGeolocationProvider shared]):
        (-[MockGeolocationProvider dealloc]):
        (-[MockGeolocationProvider setPosition:]):
        (-[MockGeolocationProvider setError:]):
        (-[MockGeolocationProvider registerWebView:]):
        (-[MockGeolocationProvider unregisterWebView:]):
        (-[MockGeolocationProvider lastPosition]):
        (-[MockGeolocationProvider stopTimer]):
        (-[MockGeolocationProvider timerFired]):

        * DumpRenderTree/mac/UIDelegate.mm:
        (-[UIDelegate webView:decidePolicyForGeolocationRequestFromOrigin:frame:listener:]):
        This delegate method must send a response. I'm not sure what the two-stage check is supposed
        to achieve, it seems unnecessary.

2010-05-12  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Xan Lopez.

        [GTK] Double clicks cause three button press events
        https://bugs.webkit.org/show_bug.cgi?id=38853

        WebKit now filters the extra GDK_BUTTON_PRESS before GDK_2BUTTON_PRESS
        and GDK_3BUTTON_PRESS via gdk_event_peek(). Since EventSender bypasses
        the GDK event queue entirely, we simply do not send the extra event.

        * DumpRenderTree/gtk/EventSender.cpp:
        (mouseDownCallback): Do not send extra event. Send GDK_3BUTTON_PRESS appropriately.
        (dispatchEvent): Properly handle GDK_3BUTTON_PRESS.

2010-06-01  Martin Robinson  <mrobinson@igalia.com>

        Not reviewed. Build fix.

        Fix GTK+ build caused by a bad merge.

        * DumpRenderTree/gtk/EventSender.cpp: 
        (prepareMouseButtonEvent): Use the GdkEvent union as a pointer here.

2010-06-01  Martin Robinson  <mrobinson@webkit.org>

        Reviewed by Xan Lopez.

        [GTK] Double clicks cause three button press events
        https://bugs.webkit.org/show_bug.cgi?id=38853

        Small EventSender cleanups. Consolidate some common code. Style fixes.

        * DumpRenderTree/gtk/EventSender.cpp:
        (prepareMouseButtonEvent): Added.
        (contextClickCallback): Use prepareMouseButtonEvent.
        (mouseDownCallback): Use prepareMouseButtonEvent.
        (mouseUpCallback): Use prepareMouseButtonEvent.
        (mouseMoveToCallback): Small style fix.

2010-06-01  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Xan Lopez.

        [GTK] Double clicks cause three button press events
        https://bugs.webkit.org/show_bug.cgi?id=38853

        Add rudimentary leapForward support to the GTK+ DRT. leapForward allows a test
        to pause for a specified amount of time. It is used in the processing of drag-
        -and-drop data as well as to separate distinct mouse double-clicks in some tests.
        This patch enables tests that rely on the latter behavior to pass.

        * DumpRenderTree/gtk/DumpRenderTree.cpp:
        (webViewWindowObjectCleared): Only initialize the EventSender when loading the top frame.
        * DumpRenderTree/gtk/EventSender.cpp:
        (leapForwardCallback): Add support for adjusting the time offset on leapForward().
        (contextClickCallback): Use sendOrQueueEvent.
        (updateClickCount): Take the time offset into account when counting clicks.
        (mouseDownCallback): Use sendOrQueueEvent.
        (getStateFlags): Change down/currentEventButton into buttonCurrentlyDown/lastClickButton.
        (mouseUpCallback): Use sendOrQueueEvent.
        (mouseMoveToCallback): Ditto.
        (mouseWheelToCallback): Ditto.
        (sendOrQueueEvent): Added.
        (dispatchEvent): Added.
        (replaySavedEvents): Pause when an event has a delay and defer to dispatchEvent.
        (makeEventSender): Only initialize the EventSender when loading the top frame.
        * DumpRenderTree/gtk/EventSender.h: Ditto.

2010-06-01  Martin Robinson  <mrobinson@igalia.com>

        Reviewed by Xan Lopez.

        [GTK] css1/color_and_background/background_attachment.html fails on the 32-bit debug bot
        https://bugs.webkit.org/show_bug.cgi?id=39101

        Work around timing issues for render tree dumps by pumping the
        main loop before doing the dump. Resize events are asynchronous
        in GTK+, so sometimes resize requests are still pending when DRT
        dumps the tree.

        * DumpRenderTree/gtk/DumpRenderTree.cpp:
        (dump): Pump the main loop before dumping the render tree.

2010-05-31  Kent Tamura  <tkent@chromium.org>

        Reviewed by Dimitri Glazkov.

        [DRT/Chromium] Fix crash of a test after another test with multiple windows
        https://bugs.webkit.org/show_bug.cgi?id=39942

        If a test opens multiple windows, focuses on non-main window, and
        the focused window is closed, TestShell::m_focusedWidget points a
        deleted object.

        * DumpRenderTree/chromium/TestShell.cpp:
        (TestShell::closeWindow): Clear m_focusedWidget.

2010-05-30  Kent Tamura  <tkent@chromium.org>

        Reviewed by Dimitri Glazkov.

        new-run-webkit-tests: Support DRT on Chromium-win
        https://bugs.webkit.org/show_bug.cgi?id=39810

        Add --test-shell flag to DRT/Chromium, and it changes DRT so that
        it behaves like test_shell about command analysis, printing
        format, pixel dumping, and timeout handling.

        chromium.py and chromium_win.py supports the --test-shell flag and
        DRT/Chromium-win binary names.
        
        * DumpRenderTree/DumpRenderTree.gypi: Add new files.
        * DumpRenderTree/chromium/DumpRenderTree.cpp:
        (runTest): Support for test_shell-style command.
        (main): Introduce --test-shell.
        * DumpRenderTree/chromium/TestEventPrinter.cpp: Added.
        * DumpRenderTree/chromium/TestEventPrinter.h: Added.
          TestEventPrinter class manages stdio output and image output.
          TestEventPrinter.cpp has two implementations; DRTPrinter and
          TestShellPrinter.
        * DumpRenderTree/chromium/TestShell.cpp:
          Some changes for TestEventPrinter.
        (TestShell::TestShell):
        (TestShell::runFileTest):
        (TestShell::testTimedOut):
        (TestShell::dump):
        (TestShell::dumpImage):
        * DumpRenderTree/chromium/TestShell.h:
        (TestShell::printer):
        (TestShell::layoutTestTimeout):
        (TestShell::layoutTestTimeoutForWatchDog):
        (TestShell::setLayoutTestTimeout):
        * DumpRenderTree/chromium/TestShellWin.cpp:
        (watchDogThread): Use TestShell::layoutTestTimeoutForWatchDog().
        * Scripts/webkitpy/layout_tests/port/chromium.py:
        * Scripts/webkitpy/layout_tests/port/chromium_win.py:

2010-05-30  Robert Hogan  <robert@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Enhance Qt DRT implementation to support platform scroll wheel events.

        https://bugs.webkit.org/show_bug.cgi?id=36004

        * DumpRenderTree/qt/EventSenderQt.cpp:
        (EventSender::EventSender): QApplication::setWheelScrollLines(2) in order to match
                                    Scrollbar::pixelsPerLineStep() for DRT testing.
        (EventSender::mouseScrollBy): Added
        (EventSender::continuousMouseScrollBy): Added
        * DumpRenderTree/qt/EventSenderQt.h:

2010-05-28  Adam Barth  <abarth@webkit.org>

        Reviewed by David Levin.

        webkit-patch should support CHANGE_LOG_EDIT_APPLICATION
        https://bugs.webkit.org/show_bug.cgi?id=39546

        One sublty is that we want to wait for the user to finish editing the
        ChangeLog before moving on to the next step.  That means we want to pass
        -W to open.  However, if the user is using Xcode to edit the ChangeLog,
        we don't want them to have to exit the Xcode application.  For this reason,
        we create a new instance of the application with -n.
        
        Overall, xed seems like a better solution, so we recommend that too.

        * Scripts/webkitpy/common/system/user.py:
        * Scripts/webkitpy/tool/mocktool.py:
        * Scripts/webkitpy/tool/steps/editchangelog.py:

2010-05-21  Dirk Pranke  <dpranke@chromium.org>

        Reviewed by Ojan Vafai.

        new-run-webkit-tests: fix handling of Ctrl-C to exit even if some
        threads are wedged. Also, the script will print the results of the
        tests completed when the interrupt occurs.

        https://bugs.webkit.org/show_bug.cgi?id=33238

        * Scripts/webkitpy/layout_tests/layout_package/dump_render_tree_thread.py:
        * Scripts/webkitpy/layout_tests/layout_package/printing.py:
        * Scripts/webkitpy/layout_tests/layout_package/printing_unittest.py:
        * Scripts/webkitpy/layout_tests/run_webkit_tests.py:

2010-05-28  Darin Adler  <darin@apple.com>

        Ignore more Python messiness.

        * Scripts/webkitpy/layout_tests/data/platform/test: Added property svn:ignore.
        * Scripts/webkitpy/layout_tests/layout_package: Added property svn:ignore.
        * Scripts/webkitpy/layout_tests/test_types: Added property svn:ignore.
        * Scripts/webkitpy/test: Added property svn:ignore.
        * Scripts/webkitpy/thirdparty/simplejson: Added property svn:ignore.

2010-05-28  Chris Fleizach  <cfleizach@apple.com>

        Reviewed by Beth Dakin.

        Adding myself as a reviewer.

        * Scripts/webkitpy/common/config/committers.py:

2010-05-28  Chris Fleizach  <cfleizach@apple.com>

        Build fix. No review.

        AX: need to catch NSAccessibilityExceptions in DRT
        https://bugs.webkit.org/show_bug.cgi?id=39881

        It looks like Tiger doesn't like seeing a NSMakeRange inside a @try.

        * DumpRenderTree/mac/AccessibilityUIElementMac.mm:
        (AccessibilityUIElement::rowIndexRange):
        (AccessibilityUIElement::columnIndexRange):
        (AccessibilityUIElement::selectedTextRange):

2010-05-28  Chris Fleizach  <cfleizach@apple.com>

        Reviewed by Darin Adler.

        AX: need to catch NSAccessibilityExceptions in DRT
        https://bugs.webkit.org/show_bug.cgi?id=39881

        Normally, accessibility exceptions are caught in the AX Runtime on the Mac, but 
        because DRT is its own AX client, no one is there to catch these otherwise innocuous exceptions.
  
        So DRT should wrap exception handlers around its AX related calls.

        * DumpRenderTree/mac/AccessibilityUIElementMac.mm:
        (attributesOfElement):
        (AccessibilityUIElement::getLinkedUIElements):
        (AccessibilityUIElement::getDocumentLinks):
        (AccessibilityUIElement::getChildren):
        (AccessibilityUIElement::getChildrenWithRange):
        (AccessibilityUIElement::ariaOwnsElementAtIndex):
        (AccessibilityUIElement::ariaFlowToElementAtIndex):
        (AccessibilityUIElement::disclosedRowAtIndex):
        (AccessibilityUIElement::selectedRowAtIndex):
        (AccessibilityUIElement::titleUIElement):
        (AccessibilityUIElement::parentElement):
        (AccessibilityUIElement::disclosedByRow):
        (AccessibilityUIElement::stringAttributeValue):
        (AccessibilityUIElement::boolAttributeValue):
        (AccessibilityUIElement::isAttributeSettable):
        (AccessibilityUIElement::isAttributeSupported):
        (AccessibilityUIElement::role):
        (AccessibilityUIElement::subrole):
        (AccessibilityUIElement::roleDescription):
        (AccessibilityUIElement::title):
        (AccessibilityUIElement::description):
        (AccessibilityUIElement::orientation):
        (AccessibilityUIElement::stringValue):
        (AccessibilityUIElement::language):
        (AccessibilityUIElement::helpText):
        (AccessibilityUIElement::x):
        (AccessibilityUIElement::y):
        (AccessibilityUIElement::width):
        (AccessibilityUIElement::height):
        (AccessibilityUIElement::clickPointX):
        (AccessibilityUIElement::clickPointY):
        (AccessibilityUIElement::intValue):
        (AccessibilityUIElement::minValue):
        (AccessibilityUIElement::maxValue):
        (AccessibilityUIElement::valueDescription):
        (AccessibilityUIElement::insertionPointLineNumber):
        (AccessibilityUIElement::isActionSupported):
        (AccessibilityUIElement::isEnabled):
        (AccessibilityUIElement::isRequired):
        (AccessibilityUIElement::isSelected):
        (AccessibilityUIElement::isExpanded):
        (AccessibilityUIElement::hierarchicalLevel):
        (AccessibilityUIElement::ariaIsGrabbed):
        (AccessibilityUIElement::ariaDropEffects):
        (AccessibilityUIElement::lineForIndex):
        (AccessibilityUIElement::boundsForRange):
        (AccessibilityUIElement::stringForRange):
        (AccessibilityUIElement::attributesOfColumnHeaders):
        (AccessibilityUIElement::attributesOfRowHeaders):
        (AccessibilityUIElement::attributesOfColumns):
        (AccessibilityUIElement::attributesOfRows):
        (AccessibilityUIElement::attributesOfVisibleCells):
        (AccessibilityUIElement::attributesOfHeader):
        (AccessibilityUIElement::rowCount):
        (AccessibilityUIElement::columnCount):
        (AccessibilityUIElement::indexInTable):
        (AccessibilityUIElement::rowIndexRange):
        (AccessibilityUIElement::columnIndexRange):
        (AccessibilityUIElement::cellForColumnAndRow):
        (AccessibilityUIElement::selectedTextRange):
        (AccessibilityUIElement::setSelectedTextRange):
        (AccessibilityUIElement::increment):
        (AccessibilityUIElement::decrement):
        (AccessibilityUIElement::showMenu):
        (AccessibilityUIElement::press):
        (AccessibilityUIElement::url):
        (AccessibilityUIElement::hasPopup):

2010-05-28  Yael Aharon  <yael.aharon@nokia.com>

        Reviewed by Laszlo Gombos.

        [Qt] Pass all web notification layout tests
        https://bugs.webkit.org/show_bug.cgi?id=39146

        Mimic Chromium's test_shell security model in Qt's DRT.
        It makes a list of origins which were granted permission to display
        notifications, and only those origins can display notifications.

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::checkPermissionCallback):
        (WebCore::requestPermissionCallback):
        (WebCore::WebPage::WebPage):
        (WebCore::DumpRenderTree::checkPermission):
        (WebCore::DumpRenderTree::requestPermission):
        * DumpRenderTree/qt/DumpRenderTreeQt.h:
        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::reset):
        (LayoutTestController::grantDesktopNotificationPermission):
        (LayoutTestController::checkDesktopNotificationPermission):
        * DumpRenderTree/qt/LayoutTestControllerQt.h:

2010-05-27  Philippe Normand  <pnormand@igalia.com>

        Reviewed by Shinichiro Hamaji.

        check-webkit-style complains about use of NULL in GTK function calls that require sentinels
        https://bugs.webkit.org/show_bug.cgi?id=39372

        Don't warn about NULL in g_*() calls. Zero can't be used instead
        for calls like g_build_filename and g_object_get/set.

        * Scripts/webkitpy/style/checkers/cpp.py:
        * Scripts/webkitpy/style/checkers/cpp_unittest.py:

2010-05-27  Luiz Agostini  <luiz.agostini@openbossa.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Platform plugin example
        https://bugs.webkit.org/show_bug.cgi?id=39489

        Exempting directory WebKit/qt/examples/ from style guide.

        * Scripts/webkitpy/style/checker.py:

2010-05-26  Philippe Normand  <pnormand@igalia.com>

        Reviewed by David Levin.

        [style] Allow usage of NULL in gst_*_many()
        https://bugs.webkit.org/show_bug.cgi?id=39740

        Don't warn if NULL is used by gst_*_many() functions. Zero can't
        be used for the reason explained in Bug 32858.

        * Scripts/webkitpy/style/checkers/cpp.py:
        * Scripts/webkitpy/style/checkers/cpp_unittest.py:

2010-05-27  Adam Barth  <abarth@webkit.org>

        Reviewed by Eric Seidel.

        Update script to run the normal version of the parser tests.

        * Scripts/test-html5-parser:

2010-05-27  Adam Barth  <abarth@webkit.org>

        Reviewed by Eric Seidel.

        Add HTML5 parser support to run-webkit-tests
        https://bugs.webkit.org/show_bug.cgi?id=39815

        * Scripts/old-run-webkit-tests:

2010-05-26  Adam Barth  <abarth@webkit.org>

        Reviewed by Eric Seidel.

        Make HTML5 lexer not ASSERT when resuming partial parses
        https://bugs.webkit.org/show_bug.cgi?id=39755

        Add webkit-resumer.html to the HTML5 parser test suite.

        * Scripts/test-html5-parser:

2010-05-24  Tony Chang  <tony@chromium.org>

        Reviewed by Kent Tamura.

        [chromium] setup fonts on chromium linux DRT
        https://bugs.webkit.org/show_bug.cgi?id=39644

        * DumpRenderTree/chromium/TestShellGtk.cpp:
        (setupFontconfig):
        (platformInit):
        * DumpRenderTree/chromium/WebViewHost.cpp:
        (WebViewHost::paintRect):  Fix a bug where in release builds, we didn't initialize m_canvas.
        * DumpRenderTree/chromium/fonts.conf: Added.

2010-05-24  Dirk Pranke  <dpranke@chromium.org>

        Reviewed by Dimitri Glazkov.

        Re-commit r58765 - it had been rolled out to see if it was causing
        a perf regression (in r59787 and r59789), but that does not seem to
        have been the case.

        https://bugs.webkit.org/show_bug.cgi?id=39605

        * DumpRenderTree/chromium/NotificationPresenter.cpp:
        (NotificationPresenter::show):

2010-05-25  Ojan Vafai  <ojan@chromium.org>

        Reviewed by Chris Jerdonek.

        remove suppression of rietveld logging
        https://bugs.webkit.org/show_bug.cgi?id=39693

        Now that we only upload to rietveld explicitly, e.g. on the bot
        or via webkit-patch post-attachment-to-rietveld, we should print
        all the rietveld logging. It was suppressed before to avoid making
        webkit-patch upload too noisy.

        * Scripts/webkitpy/common/net/rietveld.py:

2010-05-25  Antonio Gomes  <tonikitoo@webkit.org>

        Reviewed by Ojan Vafai.

        [Qt] Expose the editing behavior setting in DRT to test all editing code paths
        https://bugs.webkit.org/show_bug.cgi?id=39680

        Implement LayoutTestController::setEditingBehavior in Qt's DRT.

        * DumpRenderTree/qt/DumpRenderTreeQt.cpp:
        (WebCore::DumpRenderTree::resetToConsistentStateBeforeTesting):
        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::setEditingBehavior):

2010-05-25  Kevin Ollivier  <kevino@theolliviers.com>

        [wx] Build fix after API change and addition of WebCore/platform/text/transcoder dir. 

        * DumpRenderTree/wx/LayoutTestControllerWx.cpp:
        (LayoutTestController::setEditingBehavior):
        * wx/build/settings.py:

2010-05-24  Antonio Gomes  <tonikitoo@webkit.org>

        Reviewed by Eric Seidel and Kent Tamura (for the Chromium part).

        editingBehavior settings needs to be set back to a reasonable default between tests
        https://bugs.webkit.org/show_bug.cgi?id=39433

        Similarly to r59861, hard code the default setting during reset for Gtk and Chromium,
        so that the serialized version of the setting stays in sync with expectations.

        * DumpRenderTree/chromium/TestShell.cpp:
        (TestShell::resetWebSettings):
        * DumpRenderTree/gtk/DumpRenderTree.cpp:
        (resetDefaultsToConsistentValues):

2010-05-24  Eric Seidel  <eric@webkit.org>

        Reviewed by Adam Barth.

        webkit-patch land calls scm.changed_files 4 times!
        https://bugs.webkit.org/show_bug.cgi?id=39584

        * Scripts/webkitpy/tool/commands/download_unittest.py:
         - Assert that we don't call modified_changelogs too often.
        * Scripts/webkitpy/tool/steps/updatechangelogswithreviewer.py:
         - Use cached changelogs list instead of calling modified_changelogs directly.
        * Scripts/webkitpy/tool/steps/validatereviewer.py:
         - ditto.

2010-05-24  Kent Tamura  <tkent@chromium.org>

        Reviewed by Dimitri Glazkov.

        [DRT/Chromium] Import layout_test_helper for Windows
        https://bugs.webkit.org/show_bug.cgi?id=39581

        Import Chromium win/layout_test_helper.cc as LayoutTestHelperWin.cpp.
        http://src.chromium.org/viewvc/chrome/trunk/src/webkit/tools/test_shell/win/layout_test_helper.cc

        * DumpRenderTree/chromium/LayoutTestHelperWin.cpp: Added.

2010-05-24  Kent Tamura  <tkent@chromium.org>

        Reviewed by Dimitri Glazkov.

        [DRT/Chromium] Reset frame name
        https://bugs.webkit.org/show_bug.cgi?id=39586

        This change fixes about 70 unexpected results.

        * DumpRenderTree/chromium/WebViewHost.cpp:
        (WebViewHost::reset):

2010-05-24  Marcus Bulach  <bulach@chromium.org>

        Reviewed by Kent Tamura.

        [chromium] Adds WebGeolocationServiceMockImpl to remove public dependency on wtf/HashMap.h
        https://bugs.webkit.org/show_bug.cgi?id=39587

        * DumpRenderTree/chromium/WebViewHost.cpp:
        (WebViewHost::geolocationService):

2010-05-24  Robert Hogan  <robert@webkit.org>

        Reviewed by Laszlo Gombos.

        [Qt] DRT Support for removeOriginAccessWhitelistEntry

        Unskips http/tests/xmlhttprequest/origin-whitelisting-removal.html

        [Qt] DRT Support for removeOriginAccessWhitelistEntry
        https://bugs.webkit.org/show_bug.cgi?id=39565

        * DumpRenderTree/qt/LayoutTestControllerQt.cpp:
        (LayoutTestController::removeOriginAccessWhitelistEntry):

2010-05-24  Marcus Bulach  <bulach@google.com>

        Reviewed by Ojan Vafai.

        _svn_branch_has_extra_commits needs to check for ^HEAD instead of ^head.
        https://bugs.webkit.org/show_bug.cgi?id=39603

        * Scripts/webkitpy/common/checkout/scm.py:

== Rolled over to ChangeLog-2010-05-24 ==
