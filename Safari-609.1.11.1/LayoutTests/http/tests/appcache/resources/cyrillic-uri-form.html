<html manifest="cyrillic-uri.manifest">
<head>
<meta charset="koi8-r">
</head>
<body>
<form method=GET action="?">
<input type=text name=i value="">
</form>
<script>
document.write(location);
function test() {
    if (location.search == "") {
        document.forms[0].submit();
    } else if (location.search == "?i=%F0%D2%CF%D7%C5%D2%CB%C1") {
        document.forms[0].elements[0].value="-2";
        document.forms[0].submit();
    } else if (location.search == "?i=%F0%D2%CF%D7%C5%D2%CB%C1-2") {
        parent.postMessage("allDone", "*");
    } else {
        alert("Unexpected URI: " + location);
        parent.postMessage("allDone", "*");
    }
}
applicationCache.onnoupdate = function() { test() }
applicationCache.oncached = function() { test() }
</script>
</body>
</html>
