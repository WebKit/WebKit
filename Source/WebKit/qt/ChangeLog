2011-03-25  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Andreas Kling.

        [Qt] The keyboard shortcuts during fullscreen playback do not work.
        https://bugs.webkit.org/show_bug.cgi?id=57095

        We need to explicitely set the focus on the widget in order to receive the keyboard events.

        * WebCoreSupport/FullScreenVideoWidget.cpp:
        (WebCore::FullScreenVideoWidget::show):

2011-03-24  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r81916 and r81917.
        http://trac.webkit.org/changeset/81916
        http://trac.webkit.org/changeset/81917
        https://bugs.webkit.org/show_bug.cgi?id=57071

        broke a test on platforms that do not have QuickTime installed
        (Requested by estes on #webkit).

        * WebCoreSupport/FrameLoaderClientQt.cpp:
        (WebCore::FrameLoaderClientQt::objectContentType):
        * WebCoreSupport/FrameLoaderClientQt.h:

2011-03-24  Andy Estes  <aestes@apple.com>

        Reviewed by Darin Adler.

        REGRESSION (r70748): latest nightly builds kills AC_QuickTime.js
        https://bugs.webkit.org/show_bug.cgi?id=49016

        Update objectContentType() implementation to handle the
        shouldPreferPlugInsForImages flag.

        * WebCoreSupport/FrameLoaderClientQt.cpp:
        (WebCore::FrameLoaderClientQt::objectContentType):
        * WebCoreSupport/FrameLoaderClientQt.h:

2011-03-24  Benjamin Poulain  <benjamin.poulain@nokia.com>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] When we render WebGL offscreen, color conversion cost a lot of CPU cycles
        https://bugs.webkit.org/show_bug.cgi?id=40884

        Add tests and benchmarks for the software fallback of WebGL.

        * tests/benchmarks/webgl/10000_triangles.html: Added.
        * tests/benchmarks/webgl/tst_webgl.cpp: Added.
        (GraphicsView::GraphicsView):
        (GraphicsView::resizeEvent):
        (tst_WebGlPerformance::init):
        (tst_WebGlPerformance::cleanup):
        (tst_WebGlPerformance::benchSoftwareFallbackRgb16):
        (tst_WebGlPerformance::benchSoftwareFallbackRgb32):
        (tst_WebGlPerformance::benchSoftwareFallbackArgb32):
        (tst_WebGlPerformance::benchSoftwareFallbackArgb32Premultiplied):
        (tst_WebGlPerformance::benchmarkFrameRenderingOnImage):
        * tests/benchmarks/webgl/tst_webgl.qrc: Added.
        * tests/benchmarks/webgl/webgl.pro: Added.
        * tests/qgraphicswebview/qgraphicswebview.pro:
        * tests/qgraphicswebview/resources/pointing_right.html: Added.
        * tests/qgraphicswebview/resources/pointing_up.html: Added.
        * tests/qgraphicswebview/tst_qgraphicswebview.cpp:
        (compareImagesFuzzyPixelCount):
        (GraphicsView::GraphicsView):
        (tst_QGraphicsWebView::webglSoftwareFallbackVerticalOrientation):
        (tst_QGraphicsWebView::webglSoftwareFallbackHorizontalOrientation):
        (tst_QGraphicsWebView::compareCanvasToImage):
        * tests/qgraphicswebview/tst_qgraphicswebview.qrc:
        * tests/tests.pro:

2011-03-24  Kristian Amlie  <kristian.amlie@nokia.com>

        Reviewed by Benjamin Poulain.

        Avoided ASCII-cast warnings for WebKit.

        Normally they won't be enabled anyway, but if you build webkit from
        within the Qt mother repository it will pick up Qt's default build
        settings, which do enable it. We need to disable them because
        warnings are treated as errors and there are way too many of them in
        the WebKit code.

        [Qt] Avoid ASCII-cast warnings for WebKit.
        https://bugs.webkit.org/show_bug.cgi?id=57016

        * QtWebKit.pro:

2011-03-24  Caio Marcelo de Oliveira Filho  <caio.oliveira@openbossa.org>

        Reviewed by Benjamin Poulain.

        [Qt] Resetting the URL property of a QWebView results in the current directory being set as file::-type URL
        https://bugs.webkit.org/show_bug.cgi?id=29595

        Qt Designer resets the URL by setting it to QUrl(). The bug was caused by
        ensureAbsoluteUrl() helper function treating the empty URL as a relative URL, and
        prepending the current directory.

        By fixing this, now we can pass QUrl() invalid and empty URLs to WebCore layer, which
        will end up loading "about:blank", but keeping it as a requested URL.

        This patch also simplifies the logic for requestedUrl(), since m_lastRequestedUrl
        is filled for the loaded URLs as well, we can use it in every case.

        Three new autotests were added, to better cover the expected behavior of setting
        the QUrl() in a QWebFrame.

        * Api/qwebframe.cpp:
        (ensureAbsoluteUrl): do not treat invalid URLs (empty included) as relative.
        (QWebFrame::requestedUrl): always use m_lastRequestedUrl.

        * WebCoreSupport/FrameLoaderClientQt.cpp:
        (WebCore::FrameLoaderClientQt::dispatchDidFinishLoad): do not clear m_lastRequestedUrl
        anymore, since we always rely on it even for loaded frames.

        * tests/qwebframe/tst_qwebframe.cpp:
        (tst_QWebFrame::setUrlToEmpty): verify the behavior of setting empty URLs. This includes
        the reduction of the bug report.
        (tst_QWebFrame::setUrlToInvalid): setting invalid, but not necessarily empty, URLs.
        (tst_QWebFrame::setUrlHistory): to verify how setting empty URLs affect history.

2011-03-23  Brady Eidson  <beidson@apple.com>

        Reviewed by Sam Weinig.

        Change IconDatabase opening to allow for arbitrary filenames
        https://bugs.webkit.org/show_bug.cgi?id=56977

        * Api/qwebsettings.cpp:
        (QWebSettings::setIconDatabasePath):

2011-03-23  Aparna Nandyal  <aparna.nand@wipro.com>

        Reviewed by Andreas Kling.

        [Qt] QtWebKit rendering problem when maximizing and doing a back
        https://bugs.webkit.org/show_bug.cgi?id=56669

        Added an auto test.
        Patch by Alexis Menard < alexis.menard@nokia.com> on 2011-03-21
 
        * tests/qwebview/tst_qwebview.cpp:
        (tst_QWebView::rendering):

2011-03-23  Yury Semikhatsky  <yurys@chromium.org>

        Reviewed by Pavel Feldman.

        [V8] Web Inspector: compile DebuggerScript.js into DebuggerScriptSource.h
        https://bugs.webkit.org/show_bug.cgi?id=56843

        * WebCoreSupport/InspectorClientQt.cpp:
        (WebCore::InspectorClientQt::openInspectorFrontend):

2011-03-22  Andrew Wason  <rectalogic@rectalogic.com>

        Reviewed by Benjamin Poulain.

        [Qt] QWebPage with WebGL content crashes when rendering if no QWebView parent
        https://bugs.webkit.org/show_bug.cgi?id=54138

        * tests/qwebpage/tst_qwebpage.cpp:
        (webGLScreenshotWithoutView):
        (tst_QWebPage::acceleratedWebGLScreenshotWithoutView):
        (tst_QWebPage::unacceleratedWebGLScreenshotWithoutView):
         Render a QWebPage (with and without accelerated compositing)
         with a WebGL context that has no owning view.  Shouldn't crash.

2011-03-21  Chang Shu  <cshu@webkit.org>

        Reviewed by Alexey Proskuryakov.

        REGRESSION (r79953): Can't type in MS Outlook 2011
        https://bugs.webkit.org/show_bug.cgi?id=56665

        r79953 removed the WebView level editablity which is persistent no matter whether
        underlying document itself is changed and editability gets lost. The resolution is to
        set this WebView editable value to WebCore. This avoids the callback from WebCore to
        WebKit which was the main goal in r79953 to improve performance.

        * Api/qwebpage.cpp:
        (QWebPage::setContentEditable):
        (QWebPage::isContentEditable):

2011-03-19  Andreas Kling  <kling@webkit.org>

        Reviewed by Benjamin Poulain.

        [Qt] Remove support for Qt 4.6
        https://bugs.webkit.org/show_bug.cgi?id=56712

        * Api/qwebframe.cpp:
        (QWebFrame::load):
        * Api/qwebpage.cpp:
        (QWebPagePrivate::QWebPagePrivate):
        * Api/qwebsettings.cpp:
        (QWebSettings::QWebSettings):
        * WebCoreSupport/GeolocationClientQt.cpp:
        (WebCore::GeolocationClientQt::positionUpdated):

2011-03-19  Andreas Kling  <kling@webkit.org>

        Reviewed by Antonio Gomes.

        [Qt][Doc] QWebPage::unsupportedContent() passes ownership of the QNetworkReply
        https://bugs.webkit.org/show_bug.cgi?id=56711

        Document the fact that when unsupportedContent(QNetworkReply*) is emitted,
        ownership of the reply is transferred to the receiving slot.

        * Api/qwebpage.cpp:

2011-03-17  Brady Eidson  <beidson@apple.com>

        Reviewed by Sam Weinig.

        https://bugs.webkit.org/show_bug.cgi?id=56425
        More groundwork for WebKit2 IconDatabase

        Update already-used function names:
        * Api/qwebhistory.cpp:
        (QWebHistoryItem::icon):
        * Api/qwebsettings.cpp:
        (QWebSettings::iconForUrl):

2011-03-18  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Benjamin Poulain.

        [Qt] console.log not being exposed to QmlViewer
        https://bugs.webkit.org/show_bug.cgi?id=56536

        The documentation is bogus the feature does not exist.

        * declarative/qdeclarativewebview.cpp:

2011-03-17  Andreas Kling  <kling@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] QML WebView emits iconChanged() when the page title changes
        https://bugs.webkit.org/show_bug.cgi?id=56570

        * declarative/qdeclarativewebview.cpp:
        (QDeclarativeWebView::setPage): Don't forward the frame's titleChanged
        signal to the view's iconChanged signal.

2011-03-17  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Benjamin Poulain.

        [Qt] Videos look ugly when using QGraphicsWebView.
        https://bugs.webkit.org/show_bug.cgi?id=56580

        We need to set QPainter::SmoothPixmapTransform on the painter for a proper rendering of the video.
        QWebView does it but not QGraphicsWebView because the API does not exist. This patch is fixing it
        by introducing the same API as QWebView to control the renderHints of the item. Unlike QWebView
        QGraphicsWebView inherits the painter from QGraphicsScene and those flags are not set. This patch
        ensure that before rendering the item we add QPainter::SmoothPixmapTransform and QPainter::TextAntialiasing
        in addition of what could be set on the painter. In order to not break the rendering of all the items in the
        scene we set back the painter to its original state when QGraphicsWebView is rendered.

        * Api/qgraphicswebview.cpp:
        (QGraphicsWebViewPrivate::QGraphicsWebViewPrivate):
        (QGraphicsWebView::paint):
        (QGraphicsWebView::renderHints):
        (QGraphicsWebView::setRenderHints):
        (QGraphicsWebView::setRenderHint):
        * Api/qgraphicswebview.h:
        * tests/qgraphicswebview/tst_qgraphicswebview.cpp:
        (tst_QGraphicsWebView::renderHints):

2011-03-16  Joseph Pecoraro  <joepeck@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        Viewport no longer allows an auto value for "user-scalable"
        https://bugs.webkit.org/show_bug.cgi?id=55416

        Make the default value for userScalable be true.

        * Api/qwebpage.cpp:
        (QWebPage::viewportAttributesForSize):
        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        (DumpRenderTreeSupportQt::viewportAsText): update test output to include userScalable.

2011-03-15  Kevin Ollivier  <kevino@theolliviers.com>

        Reviewed by Darin Adler.

        Introduce WTF_USE_EXPORT_MACROS, which will allow us to put shared library import/export
        info into the headers rather than in export symbol definition files, but disable it on 
        all platforms initially so we can deal with port build issues one port at a time.
        
        https://bugs.webkit.org/show_bug.cgi?id=27551

        * WebCoreSupport/GeolocationClientQt.cpp:
        * WebCoreSupport/PopupMenuQt.cpp:

2011-03-14  Brady Eidson  <beidson@apple.com>

        Reviewed by Anders Carlsson.

        https://bugs.webkit.org/show_bug.cgi?id=56320
        Remove HistoryItem::icon() and the WebCore dependency on "IconDatabaseBase::defaultIcon()"

        * Api/qwebhistory.cpp:
        (QWebHistoryItem::icon): Use IconDatabase directly.

2011-03-11  Brady Eidson  <beidson@apple.com>

        Reviewed by attempt at build fix!

        https://bugs.webkit.org/show_bug.cgi?id=56216
        Fix the Qt build following the same pattern of the patch.

        * Api/qwebsettings.cpp:
        (QWebSettings::setIconDatabasePath): Call the static method via IconDatabase:: and not via iconDatabase()

2011-03-11  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Ariya Hidayat.

        [Qt] Entering fullscreen and leaving it may hide the cursor of the application.
        https://bugs.webkit.org/show_bug.cgi?id=56181

        We need to stop the auto hide cursor timer when closing the widget otherwise the timer
        might get fired and therefore hide the cursor even when the fullscreen widget is closed.

        * WebCoreSupport/FullScreenVideoWidget.cpp:
        (WebCore::FullScreenVideoWidget::closeEvent):

2011-03-10  David Boddie <david.boddie@nokia.com>

        Reviewed by Andreas Kling.

        Fixed a qdoc warning and terminology (WebKit instead of Webkit).
        https://bugs.webkit.org/show_bug.cgi?id=55756

        * Api/qwebhistoryinterface.cpp:

2011-03-10  Andreas Kling  <kling@webkit.org>

        Unreviewed build fix after r80774.

        QML property versioning is introduced in Qt 4.7.3, not 4.7.2.
        See also: http://bugreports.qt.nokia.com/browse/QTBUG-13451

        * declarative/plugin.cpp:
        (WebKitQmlPlugin::registerTypes):
        * declarative/qdeclarativewebview.cpp:
        * declarative/qdeclarativewebview_p.h:
        * tests/qdeclarativewebview/tst_qdeclarativewebview.cpp:

2011-03-10  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Andreas Kling.

        [Qt] QtDeclarative Webview element has a fixed white background
        https://bugs.webkit.org/show_bug.cgi?id=40918

        Implement a way to change the background color of the WebView QML element.
        This feature is activated for QtWebKit 1.1 version of the plugin.

        * declarative/plugin.cpp:
        (WebKitQmlPlugin::registerTypes):
        * declarative/qdeclarativewebview.cpp:
        (QDeclarativeWebView::backgroundColor):
        (QDeclarativeWebView::setBackgroundColor):
        * declarative/qdeclarativewebview_p.h:
        * tests/qdeclarativewebview/resources/webviewbackgroundcolor.qml: Added.
        * tests/qdeclarativewebview/tst_qdeclarativewebview.cpp:
        (tst_QDeclarativeWebView::backgroundColor):
        * tests/qdeclarativewebview/tst_qdeclarativewebview.qrc:

2011-03-10  Stanislav Paltis  <Stanislav.Paltis@nokia.com>

        Reviewed by Laszlo Gombos.

        [Qt] MemoryCache deadDecodedDataDeletionInterval is not exposed for client's usage
        https://bugs.webkit.org/show_bug.cgi?id=55945
        
        Added handling of dynamic/runtime property _q_deadDecodedDataDeletionInterval to 
        set interval used to trigger when decoded data in dead list of object cache will 
        be purged from object cache. 

        * Api/qwebpage.cpp:
        (QWebPagePrivate::dynamicPropertyChangeEvent):

2011-03-10  Caio Marcelo de Oliveira Filho  <caio.oliveira@openbossa.org>

        Reviewed by Antonio Gomes.

        Simplify how QWebFrame::requestedUrl() is obtained
        https://bugs.webkit.org/show_bug.cgi?id=55842

        When a load starts, store the requested URL until we know that it'll be
        available for us in the document loader -- after load finished.

        The existing auto tests cover the three different code paths in
        requestedUrl() and the new code passes the autotests. In each of those
        cases, we looked for the information in a different place, but in all
        of them, dispatchDidStartProvisionalLoad was called.

        This simplification will be useful to fix bug 32723. The way requestedUrl()
        is implementent, we can't use it as a fallback for url() when the setUrl()
        was called with an invalid URL.

        * Api/qwebframe.cpp:
        (QWebFrame::requestedUrl):
        * WebCoreSupport/FrameLoaderClientQt.cpp:
        (WebCore::FrameLoaderClientQt::dispatchDidStartProvisionalLoad):
        (WebCore::FrameLoaderClientQt::dispatchDidFinishLoad):
        * WebCoreSupport/FrameLoaderClientQt.h:
        (WebCore::FrameLoaderClientQt::lastRequestedUrl):

2011-03-10  Gustavo Noronha Silva  <gustavo.noronha@collabora.co.uk>

        Reviewed by Kenneth Rohde Christiansen.

        Tiled backing store's delegated scroll request uses incorrect convention
        https://bugs.webkit.org/show_bug.cgi?id=56011

        Adapt internal API to match the change from delta to point on the
        WebCore side, and convert the point to a delta for the public API.

        * WebCoreSupport/ChromeClientQt.cpp:
        (WebCore::ChromeClientQt::delegatedScrollRequested):
        * WebCoreSupport/ChromeClientQt.h:

2011-03-09  Peter Kasting  <pkasting@google.com>

        Reviewed by Mihai Parparita.

        Unify Windows version checks.
        https://bugs.webkit.org/show_bug.cgi?id=55979

        * Api/qwebpage.cpp:
        (QWebPage::userAgentForUrl):

2011-03-07  Sam Weinig  <sam@webkit.org>

        Reviewed by Anders Carlsson.

        Replace WebKit2's decidePolicyForMIMEType with decidePolicyForResponse
        https://bugs.webkit.org/show_bug.cgi?id=55827

        Renamed FrameLoaderClient::dispatchDecidePolicyForMIMEType to dispatchDecidePolicyForResponse
        and pass the entire response, instead of just the MIMEType.

        * WebCoreSupport/FrameLoaderClientQt.cpp:
        (WebCore::FrameLoaderClientQt::dispatchDecidePolicyForResponse):
        * WebCoreSupport/FrameLoaderClientQt.h:

2011-03-05  Qi Zhang  <qi.2.zhang@nokia.com>

        Reviewed by Laszlo Gombos.

        [Qt] Mobile Devices should include Model and Firmware Version in Webkit Generated User Agent String
        https://bugs.webkit.org/show_bug.cgi?id=48636

        Add model infomation into user agent string when qtmobility is available, but only for symbian, Maemo and MeeGo.

        * Api/qwebpage.cpp:
        (QWebPage::userAgentForUrl):

2011-03-03  Mahesh Kulkarni  <mahesh.kulkarni@nokia.com>

        Reviewed by Kenneth Rohde Christiansen.

        [QT] Implement mock client-based geolocation for layout testing
        https://bugs.webkit.org/show_bug.cgi?id=54334

        Implement layout testing for Client-Based geolocation. If drt_run is set 
        then create mock geolocationClient and update the same with controller.

        * Api/qwebpage.cpp:
        (QWebPagePrivate::QWebPagePrivate):
        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        (DumpRenderTreeSupportQt::mockGeolocationReset):
        (DumpRenderTreeSupportQt::setMockGeolocationPermission):
        (DumpRenderTreeSupportQt::setMockGeolocationPosition):
        (DumpRenderTreeSupportQt::setMockGeolocationError):
        * WebCoreSupport/DumpRenderTreeSupportQt.h:
        * WebCoreSupport/GeolocationClientQt.cpp:
        (WebCore::GeolocationClientQt::GeolocationClientQt):
        * WebCoreSupport/GeolocationClientQt.h:

2011-03-03  Caio Marcelo de Oliveira Filho  <caio.oliveira@openbossa.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] QWebFrame::setUrl works only from second time if url fragment is present
        https://bugs.webkit.org/show_bug.cgi?id=32723

        Create an auto-test for Qt based on the bug description.

        * tests/qwebframe/tst_qwebframe.cpp: add setUrlWithFragment() test.

2011-03-03  Brady Eidson  <beidson@apple.com>

        Reviewed by Darin Adler.

        https://bugs.webkit.org/show_bug.cgi?id=55721
        Global IconDatabase should be returned by reference, not as a pointer

        * Api/qwebsettings.cpp:
        (QWebSettings::setIconDatabasePath):
        (QWebSettings::iconDatabasePath):
        (QWebSettings::clearIconDatabase):
        (QWebSettings::iconForUrl):

2011-03-03  Alexey Proskuryakov  <ap@apple.com>

        Removing an include of WebCoreKeyboardUIMode.h that Ive just added. It's already included
        via ChromeClient.h

        * WebCoreSupport/ChromeClientQt.h:

2011-03-02  Alexey Proskuryakov  <ap@apple.com>

        Reviewed by Darin Adler.

        REGRESSION (WebKit2): Tab keys no longer observe Full Keyboard Access
        https://bugs.webkit.org/show_bug.cgi?id=55633
        <rdar://problem/8963023>

        * WebCoreSupport/ChromeClientQt.cpp (WebCore::ChromeClientQt::keyboardUIMode):
        * WebCoreSupport/ChromeClientQt.h:
        Implement keyboardUIMode() instead of tabsToLinks(). No change in functionality, since
        this platform doesn't observe or have full keyboard access state.

2011-03-03  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Andreas Kling.

        [Qt] QGraphicsWebView should use updateMicroFocus() of QGraphicsItem
        https://bugs.webkit.org/show_bug.cgi?id=55568

        We should use updateMicroFocus() from QGraphicsItem rather than the implementation
        in QGraphicsWebView. _q_updateMicroFocus was added when QGraphicsItem didn't have the feature.
        In Qt 4.7, updateMicroFocus was added, let's use it, then we can benefit of all bug fixing done
        in QGraphicsItem.

        * Api/qgraphicswebview.cpp:
        (QGraphicsWebView::setPage):
        * Api/qgraphicswebview.h:

2011-03-03  Peter Kasting  <pkasting@google.com>

        Reviewed by James Robinson.

        Drop redundant "Windows; " from the Windows-specific User Agent string.
        https://bugs.webkit.org/show_bug.cgi?id=54567

        * Api/qwebpage.cpp:
        (QWebPage::userAgentForUrl):

2011-03-01  Brian Weinstein  <bweinstein@apple.com>

        Reviewed by Adam Roben.

        Part of WebKit2: Need a way to send notifications to client when cookies change
        https://bugs.webkit.org/show_bug.cgi?id=55427
        <rdar://problem/9056027>
        
        Add stubs for CookiesStrategy on Qt WebKit1.

        * WebCoreSupport/WebPlatformStrategies.cpp:
        (WebPlatformStrategies::createCookiesStrategy):
        (WebPlatformStrategies::notifyCookiesChanged):
        * WebCoreSupport/WebPlatformStrategies.h:

2011-03-01  Joseph Pecoraro  <joepeck@webkit.org>

        Unreviewed. Roll out r80068 and r80073 due to breaking WebKit2 Qt port.

        * Api/qwebpage.cpp:
        (QWebPage::viewportAttributesForSize):
        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        (DumpRenderTreeSupportQt::viewportAsText):

2011-03-01  Joseph Pecoraro  <joepeck@webkit.org>

        Reviewed by Kenneth Rohde Christiansen.

        Viewport Warning/Error Messages Are Now Inaccurate
        https://bugs.webkit.org/show_bug.cgi?id=53707

        * Api/qwebpage.cpp:
        (QWebPage::viewportAttributesForSize): pass a Document into computeViewportAttributes for warnings to be reported to.
        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        (DumpRenderTreeSupportQt::viewportAsText): pass a Document into computeViewportAttributes for warnings to be reported to.

2011-03-01  Andras Becsi  <abecsi@webkit.org>

        Reviewed by Csaba Osztrogonác.

        [Qt] Clean up the project files and move common options to WebKit.pri.

        * QtWebKit.pro: Move common options to WebKit.pri.

2011-03-01  Aparna Nandyal  <aparna.nand@wipro.com>

        Reviewed by Simon Hausmann.

        [Qt]tst_QWebPage::backActionUpdate fails when there is not network connection
        https://bugs.webkit.org/show_bug.cgi?id=55319

        The test case required internet connection to be able to connect to
        google.com. Added new html file which refers to local html file.

        * tests/qwebpage/resources/content.html: Added.
        * tests/qwebpage/resources/frame_c.html: Added.
        * tests/qwebpage/resources/framedindex.html: Added.
        * tests/qwebpage/tst_qwebpage.cpp:
        (tst_QWebPage::backActionUpdate):
        * tests/qwebpage/tst_qwebpage.qrc:

2011-02-25 Steve Block <steveblock@google.com>

        Reviewed by Jeremy Orlow.

        Bridge.h should not include BridgeJSC.h
        https://bugs.webkit.org/show_bug.cgi?id=55212

        Include BridgeJSC.h directly instead.

        * Api/qwebframe.cpp:

2011-02-28  Chang Shu  <cshu@webkit.org>

        Reviewed by Ryosuke Niwa.

        Remove the support of Frame::isContentEditable and its dependencies.
        https://bugs.webkit.org/show_bug.cgi?id=54292

        Remove the WebKit side implementation. Make WebKit support depend on Document::inDesignMode.

        * Api/qwebpage.cpp:
        (QWebPagePrivate::QWebPagePrivate):
        (QWebPage::setContentEditable):
        (QWebPage::isContentEditable):
        * Api/qwebpage_p.h:
        * WebCoreSupport/EditorClientQt.cpp:
        * WebCoreSupport/EditorClientQt.h:

2011-02-28  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Oliver Hunt.

        Build fix for Qt port after API changes of http://trac.webkit.org/changeset/79904.

        * Api/qwebelement.cpp:
        (QWebElement::evaluateJavaScript):

2011-02-28  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Andreas Kling.

        [Qt]tst_QDeclarativeWebView - 8 test cases fail
        https://bugs.webkit.org/show_bug.cgi?id=55214

        Fix the API tests for the QML WebView element. The default size of the element should be the size of the QGraphicsWebView
        if no preferred width or height are provided (see http://trac.webkit.org/changeset/79672).
        I also refactored the tests so we don't use the network but instead a local html file.
        QML doesn't support qrc loading so I had to workaround by using a property that I update afterwards.

        * tests/qdeclarativewebview/resources/sample.html: Added.
        * tests/qdeclarativewebview/resources/webviewtest.qml:
        * tests/qdeclarativewebview/resources/webviewtestdefault.qml:
        * tests/qdeclarativewebview/tst_qdeclarativewebview.cpp:
        (tst_QDeclarativeWebView::preferredWidthTest):
        (tst_QDeclarativeWebView::preferredHeightTest):
        (tst_QDeclarativeWebView::preferredWidthDefaultTest):
        (tst_QDeclarativeWebView::preferredHeightDefaultTest):
        * tests/qdeclarativewebview/tst_qdeclarativewebview.qrc:

2011-02-28  Viatcheslav Ostapenko  <ostapenko.viatcheslav@nokia.com>

        Reviewed by Andreas Kling.

        [Qt] Add clipped version of QWebElement::render method.
        Allows faster rendering of web element part.
        https://bugs.webkit.org/show_bug.cgi?id=50311

        * Api/qwebelement.cpp:
        (QWebElement::render):
        * Api/qwebelement.h:
        * tests/qwebelement/tst_qwebelement.cpp:
        (tst_QWebElement::render):

2011-02-28  Kristian Amlie  <kristian.amlie@nokia.com>

        Reviewed by Andreas Kling.

        Added full webkit module profile and a syncqt profile.

        This is for modularized Qt.

        [Qt] WebKit patches required to work with a modularized version of Qt
        https://bugs.webkit.org/show_bug.cgi?id=53916

        * qt_webkit_version.pri:

2011-02-27  Aparna Nandyal  <aparna.nand@wipro.com>

        Reviewed by Antonio Gomes.

        [Qt] QtTestBrowser - Horizontal scrollbar disappears on navigating pages using Back/Forward
        https://bugs.webkit.org/show_bug.cgi?id=53917

        Adding test case to check the scenario to avoid regressions in the
        future. 

        * tests/qwebframe/tst_qwebframe.cpp:

2011-02-27  Benjamin Poulain  <benjamin.poulain@nokia.com>

        Reviewed by Andreas Kling.

        [Qt] Reference the documentation of the WebKit bridge from QWebFrame::addToJavaScriptWindowObject()
        https://bugs.webkit.org/show_bug.cgi?id=55322

        Documentation update, add a reference to the QtWebKit bridge page.

        * Api/qwebframe.cpp:

2011-02-26  Vsevolod Vlasov  <vsevik@chromium.org>

        Reviewed by Pavel Feldman.

        DumpRenderTree should reset frame opener between tests.
        https://bugs.webkit.org/show_bug.cgi?id=54874

        Added clearOpener method to DumpRenderTreeSupportQT.

        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        (DumpRenderTreeSupportQt::clearOpener):
        * WebCoreSupport/DumpRenderTreeSupportQt.h:

2011-02-26  Kenneth Rohde Christiansen  <kenneth@webkit.org>

        Reviewed by Andreas Kling.

        Make it possible to test the targetdensity-dpi support
        https://bugs.webkit.org/show_bug.cgi?id=55142

        Test the viewport meta tag feature targetdensity-dpi by
        adding extra arguments to dumpConfigurationForViewport

        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        (DumpRenderTreeSupportQt::viewportAsText):
        * WebCoreSupport/DumpRenderTreeSupportQt.h:

2011-02-26  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r79764.
        http://trac.webkit.org/changeset/79764
        https://bugs.webkit.org/show_bug.cgi?id=55295

        "broke Chromium builds" (Requested by rniwa on #webkit).

        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        * WebCoreSupport/DumpRenderTreeSupportQt.h:

2011-02-26  Vsevolod Vlasov  <vsevik@chromium.org>

        Reviewed by Pavel Feldman.

        DumpRenderTree should reset frame opener between tests.
        https://bugs.webkit.org/show_bug.cgi?id=54874

        Added clearOpener method to DumpRenderTreeSupportQT.

        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        (DumpRenderTreeSupportQt::clearOpener):
        * WebCoreSupport/DumpRenderTreeSupportQt.h:

2011-02-25  Andras Becsi  <abecsi@webkit.org>

        Reviewed by Csaba Osztrogonác.

        [Qt] Make the WebKit2 build system less confusing for non-Qt developers
        https://bugs.webkit.org/show_bug.cgi?id=55213

        * QtWebKit.pro: Move the WebKit2 API into a project include file
        in the WebKit2 directory and include the pri file here.

2011-02-25  Alexis Menard  <alexis.menard@openbossa.org>

        Unreviewed build fix for Intel ICC and MSVC.

        * tests/qgraphicswebview/tst_qgraphicswebview.cpp:
        (tst_QGraphicsWebView::setPalette):
        * tests/qwebview/tst_qwebview.cpp:
        (tst_QWebView::setPalette):

2011-02-25  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Properly propagate the palette to QWebPage from QGraphicsWebView
        https://bugs.webkit.org/show_bug.cgi?id=31742

        Discovered while looking at 31742. When we set a palette on the
        QGraphicsWebView we need to propagate it to the page like QWebView.
        I have added the same tests as QWebView to be sure to catch potential
        regressions as well as two extras QVERIFY to check the palette propagation.

        * Api/qgraphicswebview.cpp:
        (QGraphicsWebView::event):
        * tests/qgraphicswebview/tst_qgraphicswebview.cpp:
        (tst_QGraphicsWebView::setPalette_data):
        (tst_QGraphicsWebView::setPalette):

2011-02-25  Csaba Osztrogonác  <ossy@webkit.org>

        Unreviewed buildfix after r79672.

        [Qt] Build tst_qdeclarativewebview if QT_CONFIG contains declarative.

        * tests/tests.pri:
        * tests/tests.pro:

2011-02-25  Gopal Raghavan  <gopal.1.raghavan@nokia.com>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] QML WebView inside a Flickable shows checkers pattern at startup
        https://bugs.webkit.org/show_bug.cgi?id=50222.

        This patch fixes the checkerboard visible at startup even if preferredWidth and preferredHeight are not set.

        * declarative/qdeclarativewebview.cpp:
        (QDeclarativeWebView::init):
        * tests/qdeclarativewebview: Added.
        * tests/qdeclarativewebview/qdeclarativewebview.pro: Added.
        * tests/qdeclarativewebview/resources: Added.
        * tests/qdeclarativewebview/resources/webviewtest.qml: Added.
        * tests/qdeclarativewebview/resources/webviewtestdefault.qml: Added.
        * tests/qdeclarativewebview/tst_qdeclarativewebview.cpp: Added.
        (tst_QDeclarativeWebView::initTestCase):
        (tst_QDeclarativeWebView::cleanupTestCase):
        (tst_QDeclarativeWebView::init):
        (tst_QDeclarativeWebView::cleanup):
        (tst_QDeclarativeWebView::preferredWidthTest):
        (tst_QDeclarativeWebView::preferredHeightTest):
        (tst_QDeclarativeWebView::preferredWidthDefaultTest):
        (tst_QDeclarativeWebView::preferredHeightDefaultTest):
        (tst_QDeclarativeWebView::checkNoErrors):
        * tests/tests.pri:
        * tests/tests.pro:

2011-02-24  Jocelyn Turcotte  <jocelyn.turcotte@nokia.com>

        Reviewed by Andreas Kling.

        [Qt] Revert the support for QNAM affined to a different thread.
        https://bugs.webkit.org/show_bug.cgi?id=55149

        Qt 4.8 will have QNAM use its own thread internally by default,
        no need to keep this complexity in WebKit.

        This mainly reverts:
        http://trac.webkit.org/changeset/73710
        http://trac.webkit.org/changeset/73712

        * WebCoreSupport/FrameLoaderClientQt.cpp:
        (WebCore::FrameLoaderClientQt::download):
        * tests/qwebpage/tst_qwebpage.cpp:

2011-02-24  Sam Weinig  <sam@webkit.org>

        Try to fix the Qt build.

        * QtWebKit.pro:

2011-02-24  Peter Kasting  <pkasting@google.com>

        Reviewed by Eric Seidel.

        Drop the "U; " encryption level from the User Agent string.
        https://bugs.webkit.org/show_bug.cgi?id=54566

        * Api/qwebpage.cpp:
        (QWebPage::userAgentForUrl):

2011-02-24  Andrew Wilson  <atwilson@chromium.org>

        Unreviewed, rolling out r79570.
        http://trac.webkit.org/changeset/79570
        https://bugs.webkit.org/show_bug.cgi?id=54874

        Breaks chromium build because glue/mocks/mock_web_frame.h/cc
        was not updated

        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        * WebCoreSupport/DumpRenderTreeSupportQt.h:

2011-02-24  Vsevolod Vlasov  <vsevik@chromium.org>

        Reviewed by Alexey Proskuryakov.

        DumpRenderTree should reset frame opener between tests.
        https://bugs.webkit.org/show_bug.cgi?id=54874

        Added clearOpener method to DumpRenderTreeSupportQT.

        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        (DumpRenderTreeSupportQt::clearOpener):
        * WebCoreSupport/DumpRenderTreeSupportQt.h:

2011-02-24  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Andreas Kling.

        [Qt] tst_QWebView::setPalette(activeFG) fails
        https://bugs.webkit.org/show_bug.cgi?id=55029

        This time it should be the proper fix. The window needs to be shown before we
        call activateWindow() otherwise there is no active windows for the application.

        * tests/qwebview/tst_qwebview.cpp:
        (tst_QWebView::setPalette):

2011-02-24  Andras Becsi  <abecsi@webkit.org>

        Reviewed by Laszlo Gombos.

        [Qt] MinGW build fails to link
        https://bugs.webkit.org/show_bug.cgi?id=55050

        Prepend the libraries of subcomponents instead of appending them
        to fix the library order according to the dependency of the libraries

        * QtWebKit.pro: prepend libraries in the correct order

2011-02-23  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Ariya Hidayat.

        [Qt] tst_QWebView::setPalette(activeFG) fails
        https://bugs.webkit.org/show_bug.cgi?id=55029

        Attempt to make the test more robust. By investigating with the bot virtual machine
        I discovered that the activation can take some time. In this patch we make sure that
        the active window we want to have is the same as the QApplication.

        * tests/qwebview/tst_qwebview.cpp:
        (tst_QWebView::setPalette):

2011-02-23  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Dan Bernstein.

        [Qt]REGRESSION(r79167): It broke 3 Qt-API test cases
        http://trac.webkit.org/changeset/79167 refactored the way the bound size of
        the frame is handled. A new API setBoundsSize was added, we need to call it
        in addition to setFrameRect. I could call setBoundSize after setFrameRect but
        I thought It would be more elegant to use the resize method.

        * Api/qwebpage.cpp:
        (QWebPage::setViewportSize):

2011-02-22  Fabrizio Machado  <fabrizio.machado@nokia.com>

        Reviewed by Laszlo Gombos.

        [Qt] Don't fall through case in variantToSetting() if qvariant.type() is Bool
        https://bugs.webkit.org/show_bug.cgi?id=54976

        Test not needed.
        
        * WebCoreSupport/InspectorClientQt.cpp:

2011-02-22  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Andreas Kling.

        [Qt] QWebView ignores a palette set with QWebView::setPalette()
        https://bugs.webkit.org/show_bug.cgi?id=31742

        Test case to check that the palette sets on the QWebView is taken
        into account.

        * tests/qwebview/tst_qwebview.cpp:
        (tst_QWebView::setPalette_data):
        (tst_QWebView::setPalette):

2011-02-22  Laszlo Gombos  <laszlo.1.gombos@nokia.com>

        Reviewed by Alexey Proskuryakov.

        Drop the language tag part from the User Agent string
        https://bugs.webkit.org/show_bug.cgi?id=54560

        * Api/qwebpage.cpp:
        (QWebPage::userAgentForUrl):

        * tests/qwebpage/tst_qwebpage.cpp: Remove the userAgentLocaleChange
        test.

2011-02-22  Chang Shu  <cshu@webkit.org>

        Reviewed by Csaba Osztrogonác.

        [Qt] editing/deleting/5408255.html fails
        https://bugs.webkit.org/show_bug.cgi?id=54964

        Move WebCore resource file to QtWebKit since they are referred in WebKit.

        * QtWebKit.pro:

2011-02-22  Andras Becsi  <abecsi@webkit.org>

        Reviewed by Csaba Osztrogonác.

        [Qt] Redesign the build system
        https://bugs.webkit.org/show_bug.cgi?id=51339

        Move inspector's resource files into the final build step to fix the layout test regression.

        * QtWebKit.pro: Add inspector's reaource files.

2011-02-22  Andras Becsi  <abecsi@webkit.org>

        Reviewed by Laszlo Gombos.
        Rubber-stamped by Csaba Osztrogonác.

        [Qt] Redesign the build system
        https://bugs.webkit.org/show_bug.cgi?id=51339

        The patch landed in r79320 didn't contain the cleanup
        which was already addressed in the last attachment.

        * QtWebKit.pro: Move common LIB and CONFIG options to WebCore.pri.

2011-02-22  Andras Becsi  <abecsi@webkit.org>

        Reviewed by Laszlo Gombos.

        [Qt] Redesign the build system
        https://bugs.webkit.org/show_bug.cgi?id=51339

        Part 2.

        Build WebCore as a static library, compile the WebKit API and WebKit2 API
        in a final step and link to WebKit2, WebCore and JSC libraries to fix
        linking issues resulting from stripped away symbols.

        * QtWebKit.pro: Added.
        Project file for the final build step.

2011-02-17  Ryosuke Niwa  <rniwa@webkit.org>

        Reviewed by Kent Tamura.

        Rename Position::node() to Position::deprecatedNode()
        https://bugs.webkit.org/show_bug.cgi?id=54622

        Replaced the call to node() by a call to containerNode() because the returned node is
        used to determine whether or not the selected contents are editable and such a check
        must be done against the container node.

        * WebCoreSupport/EditorClientQt.cpp:
        (WebCore::EditorClientQt::handleKeyboardEvent):

2011-02-19  Charlie Reis  <creis@chromium.org>

        Reviewed by Mihai Parparita.

        Ensure loading has stopped in HistoryController::goToItem
        https://bugs.webkit.org/show_bug.cgi?id=54517

        Add a FrameLoaderClient callback for whether to stop loading before goToItem.

        Test: http/tests/navigation/forward-to-fragment-fires-onload.html

        * WebCoreSupport/FrameLoaderClientQt.cpp:
        (WebCore::FrameLoaderClientQt::shouldStopLoadingForHistoryItem): Added.
        * WebCoreSupport/FrameLoaderClientQt.h:

2011-02-18  Fabrizio Machado  <fabrizio.machado@nokia.com>

        Reviewed by Eric Seidel.

        Remove reduntant checks.
        https://bugs.webkit.org/show_bug.cgi?id=54764
        

        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        (DumpRenderTreeSupportQt::elementDoesAutoCompleteForElementWithId):
        * WebCoreSupport/NotificationPresenterClientQt.cpp:
        (WebCore::NotificationPresenterClientQt::toPage):

2011-02-18  Csaba Osztrogonác  <ossy@webkit.org>

        Unreviewed.

        [Qt] Buildfix for platforms with geolocation disabled.

        * Api/qwebpage.cpp: Add the missing guard.

2011-02-18  Mahesh Kulkarni  <mahesh.kulkarni@nokia.com>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Implement client based geolocation for qtport
        https://bugs.webkit.org/show_bug.cgi?id=42629

        Implements client based geolocation for qtwebkit.
        New client based geolocation contains permission API's as well,
        so removed the implementation from ChromeClientQt.cpp. 

        * Api/qwebpage.cpp:
        (QWebPagePrivate::QWebPagePrivate):
        * WebCoreSupport/ChromeClientQt.cpp:
        * WebCoreSupport/ChromeClientQt.h:
        (WebCore::ChromeClientQt::requestGeolocationPermissionForFrame):
        (WebCore::ChromeClientQt::cancelGeolocationPermissionRequestForFrame):
        * WebCoreSupport/GeolocationClientQt.cpp: Added.
        (WebCore::GeolocationClientQt::GeolocationClientQt):
        (WebCore::GeolocationClientQt::~GeolocationClientQt):
        (WebCore::GeolocationClientQt::geolocationDestroyed):
        (WebCore::GeolocationClientQt::positionUpdated):
        (WebCore::GeolocationClientQt::startUpdating):
        (WebCore::GeolocationClientQt::stopUpdating):
        (WebCore::GeolocationClientQt::setEnableHighAccuracy):
        (WebCore::GeolocationClientQt::requestPermission):
        (WebCore::GeolocationClientQt::cancelPermissionRequest):
        * WebCoreSupport/GeolocationClientQt.h: Added.
        (WebCore::GeolocationClientQt::lastPosition):

2011-02-10  Luiz Agostini  <luiz.agostini@openbossa.org>

        Reviewed by Adam Roben.

        HTML5 <details> and <summary>: localized text
        https://bugs.webkit.org/show_bug.cgi?id=54260

        The method defaultDetailsSummaryText was added to LocalizationStrategy class. It is used to
        provide the default label to be used by a <details> tag that has no <summary> child.

        * WebCoreSupport/WebPlatformStrategies.cpp:
        (WebPlatformStrategies::defaultDetailsSummaryText):
        * WebCoreSupport/WebPlatformStrategies.h:

2011-02-17  Hui Huang  <hui.2.huang@nokia.com>

        Reviewed by Laszlo Gombos.

        The URL of HTML5 Video Element is percent encoded at websites such as youtube.
        It is percent encoded again by QUrl constructor QUrl::QUrl(QString). This causes
        the HTTP GET request for the video to be rejected by the service provider. 
        https://bugs.webkit.org/show_bug.cgi?id=53973.

        The bug is fixed by constructing QUrl from the encoded URL in 
        MediaPlayerPrivateQt::commitLoad. 

        New test function tst_QWebPage::loadHtml5Video() is added to load HTML content with
        HTML5 Video element. A new public method DumpRenderTreeSupportQt::mediaContentUrlByElementId
        is added to retrieve the URL of the media content from WebCore MediaPlayerPrivateQt.
        A new macro ENABLE_QT_MULTIMEDIA is introduced in tests.pri to make sure that the test
        is skipped if Qt Multimedia is not available.

        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        (DumpRenderTreeSupportQt::mediaContentUrlByElementId):
        * WebCoreSupport/DumpRenderTreeSupportQt.h:
        * tests/qwebpage/tst_qwebpage.cpp:
        (tst_QWebPage::loadHtml5Video):
        * tests/tests.pri:

2011-02-17  Andreas Kling  <kling@webkit.org>

        Reviewed by Antti Koivisto.

        [Qt] Crash when calling QWebFrame::setUrl() while a previous load has pending requests
        https://bugs.webkit.org/show_bug.cgi?id=49216

        * tests/qwebframe/tst_qwebframe.cpp:

== Rolled over to ChangeLog-2011-02-16 ==
