<!doctype html><!-- webkit-test-runner [ IPCTestingAPIEnabled=true ] -->
<script>
function fuzz() {
    if (!window.IPC)
        return;
    const defaultTimeout = 1000;
    o4=IPC.pageID;
    o5=IPC.webPageProxyID;
    let pair = IPC.createStreamClientConnection(14);
    o35=pair[0];
    o36=pair[1];
    o35.open();

    // Use random identifiers in case this test is run multiple times in the same process.
    let backendID = Math.floor(Math.random() * 100000000) + 1;
    let imageBufferID = Math.floor(Math.random() * 100000000) + 1;

    IPC.sendMessage('GPU',0,IPC.messages.GPUConnectionToWebProcess_CreateRenderingBackend.name,
                  [{type: 'uint64_t', value: backendID},
                   {type: 'uint64_t', value: o5},
                   {type: 'uint64_t', value: o4},
                   {type: 'StreamServerConnectionHandle', value: o36}])
    resp = o35.waitForMessage(backendID, IPC.messages.RemoteRenderingBackendProxy_DidInitialize.name, defaultTimeout)
    o35.setSemaphores(resp[0].value, resp[1].value);
    o35.sendMessage(backendID, IPC.messages.RemoteRenderingBackend_CreateImageBuffer.name, 0.1,
                  [{type: 'float', value: 804},
                   {type: 'float', value: 486},
                   {type: 'uint8_t', value: 0},
                   {type: 'uint8_t', value: 2},
                   {type: 'float', value: 184},
                   {type: 'uint8_t', value: 0},
                   {type: 'uint8_t', value: 0},
                   {type: 'uint64_t', value: imageBufferID}])
    try {
        o35.waitForMessage(imageBufferID, IPC.messages.RemoteImageBufferProxy_DidCreateBackend.name, defaultTimeout);
    } catch { }
    try {
        o35.sendSyncMessage(imageBufferID,IPC.messages.RemoteImageBuffer_GetShareableBitmap.name,0.1,[{type: 'bool',value: 0}]);
    } catch { }
    o35.invalidate();
}
</script>
<body onload='fuzz()'></body>
