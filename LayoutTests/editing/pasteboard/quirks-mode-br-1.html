<script>
if (window.testRunner)
     testRunner.dumpEditingCallbacks();
</script>
<p>This is a test to make sure that the final &lt;br&gt; in an incoming fragment is interpretted strictly in quirks mode (where brs at the end of blocks are collapsed).  This test used to fail because of unrendered content to the left of the collapsed br.</p>
<div id="test" contenteditable="true"><div>The test should add a single blank line after this paragraph.<span></span><br></div></div>

<script>
var s = window.getSelection();
var e = document.getElementById("test");

s.setPosition(e, 0);
s.modify("move", "forward", "line");
document.execCommand("InsertHTML", false, "<br>");
</script>
