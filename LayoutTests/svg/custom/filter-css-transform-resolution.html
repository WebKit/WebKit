<!DOCTYPE html>
<html>
<head>
    <script>
        function runAfterLayoutAndPaint(callback, autoNotifyDone) {
            if (!window.testRunner) {
                // For manual test. Delay 500ms to allow us to see the visual change
                // caused by the callback.
                setTimeout(callback, 500);
                return;
            }

            if (autoNotifyDone)
                testRunner.waitUntilDone();

            // We do requestAnimationFrame and setTimeout to ensure a frame has started
            // and layout and paint have run. The requestAnimationFrame fires after the
            // frame has started but before layout and paint. The setTimeout fires
            // at the beginning of the next frame, meaning that the previous frame has
            // completed layout and paint.
            // See http://crrev.com/c/1395193/10/third_party/blink/web_tests/http/tests/resources/run-after-layout-and-paint.js
            // for more discussions.
            requestAnimationFrame(function() {
                setTimeout(function() {
                    callback();
                    if (autoNotifyDone)
                        testRunner.notifyDone();
                }, 1);
            });
        }
    </script>
  <script>
    function repaintTest() {
      document.getElementById('div').style.transform = '';
    }
  </script>
</head>
<body onload="runAfterLayoutAndPaint(repaintTest, true);">
  <!-- Test for http://crbug.com/345441 - the circle edge should not be blurry -->
  <div id="div" style="transform: rotate3d(1, 0, 0, 85deg); -webkit-transform-origin: 100px 100px 0px;">
    <svg width="300" height="300" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <defs>
        <filter x="0" y="0" width="100%" height="100%" id="filter">
          <feOffset/>
        </filter>
      </defs>
      <circle cx="100" cy="100" r="100" fill="green" filter="url(#filter)"/>
    </svg>
  </div>
</body>
</html>