2018-01-30  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rebaseline tests for rdar://problem/36912404&36912403.

        * platform/mac-elcapitan/imported/w3c/web-platform-tests/service-workers/service-worker/fetch-request-redirect.https-expected.txt: Added.
        * platform/mac-elcapitan/imported/w3c/web-platform-tests/service-workers/service-worker/fetch-request-resources.https-expected.txt: Added.

2018-01-29  Ryan Haddad  <ryanhaddad@apple.com>

        Cherry-pick r227708. rdar://problem/36915685

    2018-01-26  Youenn Fablet  <youenn@apple.com>

            Layout Test imported/w3c/web-platform-tests/service-workers/service-worker/appcache-ordering-main.https.html is flaky
            https://bugs.webkit.org/show_bug.cgi?id=182176
            <rdar://problem/36915685>

            Unreviewed.

            * TestExpectations: Skiping test for now.

2018-01-26  Ryan Haddad  <ryanhaddad@apple.com>

        Cherry-pick r227203. rdar://problem/36837397

    2018-01-19  Ryan Haddad  <ryanhaddad@apple.com>

            Update TestExpectations for media/W3C/audio/networkState/networkState_during_loadstart.html.
            https://bugs.webkit.org/show_bug.cgi?id=123010

            Unreviewed test gardening.

            * platform/mac/TestExpectations:

2018-01-26  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227570. rdar://problem/36873398

    2018-01-24  Antti Koivisto  <antti@apple.com>

            Assertion failure in RenderMultiColumnSet::requiresBalancing() on fast/multicol/spanner-crash-when-adding-summary.html
            https://bugs.webkit.org/show_bug.cgi?id=179308
            <rdar://problem/34592771>

            Reviewed by Zalan Bujtas.

            Unskip fast/multicol/spanner-crash-when-adding-summary.html

            * platform/ios/TestExpectations:
            * platform/mac/TestExpectations:

2018-01-26  Ryan Haddad  <ryanhaddad@apple.com>

        Cherry-pick r227426. rdar://problem/36837397

    2018-01-23  Ryan Haddad  <ryanhaddad@apple.com>

            Mark inspector/unit-tests/throttle.html as flaky.
            https://bugs.webkit.org/show_bug.cgi?id=181832

            Unreviewed test gardening.

            * platform/mac/TestExpectations:

2018-01-25  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227567. rdar://problem/36873353

    2018-01-24  Daniel Bates  <dabates@apple.com>

            [CSP] Check policy for targeted windows when navigating to a JavaScript URL
            https://bugs.webkit.org/show_bug.cgi?id=182018
            <rdar://problem/36795781>

            Reviewed by Brent Fulgham.

            * http/tests/security/contentSecurityPolicy/resources/window-open-javascript-url-with-target-blocked.html: Added.
            * http/tests/security/contentSecurityPolicy/resources/window-open-javascript-url-with-target-blocked.js: Added.
            (done):
            * http/tests/security/contentSecurityPolicy/window-open-javascript-url-with-target-blocked-expected.txt: Added.
            * http/tests/security/contentSecurityPolicy/window-open-javascript-url-with-target-blocked.html: Added.

2018-01-25  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227566. rdar://problem/36722508

    2018-01-24  Chris Dumez  <cdumez@apple.com>

            Add a IPC::SendSyncOption indicating we should not process incoming IPC while waiting for the sync reply
            https://bugs.webkit.org/show_bug.cgi?id=182021
            <rdar://problem/21629943>

            Reviewed by Ryosuke Niwa.

            Add layout test coverage for the new flag.

            * fast/misc/testIncomingSyncIPCMessageWhileWaitingForSyncReply-expected.txt: Added.
            * fast/misc/testIncomingSyncIPCMessageWhileWaitingForSyncReply.html: Added.

2018-01-25  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227533. rdar://problem/36873383

    2018-01-24  Daniel Bates  <dabates@apple.com>

            REGRESSION (r226138): Selecting a line that ends with zero-width joiner (ZWJ) may cause text transformation
            https://bugs.webkit.org/show_bug.cgi?id=181993
            <rdar://problem/36421080>

            Reviewed by David Hyatt.

            Add a Mac-specific test to ensure that selecting the last visible character on a line
            that ends with a zero-width joiner (ZWJ) does not cause a text transformation of the
            selected character.

            We need to fix <https://bugs.webkit.org/show_bug.cgi?id=181964> for this test to
            pass on Mac.

            * TestExpectations: Skip the test directory on non-Mac platforms.
            * fast/text/mac/select-character-before-zero-width-joiner-expected.html: Added.
            * fast/text/mac/select-character-before-zero-width-joiner.html: Added.
            * platform/mac/TestExpectations: Mark the test directory as PASS on Mac so that we run
            all containing tests. Mark the test as ImageOnlyFailure until we fix <https://bugs.webkit.org/show_bug.cgi?id=181964>.

2018-01-25  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227430. rdar://problem/36873610

    2018-01-23  Simon Fraser  <simon.fraser@apple.com>

            Element with position:fixed stops scrolling at the bottom of the page, but is painted in the right place on Chacos.com.
            https://bugs.webkit.org/show_bug.cgi?id=181741
            rdar://problem/36593581

            Reviewed by Tim Horton.

            * fast/visual-viewport/ios/min-scale-greater-than-one-expected.txt: Added.
            * fast/visual-viewport/ios/min-scale-greater-than-one.html: Added.

2018-01-25  Ryan Haddad  <ryanhaddad@apple.com>

        Cherry-pick r227421. rdar://problem/36837397

    2018-01-23  Andy Estes  <aestes@apple.com>

            Follow-up layout test fix after r227260.

            I missed a few places that were still using version 3 API requests.

            * http/tests/ssl/applepay/ApplePayRequestShippingContact.https.html:

2018-01-25  Ryan Haddad  <ryanhaddad@apple.com>

        Cherry-pick r227260. rdar://problem/36837397

    2018-01-19  Andy Estes  <aestes@apple.com>

            [Sierra Debug WK2] ASSERTION FAILED: paymentCoordinator().supportsVersion(version)
            https://bugs.webkit.org/show_bug.cgi?id=181833

            Reviewed by Youenn Fablet.

            Moved the version 3 test into its own file that only runs on High Sierra and later.

            * http/tests/ssl/applepay/ApplePayRequestShippingContactV3.https-expected.txt: Added.
            * http/tests/ssl/applepay/ApplePayRequestShippingContactV3.https.html: Added.
            * platform/mac-wk2/TestExpectations:

2018-01-25  Ryan Haddad  <ryanhaddad@apple.com>

        Work towards rdar://problem/36837397.

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2018-01-25  Ryan Haddad  <ryanhaddad@apple.com>

        Work towards rdar://problem/36837397.

        Unreviewed test gardening.

        * platform/mac-elcapitan-wk2/fast/dom/navigator-detached-no-crash-expected.txt:
        * platform/mac-wk1/fast/dom/navigator-detached-no-crash-expected.txt:
        * platform/mac/TestExpectations:

2018-01-24  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227581. rdar://problem/36846010

    2018-01-24  Youenn Fablet  <youenn@apple.com>

            Opaque being-loaded responses should clone their body
            https://bugs.webkit.org/show_bug.cgi?id=182056

            Reviewed by Brady Eidson.

            * http/wpt/service-workers/clone-opaque-being-loaded-response-worker.js: Added.
            * http/wpt/service-workers/clone-opaque-being-loaded-response.html: Added.
            * http/wpt/service-workers/clone-opaque-being-loaded-response.https-expected.txt: Added.
            * http/wpt/service-workers/resources/clone-opaque-being-loaded-response-iframe.html: Added.
            * http/wpt/service-workers/resources/lengthy-pass.py: Added.
            (main):

2018-01-24  Ryan Haddad  <ryanhaddad@apple.com>

        Cherry-pick r227080. rdar://problem/36837397

    2018-01-17  Simon Fraser  <simon.fraser@apple.com>

            REGRESSION (r226902): fast/events/ios/rotation/layout-viewport-during-rotation.html and fast/events/ios/rotation/safe-area-insets-during-safari-type-rotation.html are timing out
            <rdar://problem/36589755>

            The first argument to a load event listener is an event, which meant that passing scriptCompleteCallback
            didn't work as expected.

            * fast/events/ios/rotation/layout-viewport-during-rotation.html:
            * fast/events/ios/rotation/safe-area-insets-during-safari-type-rotation.html:

2018-01-24  Ryan Haddad  <ryanhaddad@apple.com>

        Cherry-pick r226720. rdar://problem/36837397

    2018-01-10  Chris Dumez  <cdumez@apple.com>

            Unreviewed, skip http/tests/workers/service/other_resources folder.

            It is a resources folder and does not contain tests.

            * TestExpectations:

2018-01-24  Ryan Haddad  <ryanhaddad@apple.com>

        Cherry-pick r226759. rdar://problem/36837397

    2018-01-10  Ryan Haddad  <ryanhaddad@apple.com>

            Mark swipe/pushstate-with-manual-scrollrestoration.html as failing.
            https://bugs.webkit.org/show_bug.cgi?id=181502

            Unreviewed test gardening.

            * platform/mac-wk2/TestExpectations:

2018-01-24  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227531. rdar://problem/36830355

    2018-01-24  Youenn Fablet  <youenn@apple.com>

            Fetch response should copy its url from the request if null
            https://bugs.webkit.org/show_bug.cgi?id=182048

            Reviewed by Chris Dumez.

            * http/tests/workers/service/basic-fetch.https-expected.txt:
            * http/tests/workers/service/resources/basic-fetch.js:
            (async.test):

2018-01-24  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227479. rdar://problem/36830349

    2018-01-23  Wenson Hsieh  <wenson_hsieh@apple.com>

            Harden against layout passes triggered when iterating through HTMLFormElement::associatedElements
            https://bugs.webkit.org/show_bug.cgi?id=182037
            <rdar://problem/36747812>

            Reviewed by Ryosuke Niwa.

            Add a new layout test covering these hardening changes. See WebCore ChangeLog for more details.

            * fast/forms/form-data-associated-element-iteration-expected.txt: Added.
            * fast/forms/form-data-associated-element-iteration.html: Added.

2018-01-23  Jason Marcell  <jmarcell@apple.com>

        Apply patch. rdar://problem/36685708

    Update test results for features disabled on branch
    <rdar://problem/36685708>

    2018-01-23  Maciej Stachowiak  <mjs@apple.com>

            Update test results for features disabled on branch
            <rdar://problem/36685708>

            Reviewed by Maciej Stachowiak.

            * TestExpectations:
            * accessibility/color-well-expected.txt:
            * accessibility/roles-exposed-expected.txt:
            * animations/trigger-computed-style-expected.txt:
            * animations/trigger-container-scroll-boundaries-expected.txt:
            * animations/trigger-parsing-expected.txt:
            * fast/canvas/webgl/copyBufferSubData-expected.txt:
            * fast/canvas/webgl/getBufferSubData-webgl1-expected.txt:
            * fast/canvas/webgl/webgl2-buffer-targets-expected.txt:
            * fast/canvas/webgl/webgl2-buffers-expected.txt:
            * fast/canvas/webgl/webgl2-context-creation-expected.txt:
            * fast/canvas/webgl/webgl2-getActiveUniforms-expected.txt:
            * fast/canvas/webgl/webgl2-runtime-flag-expected.txt:
            * fast/canvas/webgl/webgl2-texStorage-expected.txt:
            * fast/canvas/webgl/webgl2-texture-upload-enums-expected.txt:
            * fast/canvas/webgl/webgl2/constants-expected.txt:
            * fast/css/pseudo-visited-background-color-on-input-expected.html:
            * fast/css/read-only-read-write-input-basics-expected.html:
            * fast/dom/navigator-detached-no-crash-expected.txt:
            * fast/forms/color/color-setrangetext-expected.txt:
            * fast/forms/color/input-color-onchange-event-expected.txt:
            * fast/forms/color/input-color-readonly-expected.txt:
            * fast/forms/color/input-value-sanitization-color-expected.txt:
            * fast/selectors/read-only-read-write-input-basics-expected.txt:
            * inspector/canvas/create-context-webgl2-expected.txt:
            * inspector/canvas/requestContent-webgl2-expected.txt:
            * inspector/canvas/resolveCanvasContext-webgl2-expected.txt:
            * inspector/canvas/shaderProgram-add-remove-webgl2-expected.txt:
            * platform/mac/accessibility/roles-exposed-expected.txt:
            * platform/mac/fast/forms/color/input-appearance-color-expected.txt:
            * platform/mac/media/encrypted-media/fps-createMediaKeys-expected.txt:
            * platform/mac/media/encrypted-media/fps-createSession-expected.txt:
            * platform/mac/media/encrypted-media/fps-encrypted-event-expected.txt:
            * platform/mac/media/encrypted-media/fps-generateRequest-expected.txt:
            * webgl/webgl-vertex-array-object-defined-expected.txt:
            * webgl/webgl2-rendering-context-defined-expected.txt:
            * webgl/webgl2-rendering-context-obtain-expected.txt:

2018-01-23  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227425. rdar://problem/36791667

    2018-01-23  Brady Eidson  <beidson@apple.com>

            Allow passing MessagePorts across processes (e.g. ServiceWorkers).
            https://bugs.webkit.org/show_bug.cgi?id=181178

            Reviewed by Andy Estes.

            * http/tests/workers/service/basic-messageport-expected.txt: Added.
            * http/tests/workers/service/basic-messageport.html: Added.
            * http/tests/workers/service/resources/basic-messageport.js: Added.
            * http/tests/workers/service/resources/messageport-echo-worker.js: Added.

2018-01-23  Jason Marcell  <jmarcell@apple.com>

        Revert r227216. rdar://problem/36722508

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227370. rdar://problem/36763189

    2018-01-22  Nikita Vasilyev  <nvasilyev@apple.com>

            Web Inspector: Styles Redesign: data corruption when updating values quickly
            https://bugs.webkit.org/show_bug.cgi?id=179461
            <rdar://problem/35431882>

            Reviewed by Joseph Pecoraro.

            * inspector/css/modify-css-property-expected.txt: Added.
            * inspector/css/modify-css-property.html: Added.

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227277. rdar://problem/36763214

    2018-01-21  Andy Estes  <aestes@apple.com>

            [ios] LayoutTest imported/w3c/web-platform-tests/payment-request/rejects_if_not_active.https.html is crashing in JSC::JSONParse
            https://bugs.webkit.org/show_bug.cgi?id=177832
            <rdar://problem/34805315>

            Reviewed by Tim Horton.

            Made a copy of imported/w3c/web-platform-tests/payment-request/rejects_if_not_active.https.html
            and modified it to handle Apple Pay and user gesture requirements.

            * http/tests/paymentrequest/rejects_if_not_active.https-expected.txt: Added.
            * http/tests/paymentrequest/rejects_if_not_active.https.html: Added.
            * http/tests/paymentrequest/resources/page1.html: Added.
            * http/tests/paymentrequest/resources/page2.html: Added.
            * platform/ios-wk2/TestExpectations:
            * platform/mac-wk2/TestExpectations:

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227338. rdar://problem/36746095

    2018-01-22  Andy Estes  <aestes@apple.com>

            LayoutTest http/tests/paymentrequest/payment-request-abort-method.https.html is a flaky failure
            https://bugs.webkit.org/show_bug.cgi?id=178107
            <rdar://problem/34901064>

            Reviewed by Brady Eidson.

            Modified the test to call show() with user activation.

            * http/tests/paymentrequest/payment-request-abort-method.https.html:
            * platform/ios-wk2/TestExpectations:
            * platform/mac-wk2/TestExpectations:

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227339. rdar://problem/36745908

    2018-01-22  Youenn Fablet  <youenn@apple.com>

            Fetch Headers from an Opaque response should be filtered out
            https://bugs.webkit.org/show_bug.cgi?id=181926

            Reviewed by Chris Dumez.

            * http/wpt/fetch/response-opaque-clone-expected.txt:
            * http/wpt/fetch/response-opaque-clone.html:

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227346. rdar://problem/36746149

    2018-01-22  Antti Koivisto  <antti@apple.com>

            REGRESSION (Safari 11): Buttons inside a fieldset legend cannot be clicked on in Safari 11
            https://bugs.webkit.org/show_bug.cgi?id=179666
            <rdar://problem/35534292>

            Reviewed by Zalan Bujtas.

            * fast/forms/legend-overflow-hidden-hit-test-expected.txt: Added.
            * fast/forms/legend-overflow-hidden-hit-test.html: Added.
            * platform/ios/TestExpectations:

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227348. rdar://problem/36746180

    2018-01-22  Youenn Fablet  <youenn@apple.com>

            Safari Tech Preview can't use GitHub login at forums.swift.org
            https://bugs.webkit.org/show_bug.cgi?id=181908
            <rdar://problem/36715111>

            Reviewed by Chris Dumez.

            * http/wpt/service-workers/navigation-redirect-worker.js: Added.
            (async):
            * http/wpt/service-workers/navigation-redirect.https-expected.txt: Added.
            * http/wpt/service-workers/navigation-redirect.https.html: Added.

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227174. rdar://problem/36723030

    2018-01-18  Chris Dumez  <cdumez@apple.com>

            We should be able to terminate service workers that are unresponsive
            https://bugs.webkit.org/show_bug.cgi?id=181563
            <rdar://problem/35280031>

            Reviewed by Alex Christensen.

            Add layout test coverage.

            * http/tests/workers/service/postmessage-after-terminating-hung-worker-expected.txt: Added.
            * http/tests/workers/service/postmessage-after-terminating-hung-worker.html: Added.
            * http/tests/workers/service/resources/postmessage-after-terminating-hung-worker.js: Added.
            * http/tests/workers/service/resources/postmessage-echo-worker-mayhang.js: Added.

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227280. rdar://problem/36722450

    2018-01-19  Ryosuke Niwa  <rniwa@webkit.org>

            Release assertion in canExecuteScript when executing scripts during page cache restore
            https://bugs.webkit.org/show_bug.cgi?id=181902

            Reviewed by Antti Koivisto.

            Added regression tests for the release assertion and navigating while a document is being restored from the page cache.
            WebKit should not hit any assertions in either situations.

            * fast/history/page-cache-execute-script-during-restore-expected.txt: Added.
            * fast/history/page-cache-execute-script-during-restore.html: Added.
            * fast/history/page-cache-navigate-during-restore-expected.txt: Added.
            * fast/history/page-cache-navigate-during-restore.html: Added.
            * fast/history/resources/navigate-back-with-finish-test-stage.html: Added.

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227278. rdar://problem/36722580

    2018-01-21  Jer Noble  <jer.noble@apple.com>

            REGRESSION (macOS 10.13.2): imported/w3c/web-platform-tests/media-source/mediasource-* LayoutTests failing
            https://bugs.webkit.org/show_bug.cgi?id=181891

            Reviewed by Eric Carlson.

            * platform/mac/TestExpectations:

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227272. rdar://problem/36722635

    2018-01-20  Jer Noble  <jer.noble@apple.com>

            Release ASSERT when reloading Vimeo page @ WebCore: WebCore::Document::updateLayout
            https://bugs.webkit.org/show_bug.cgi?id=181840
            <rdar://problem/36186214>

            Reviewed by Simon Fraser.

            * media/video-fullscreen-reload-crash-expected.txt: Added.
            * media/video-fullscreen-reload-crash.html: Added.
            * platform/ios/TestExpectations:

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227270. rdar://problem/36722650

    2018-01-20  Youenn Fablet  <youenn@apple.com>

            fetch redirect is incompatible with "no-cors" mode
            https://bugs.webkit.org/show_bug.cgi?id=181866
            <rdar://problem/35827140>

            Reviewed by Chris Dumez.

            * http/tests/fetch/redirectmode-and-preload-expected.txt:
            * http/tests/fetch/redirectmode-and-preload.html:

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227245. rdar://problem/36722470

    2018-01-19  Youenn Fablet  <youenn@apple.com>

            Cache storage errors like Quota should trigger console messages
            https://bugs.webkit.org/show_bug.cgi?id=181879
            <rdar://problem/36669048>

            Reviewed by Chris Dumez.

            * http/wpt/cache-storage/cache-quota.any-expected.txt:

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227240. rdar://problem/36722464

    2018-01-19  Dean Jackson  <dino@apple.com>

            REGRESSION (r221092): Swipe actions are hard to perform in FastMail app
            https://bugs.webkit.org/show_bug.cgi?id=181817
            <rdar://problem/35274055>

            Reviewed by Simon Fraser.

            * fast/events/touch/ios/passive-by-default-on-document-and-window-expected.txt:

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227238. rdar://problem/36722424

    2018-01-19  Daniel Bates  <dabates@apple.com>

            Update frame-ancestor directive to match Content Security Policy Level 3
            https://bugs.webkit.org/show_bug.cgi?id=178891
            <rdar://problem/35209458>

            Reviewed by Alex Christensen.

            Derived from Blink e667cc2e501fabab3605b838e4ee0d642a9c4a59:
            <https://chromium.googlesource.com/chromium/src.git/+/e667cc2e501fabab3605b838e4ee0d642a9c4a59>

            * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-cross-in-allow-same-origin-sandboxed-cross-url-allow-expected.txt: Added.
            * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-cross-in-allow-same-origin-sandboxed-cross-url-allow.html: Added.
            * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-cross-in-sandboxed-cross-url-block-expected.txt: Added.
            * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-cross-in-sandboxed-cross-url-block.html: Added.
            * http/tests/security/contentSecurityPolicy/resources/frame-ancestors-test.js:
            (injectNestedIframe):
            (window.onload):
            (testNestedIFrame):

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227225. rdar://problem/36722527

    2018-01-19  Joseph Pecoraro  <pecoraro@apple.com>

            AppCache: Log a Deprecation warning to the Console when AppCache is used
            https://bugs.webkit.org/show_bug.cgi?id=181778

            Reviewed by Alex Christensen.

            * http/tests/appcache/404-manifest-expected.txt:
            * http/tests/appcache/404-resource-expected.txt:
            * http/tests/appcache/404-resource-with-slow-main-resource-expected.txt:
            * http/tests/appcache/abort-cache-onchecking-expected.txt:
            * http/tests/appcache/abort-cache-onchecking-manifest-404-expected.txt:
            * http/tests/appcache/abort-cache-onchecking-resource-404-expected.txt:
            * http/tests/appcache/abort-cache-ondownloading-expected.txt:
            * http/tests/appcache/abort-cache-ondownloading-manifest-404-expected.txt:
            * http/tests/appcache/abort-cache-ondownloading-resource-404-expected.txt:
            * http/tests/appcache/abort-cache-onprogress-expected.txt:
            * http/tests/appcache/access-via-redirect-expected.txt:
            * http/tests/appcache/crash-when-navigating-away-then-back-expected.txt:
            * http/tests/appcache/credential-url-expected.txt:
            * http/tests/appcache/cyrillic-uri-expected.txt:
            * http/tests/appcache/decide-navigation-policy-after-delay-expected.txt:
            * http/tests/appcache/deferred-events-delete-while-raising-expected.txt:
            * http/tests/appcache/deferred-events-delete-while-raising-timer-expected.txt:
            * http/tests/appcache/deferred-events-expected.txt:
            * http/tests/appcache/different-https-origin-resource-main-expected.txt:
            * http/tests/appcache/different-origin-manifest-expected.txt:
            * http/tests/appcache/different-scheme-expected.txt:
            * http/tests/appcache/document-write-html-element-2-expected.txt:
            * http/tests/appcache/empty-manifest-expected.txt:
            * http/tests/appcache/fail-on-update-2-expected.txt:
            * http/tests/appcache/fail-on-update-expected.txt:
            * http/tests/appcache/fallback-expected.txt:
            * http/tests/appcache/fallback-namespace-outside-manifest-path-expected.txt:
            * http/tests/appcache/foreign-fallback-expected.txt:
            * http/tests/appcache/foreign-iframe-main-expected.txt:
            * http/tests/appcache/history-test-expected.txt:
            * http/tests/appcache/idempotent-update-expected.txt:
            * http/tests/appcache/identifier-test-expected.txt:
            * http/tests/appcache/interrupted-update-expected.txt:
            * http/tests/appcache/local-content-expected.txt:
            * http/tests/appcache/main-resource-fallback-for-network-error-crash-expected.txt:
            * http/tests/appcache/main-resource-hash-expected.txt:
            * http/tests/appcache/main-resource-redirect-expected.txt:
            * http/tests/appcache/manifest-containing-itself-expected.txt:
            * http/tests/appcache/manifest-parsing-expected.txt:
            * http/tests/appcache/manifest-redirect-2-expected.txt:
            * http/tests/appcache/manifest-redirect-expected.txt:
            * http/tests/appcache/manifest-with-empty-file-expected.txt:
            * http/tests/appcache/max-size-expected.txt:
            * http/tests/appcache/multi-fallback-expected.txt:
            * http/tests/appcache/navigating-away-while-cache-attempt-in-progress-expected.txt:
            * http/tests/appcache/non-html-expected.txt:
            * http/tests/appcache/offline-access-expected.txt:
            * http/tests/appcache/online-fallback-layering-expected.txt:
            * http/tests/appcache/online-whitelist-expected.txt:
            * http/tests/appcache/origin-delete-expected.txt:
            * http/tests/appcache/origin-quota-continued-download-expected.txt:
            * http/tests/appcache/origin-quota-continued-download-multiple-manifests-expected.txt:
            * http/tests/appcache/origin-quota-expected.txt:
            * http/tests/appcache/origin-usage-expected.txt:
            * http/tests/appcache/origins-with-appcache-expected.txt:
            * http/tests/appcache/progress-counter-expected.txt:
            * http/tests/appcache/reload-expected.txt:
            * http/tests/appcache/remove-cache-expected.txt:
            * http/tests/appcache/resource-redirect-2-expected.txt:
            * http/tests/appcache/resource-redirect-expected.txt:
            * http/tests/appcache/simple-expected.txt:
            * http/tests/appcache/simple-video-async-expected.txt:
            * http/tests/appcache/simple-video-sync-expected.txt:
            * http/tests/appcache/top-frame-1-expected.txt:
            * http/tests/appcache/top-frame-2-expected.txt:
            * http/tests/appcache/top-frame-3-expected.txt:
            * http/tests/appcache/top-frame-4-expected.txt:
            * http/tests/appcache/update-cache-expected.txt:
            * http/tests/appcache/video-expected.txt:
            * http/tests/appcache/whitelist-wildcard-expected.txt:
            * http/tests/appcache/wrong-content-type-expected.txt:
            * http/tests/appcache/wrong-signature-2-expected.txt:
            * http/tests/appcache/wrong-signature-expected.txt:
            * http/tests/appcache/x-frame-options-prevents-framing-expected.txt:
            * http/tests/appcache/xhr-foreign-resource-expected.txt:
            * http/tests/contentfiltering/load-substitute-data-from-appcache-expected.txt:
            * http/tests/security/appcache-switching-private-browsing-expected.txt:
            * http/tests/security/cross-origin-appcache-allowed-expected.txt:
            * http/tests/security/cross-origin-appcache-expected.txt:
            * http/tests/security/same-origin-appcache-blocked-expected.txt:
            * http/tests/ssl/upgrade-origin-usage-expected.txt:

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227219. rdar://problem/36722501

    2018-01-19  James Craig  <jcraig@apple.com>

            AX: when invert colors is on, double-invert image and picture elements in UserAgentStyleSheet
            https://bugs.webkit.org/show_bug.cgi?id=181281
            <rdar://problem/36291776>

            Reviewed by Simon Fraser.

            Updated to include img and picture element tests.

            * accessibility/smart-invert-expected.txt:
            * accessibility/smart-invert-reference-expected.html:
            * accessibility/smart-invert.html:

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227216. rdar://problem/36722508

    2018-01-19  Chris Dumez  <cdumez@apple.com>

            The WebContent process should not process incoming IPC while waiting for a sync IPC reply
            https://bugs.webkit.org/show_bug.cgi?id=181560

            Reviewed by Ryosuke Niwa.

            Add layout test coverage.

            * fast/misc/testIncomingSyncIPCMessageWhileWaitingForSyncReply-expected.txt: Added.
            * fast/misc/testIncomingSyncIPCMessageWhileWaitingForSyncReply.html: Added.

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227199. rdar://problem/36722438

    2018-01-19  Antoine Quint  <graouts@apple.com>

            [iOS] LayoutTest media/modern-media-controls/media-controller/ios/media-controller-ios-do-not-hide-controls-when-tapping-button.html fails on Internal bots
            https://bugs.webkit.org/show_bug.cgi?id=181843
            <rdar://problem/36061363>

            The button we were trying to press was outside of the viewable screen area and so the tap wouldn't occur.
            Resizing the video to fit in the window fixes the issue.

            Reviewed by Youenn Fablet.

            * media/modern-media-controls/media-controller/ios/media-controller-ios-do-not-hide-controls-when-tapping-button.html:

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227145. rdar://problem/36722475

    2018-01-18  Antti Koivisto  <antti@apple.com>

            REGRESSION (r223604): Setting :before/after pseudo element on <noscript> asserts
            https://bugs.webkit.org/show_bug.cgi?id=181795
            <rdar://problem/36334524>

            Reviewed by David Kilzer.

            * fast/css-generated-content/noscript-pseudo-anim-crash-expected.txt: Added.
            * fast/css-generated-content/noscript-pseudo-anim-crash.html: Added.

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227141. rdar://problem/36722585

    2018-01-17  Per Arne Vollan  <pvollan@apple.com>

            REGRESSION (r224780): Text stroke not applied to video captions.
            https://bugs.webkit.org/show_bug.cgi?id=181743
            <rdar://problem/35874338>

            Reviewed by Simon Fraser.

            * media/track/track-css-stroke-cues-expected.txt:
            * media/track/track-css-stroke-cues.html:
            * media/track/track-css-visible-stroke-expected.html: Added.
            * media/track/track-css-visible-stroke.html: Added.

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227140. rdar://problem/36722478

    2018-01-18  Andy Estes  <aestes@apple.com>

            [Payment Request] Support a default shipping address for Apple Pay
            https://bugs.webkit.org/show_bug.cgi?id=181754
            <rdar://problem/36009733>

            Reviewed by Brady Eidson.

            * http/tests/ssl/applepay/ApplePayRequestShippingContact.https-expected.txt: Added.
            * http/tests/ssl/applepay/ApplePayRequestShippingContact.https.html: Added.

2018-01-22  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227082. rdar://problem/36722629

    2018-01-17  Antti Koivisto  <antti@apple.com>

            REGRESSION (r226385?): Crash in com.apple.WebCore: WebCore::MediaQueryEvaluator::evaluate const + 32
            https://bugs.webkit.org/show_bug.cgi?id=181742
            <rdar://problem/36334726>

            Reviewed by David Kilzer.

            * fast/media/mediaqueryevaluator-crash-expected.txt: Added.
            * fast/media/mediaqueryevaluator-crash.html: Added.

2018-01-17  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227121. rdar://problem/36609529

    2018-01-17  Jer Noble  <jer.noble@apple.com>

            WebVTT served via HLS never results in cues
            https://bugs.webkit.org/show_bug.cgi?id=181773

            Reviewed by Eric Carlson.

            * http/tests/media/hls/hls-webvtt-tracks-expected.txt: Added.
            * http/tests/media/hls/hls-webvtt-tracks.html: Added.
            * http/tests/media/resources/hls/subtitles/fileSequence0.webvtt: Added.
            * http/tests/media/resources/hls/subtitles/prog_index.m3u8: Added.
            * http/tests/media/resources/hls/test-webvtt.m3u8: Added.

2018-01-17  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227103. rdar://problem/36598105

    2018-01-17  John Wilander  <wilander@apple.com>

            Resource Load Statistics: Block cookies for prevalent resources without user interaction
            https://bugs.webkit.org/show_bug.cgi?id=177394
            <rdar://problem/34613960>

            Reviewed by Alex Christensen.

            * http/tests/resourceLoadStatistics/add-blocking-to-redirect-expected.txt: Added.
            * http/tests/resourceLoadStatistics/add-blocking-to-redirect.html: Added.
            * http/tests/resourceLoadStatistics/add-partitioning-to-redirect.html:
            * http/tests/resourceLoadStatistics/non-prevalent-resources-can-access-cookies-in-a-third-party-context-expected.txt: Added.
            * http/tests/resourceLoadStatistics/non-prevalent-resources-can-access-cookies-in-a-third-party-context.html: Added.
            * http/tests/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-with-partitioning-timeout.html:
            * http/tests/resourceLoadStatistics/remove-blocking-in-redirect-expected.txt: Added.
            * http/tests/resourceLoadStatistics/remove-blocking-in-redirect.html: Added.
            * http/tests/resourceLoadStatistics/remove-partitioning-from-redirect-expected.txt: Removed.
            * http/tests/resourceLoadStatistics/remove-partitioning-from-redirect.html: Removed.
                Test case reworked and is now remove-partitioning-in-redirect.html.
            * http/tests/resourceLoadStatistics/remove-partitioning-in-redirect-expected.txt: Added.
            * http/tests/resourceLoadStatistics/remove-partitioning-in-redirect.html: Added.
            * platform/ios/TestExpectations:
                New tests marked as [ Pass ] for iOS.
            * platform/mac-wk2/TestExpectations:
                New tests marked as [ Pass ] for High Sierra+.
            * platform/wk2/TestExpectations:
                New tests skipped for WK2 in general.

2018-01-17  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227093. rdar://problem/36598105

    2018-01-17  Matt Lewis  <jlewis3@apple.com>

            Unreviewed, rolling out r227076.

            This breaks internal builds

            Reverted changeset:

            "Resource Load Statistics: Block cookies for prevalent
            resources without user interaction"
            https://bugs.webkit.org/show_bug.cgi?id=177394
            https://trac.webkit.org/changeset/227076

2018-01-17  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227087. rdar://problem/36597993

    2018-01-17  Zalan Bujtas  <zalan@apple.com>

            Multicol: RenderMultiColumnFlow should not inherit the flow state
            https://bugs.webkit.org/show_bug.cgi?id=181762
            <rdar://problem/35448565>

            Reviewed by Simon Fraser.

            * fast/multicol/crash-when-out-of-flow-positioned-becomes-in-flow-expected.txt: Added.
            * fast/multicol/crash-when-out-of-flow-positioned-becomes-in-flow.html: Added.

2018-01-17  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227076. rdar://problem/36598105

    2018-01-17  John Wilander  <wilander@apple.com>

            Resource Load Statistics: Block cookies for prevalent resources without user interaction
            https://bugs.webkit.org/show_bug.cgi?id=177394
            <rdar://problem/34613960>

            Reviewed by Alex Christensen.

            * http/tests/resourceLoadStatistics/add-blocking-to-redirect-expected.txt: Added.
            * http/tests/resourceLoadStatistics/add-blocking-to-redirect.html: Added.
            * http/tests/resourceLoadStatistics/add-partitioning-to-redirect.html:
            * http/tests/resourceLoadStatistics/non-prevalent-resources-can-access-cookies-in-a-third-party-context-expected.txt: Added.
            * http/tests/resourceLoadStatistics/non-prevalent-resources-can-access-cookies-in-a-third-party-context.html: Added.
            * http/tests/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-with-partitioning-timeout.html:
            * http/tests/resourceLoadStatistics/remove-blocking-in-redirect-expected.txt: Added.
            * http/tests/resourceLoadStatistics/remove-blocking-in-redirect.html: Added.
            * http/tests/resourceLoadStatistics/remove-partitioning-from-redirect-expected.txt: Removed.
            * http/tests/resourceLoadStatistics/remove-partitioning-from-redirect.html: Removed.
                Test case reworked and is now remove-partitioning-in-redirect.html.
            * http/tests/resourceLoadStatistics/remove-partitioning-in-redirect-expected.txt: Added.
            * http/tests/resourceLoadStatistics/remove-partitioning-in-redirect.html: Added.
            * platform/ios/TestExpectations:
                New tests marked as [ Pass ] for iOS.
            * platform/mac-wk2/TestExpectations:
                New tests marked as [ Pass ] for High Sierra+.
            * platform/wk2/TestExpectations:
                New tests skipped for WK2 in general.

2018-01-17  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227075. rdar://problem/36598185

    2018-01-17  Daniel Bates  <dabates@apple.com>

            REGRESSION (r222795): Cardiogram never signs in
            https://bugs.webkit.org/show_bug.cgi?id=181693
            <rdar://problem/36286293>

            Reviewed by Ryosuke Niwa.

            Adds a test to ensure that a file URL can set forbidden XHR headers when the setting
            allowSettingAnyXHRHeaderFromFileURLs is enabled.

            * fast/xmlhttprequest/set-dangerous-headers-from-file-when-setting-enabled-expected.txt: Added.
            * fast/xmlhttprequest/set-dangerous-headers-from-file-when-setting-enabled.html: Added.

2018-01-17  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227074. rdar://problem/36598123

    2018-01-17  Daniel Bates  <dabates@apple.com>

            ASSERTION FAILED: !m_completionHandler in PingHandle::~PingHandle()
            https://bugs.webkit.org/show_bug.cgi?id=181746
            <rdar://problem/36586248>

            Reviewed by Chris Dumez.

            Adds a test to ensure that loading a protected image from a beforeunload handler
            does not cause an assertion failure.

            * http/tests/misc/before-unload-load-image-expected.txt: Added.
            * http/tests/misc/before-unload-load-image.html: Added.
            * http/tests/misc/resources/before-unload-in-subframe-child.html: Added.
            * http/tests/misc/resources/protected/protected-image.php: Added.

2018-01-16  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226916. rdar://problem/36568057

    2018-01-11  Dean Jackson  <dino@apple.com>

            [WebGL] Simulated vertexAttrib0 can sometimes cause OUT_OF_MEMORY errors
            https://bugs.webkit.org/show_bug.cgi?id=181558
            <rdar://problem/36189833>

            Reviewed by Eric Carlson.

            * fast/canvas/webgl/simulated-vertexAttrib0-invalid-indicies-expected.txt: Added.
            * fast/canvas/webgl/simulated-vertexAttrib0-invalid-indicies.html: Added.
            * platform/mac/TestExpectations: Test crashes on Sierra and earlier.

2018-01-16  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r227009. rdar://problem/36567976

    2018-01-16  Jer Noble  <jer.noble@apple.com>

            Reset MediaSourcePrivateAVFObjC's m_sourceBufferWithSelectedVideo when the underlying SourceBufferPrivate is removed.
            https://bugs.webkit.org/show_bug.cgi?id=181707
            <rdar://problem/34809474>

            Reviewed by Eric Carlson.

            * media/media-source/media-source-remove-unload-crash-expected.txt: Added.
            * media/media-source/media-source-remove-unload-crash.html: Added.

2018-01-16  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226993. rdar://problem/36567965

    2018-01-16  Said Abou-Hallawa  <sabouhallawa@apple.com>

            REGRESSION(r221292): svg/animations/animateTransform-pattern-transform.html crashes with security assertion
            https://bugs.webkit.org/show_bug.cgi?id=179986

            Reviewed by Simon Fraser.

            * svg/dom/SVGAnimatedListPropertyTearOff-leak.html:

2018-01-16  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226930. rdar://problem/36567972

    2018-01-12  Myles C. Maxfield  <mmaxfield@apple.com>

            Data URL fonts split in the middle of an alphabet cause random letters to disappear
            https://bugs.webkit.org/show_bug.cgi?id=175845
            <rdar://problem/33996578>

            Reviewed by Brent Fulgham.

            Make sure that the requests for both fonts are sent before either of the responses are received.

            * fast/text/font-load-data-partitioned-alphabet-expected.txt: Added.
            * fast/text/font-load-data-partitioned-alphabet.html: Added.
            * platform/mac-wk1/fast/text/font-load-data-partitioned-alphabet-expected.txt: Added.

2018-01-16  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226908. rdar://problem/36568060

    2018-01-12  Dean Jackson  <dino@apple.com>

            drawElements should be invalid if vertexAttrib0 doesn't have data
            https://bugs.webkit.org/show_bug.cgi?id=181609
            <rdar://problem/36392883>

            Reviewed by Antoine Quint.

            * fast/canvas/webgl/drawElements-empty-vertex-data-expected.txt: Added.
            * fast/canvas/webgl/drawElements-empty-vertex-data.html: Added.

2018-01-16  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226906. rdar://problem/36568006

    2018-01-12  Youenn Fablet  <youenn@apple.com>

            FormDataElement::lengthInBytes should use ThreadableBlobRegistry
            https://bugs.webkit.org/show_bug.cgi?id=181554

            Reviewed by Chris Dumez.

            * http/tests/workers/service/resources/service-worker-cache-api-worker.js:
            (async):
            (event.event.request.url.indexOf): Deleted.
            (event.event.request.url.endsWith): Deleted.
            (event.event.respondWith.promise.then): Deleted.
            * http/tests/workers/service/service-worker-cache-api.https-expected.txt:
            * http/tests/workers/service/service-worker-cache-api.https.html:

2018-01-16  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226904. rdar://problem/36568017

    2018-01-12  Youenn Fablet  <youenn@apple.com>

            WebProcess should pass the registration identifier and not the worker identifier for fetch events
            https://bugs.webkit.org/show_bug.cgi?id=181591

            Reviewed by Chris Dumez.

            * http/wpt/service-workers/resources/empty.html: Added.
            * http/wpt/service-workers/update-service-worker.https-expected.txt: Added.
            * http/wpt/service-workers/update-service-worker.https.html: Added.
            * http/wpt/service-workers/update-worker.py: Added.
            (main):

2018-01-16  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226902. rdar://problem/36567966

    2018-01-11  Simon Fraser  <simon.fraser@apple.com>

            fast/events/ios/rotation/layout-viewport-during-safari-type-rotation.html is flakey
            https://bugs.webkit.org/show_bug.cgi?id=181569
            rdar://problem/34117680

            Reviewed by Zalan Bujtas.

            Wait a tick before starting the rotation, otherwise -[WKWebView _beginAnimatedResizeWithUpdates:]
            can bail because the unobscuredRect is empty.

            Also wait for both the rotation UI script to complete, and the receipt of the
            orientationchange event.

            * fast/events/ios/rotation/layout-viewport-during-safari-type-rotation.html:
            * fast/events/ios/rotation/resources/rotation-utils.js:
            (doTest):

2018-01-16  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226842. rdar://problem/36568025

    2018-01-11  Chris Dumez  <cdumez@apple.com>

            Setting Window.opener to null should disown its opener
            https://bugs.webkit.org/show_bug.cgi?id=181505
            <rdar://problem/36443151>

            Reviewed by Ryosuke Niwa.

            Add layout test coverage.

            * fast/dom/Window/window-opener-set-to-null-expected.txt: Added.
            * fast/dom/Window/window-opener-set-to-null.html: Added.
            * fast/dom/Window/window-opener-shadowing-expected.txt: Added.
            * fast/dom/Window/window-opener-shadowing.html: Added.

2018-01-12  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226745. rdar://problem/36392368

    2018-01-10  Youenn Fablet  <youenn@apple.com>

            Use no-cache fetch mode when loading main documents with location.reload()
            https://bugs.webkit.org/show_bug.cgi?id=181285
            <rdar://problem/36356831>

            Reviewed by Alex Christensen.

            * http/tests/inspector/network/har/har-page-expected.txt:
            * http/tests/inspector/network/har/har-page.html:

2018-01-12  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226825. rdar://problem/36458902

    2018-01-11  James Craig  <jcraig@apple.com>

            AX: when invert colors is on, double-invert video elements in UserAgentStyleSheet
            https://bugs.webkit.org/show_bug.cgi?id=168447
            <rdar://problem/30559874>

            Reviewed by Simon Fraser.

            Double-invert video when platform "invert colors" setting is enabled. Behavior matches
            current "Smart Invert" feature of Safari Reader on macOS/iOS and other iOS native apps.

            * TestExpectations: Platform setting only available on Mac and iOS.
            * accessibility/smart-invert-expected.txt: Added.
            * accessibility/smart-invert-reference-expected.html: Added.
            * accessibility/smart-invert-reference.html: Added. Ref to ensure invert and grayscale filters render as expected.
            * accessibility/smart-invert.html: Added. Computed expectatons of filter property text values.
            * platform/ios-wk2/TestExpectations: Runs on iOS WK2.
            * platform/mac-wk2/TestExpectations: Runs on Mac WK2.

2018-01-12  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226813. rdar://problem/36458922

    2018-01-11  Chris Dumez  <cdumez@apple.com>

            ASSERTION FAILED: registration in WebCore::SWServerWorker::skipWaiting()
            https://bugs.webkit.org/show_bug.cgi?id=181222
            <rdar://problem/36332686>

            Reviewed by Youenn Fablet.

            Unskip test that is no longer flakily crashing.

            * TestExpectations:

2018-01-12  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226792. rdar://problem/36450742

    2018-01-11  Youenn Fablet  <youenn@apple.com>

            Redirected iframe loading with Request.redirect=follow should fail
            https://bugs.webkit.org/show_bug.cgi?id=181491

            Reviewed by Alex Christensen.

            * TestExpectations:

2018-01-12  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226785. rdar://problem/36450812

    2018-01-11  Eric Carlson  <eric.carlson@apple.com>

            Layout Test media/event-queue-crash.html is flaky
            https://bugs.webkit.org/show_bug.cgi?id=180493
            <rdar://problem/35914377>

            Reviewed by Jer Noble.

            * TestExpectations: Add DumpJSConsoleLogInStdErr.
            * media/event-queue-crash.html: Increase the timeout from 10ms to 100ms.

2018-01-12  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226771. rdar://problem/36450734

    2018-01-11  Youenn Fablet  <youenn@apple.com>

            LayoutTests/http/tests/workers/service/resources/service-worker-importScript.js does not need to register two service workers
            https://bugs.webkit.org/show_bug.cgi?id=181490

            Reviewed by Chris Dumez.

            * http/tests/workers/service/resources/service-worker-importScript.js:
            * http/tests/workers/service/service-worker-importScript-expected.txt:
            * platform/mac-wk2/TestExpectations:

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226731. rdar://problem/36450734

    2018-01-10  Matt Lewis  <jlewis3@apple.com>

            Marked http/tests/workers/service/service-worker-importScript.html as flaky on macOS WK2.
            https://bugs.webkit.org/show_bug.cgi?id=181097

            Unreviewed test gardening.

            * platform/mac-wk2/TestExpectations:

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226818. rdar://problem/36458899

    2018-01-11  Alex Christensen  <achristensen@webkit.org>

            REGRESSION(r225003): Loading hangs in environments where dispatch_async does not work
            https://bugs.webkit.org/show_bug.cgi?id=181553

            Reviewed by Eric Carlson.

            * media/video-src-remove.html:

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226804. rdar://problem/36450810

    2018-01-11  Youenn Fablet  <youenn@apple.com>

            RTCController should disable ICE candidate filtering in case of getUserMedia based on the RTCPerrConnection origin
            https://bugs.webkit.org/show_bug.cgi?id=180851

            Reviewed by Eric Carlson.

            * http/wpt/webrtc/resources/third-party-frame-ice-candidate-filtering-iframe.html: Added.
            * http/wpt/webrtc/third-party-frame-ice-candidate-filtering-expected.txt: Added.
            * http/wpt/webrtc/third-party-frame-ice-candidate-filtering.html: Added.

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226798. rdar://problem/36450812

    2018-01-11  Matt Lewis  <jlewis3@apple.com>

            Rebaseline of media/event-queue-crash.html after r226785

            Unreviewed test gardening.

            * media/event-queue-crash-expected.txt:

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226796. rdar://problem/36450730

    2018-01-11  Antoine Quint  <graouts@apple.com>

            Only listen to webkitplaybacktargetavailabilitychanged when media controls are visible to the user
            https://bugs.webkit.org/show_bug.cgi?id=181547
            <rdar://problem/35947650>

            Reviewed by Eric Carlson.

            Add a test that checks that enabling AirPlay routes when the controls are not visible to the user
            does not incur any change, and that making the controls visible again shows the controls in the
            expected state.

            * media/modern-media-controls/airplay-support/airplay-support-disable-event-listeners-with-hidden-controls-expected.txt: Added.
            * media/modern-media-controls/airplay-support/airplay-support-disable-event-listeners-with-hidden-controls.html: Added.

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226795. rdar://problem/36450750

    2018-01-11  Antoine Quint  <graouts@apple.com>

            [iOS] There should be no controls markup generated in fullscreen
            https://bugs.webkit.org/show_bug.cgi?id=181540
            <rdar://problem/35060379>

            Reviewed by Eric Carlson.

            We update this test to simply check that we're removing all child nodes.

            * media/modern-media-controls/media-controller/ios/media-controller-stop-updates-in-fullscreen-expected.txt:
            * media/modern-media-controls/media-controller/ios/media-controller-stop-updates-in-fullscreen.html:

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226791. rdar://problem/36450803

    2018-01-10  Simon Fraser  <simon.fraser@apple.com>

            On macOS, getBoundingClientRect gives incorrect values when pinch-zoomed
            https://bugs.webkit.org/show_bug.cgi?id=181511
            rdar://problem/33741427

            Reviewed by Zalan Bujtas.

            New results in tests that get client coordinates after zooming.

            * fast/visual-viewport/client-coordinates-relative-to-layout-viewport-expected.txt:
            * fast/visual-viewport/client-rects-relative-to-layout-viewport-expected.txt:
            * fast/visual-viewport/client-rects-relative-to-layout-viewport-zoomed.html:
            * fast/visual-viewport/zoomed-fixed-expected.txt:
            * fast/visual-viewport/zoomed-fixed-header-and-footer-expected.txt:
            * fast/zooming/client-rect-in-fixed-zoomed-expected.txt:
            * fast/zooming/client-rect-in-fixed-zoomed.html: Change the test to create passing results.

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226766. rdar://problem/36459143

    2018-01-10  Andy Estes  <aestes@apple.com>

            [Payment Request] Rename ApplePayMerchantValidationEvent to MerchantValidationEvent
            https://bugs.webkit.org/show_bug.cgi?id=181437
            <rdar://problem/36376481>

            Reviewed by Tim Horton.

            * http/tests/paymentrequest/payment-request-change-shipping-address.https.html:
            * http/tests/paymentrequest/payment-request-change-shipping-option.https.html:
            * http/tests/paymentrequest/payment-request-merchant-validation.https-expected.txt: Added.
            * http/tests/paymentrequest/payment-request-merchant-validation.https.html: Added.
            * http/tests/paymentrequest/resources/helpers.js:
            (async.getPaymentRequestResponse):
            * http/tests/paymentrequest/updateWith-method-pmi-handling.https.html:
            * http/tests/ssl/applepay/ApplePayMerchantValidationEvent.https-expected.txt: Removed.
            * http/tests/ssl/applepay/ApplePayMerchantValidationEvent.https.html: Removed.

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226646. rdar://problem/36429142

    2018-01-09  Youenn Fablet  <youenn@apple.com>

            [iOS Debug WK2] Layout Test imported/w3c/web-platform-tests/service-workers/service-worker/register-closed-window.https.html is flaky
            https://bugs.webkit.org/show_bug.cgi?id=181087
            <rdar://problem/36188109>

            Reviewed by Chris Dumez.

            * platform/ios-wk2/TestExpectations: Removed flaky expectation.

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226755. rdar://problem/36429123

    2018-01-10  Matt Baker  <mattbaker@apple.com>

            Web Inspector: Canvas tab: throttle recording slider updates
            https://bugs.webkit.org/show_bug.cgi?id=180839
            <rdar://problem/36057849>

            Reviewed by Joseph Pecoraro

            * inspector/unit-tests/throttle-expected.txt: Added.
            * inspector/unit-tests/throttle.html: Added.
            Added function throttling tests.

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226753. rdar://problem/36429138

    2018-01-10  Wenson Hsieh  <wenson_hsieh@apple.com>

            REGRESSION(r222507): Composition highlight doesn't render when using IME
            https://bugs.webkit.org/show_bug.cgi?id=181485
            <rdar://problem/35896516>

            Reviewed by Ryosuke Niwa.

            Add a new layout test to ensure that in the absence of custom composition underlines, a marked composition
            string appears different once it is confirmed.

            * editing/marked-text-appearance-expected-mismatch.html: Added.
            * editing/marked-text-appearance.html: Added.

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226750. rdar://problem/36429156

    2018-01-10  Tim Horton  <timothy_horton@apple.com>

            REGRESSION (r213590): Swipe from edge to go to previous page is significantly slower than tapping back button on Twitter
            https://bugs.webkit.org/show_bug.cgi?id=181269
            <rdar://problem/35110344>

            Reviewed by Simon Fraser.

            * swipe/pushstate-with-manual-scrollrestoration-expected.txt: Added.
            * swipe/pushstate-with-manual-scrollrestoration.html: Added.
            Add a test (which previously would complain about taking too long)
            that using manual scroll position restoration and pushState together
            doesn't cause swipes to hang until the watchdog fires.

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226677. rdar://problem/36429157

    2018-01-09  Chris Dumez  <cdumez@apple.com>

            Make service workers behave correctly with regards to Page Cache
            https://bugs.webkit.org/show_bug.cgi?id=181446
            <rdar://problem/36164291>

            Reviewed by Youenn Fablet.

            Add layout test coverage.

            * http/tests/workers/service/client-added-to-clients-when-restored-from-page-cache-expected.txt: Added.
            * http/tests/workers/service/client-added-to-clients-when-restored-from-page-cache.html: Added.
            * http/tests/workers/service/client-removed-from-clients-while-in-page-cache-expected.txt: Added.
            * http/tests/workers/service/client-removed-from-clients-while-in-page-cache.html: Added.
            * http/tests/workers/service/no-page-cache-when-controlled-expected.txt: Added.
            * http/tests/workers/service/no-page-cache-when-controlled.html: Added.
            * http/tests/workers/service/other_resources/test.html: Added.
            * http/tests/workers/service/resources/getClientCount-worker.js: Added.
            (event.then):

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226668. rdar://problem/36429139

    2018-01-09  Myles C. Maxfield  <mmaxfield@apple.com>

            font-display:fallback can cause a visual flash (which is supposed to be impossible)
            https://bugs.webkit.org/show_bug.cgi?id=181374

            Reviewed by Simon Fraser.

            Move font-display tests into their common subfolder.

            * fast/text/font-display/block-finish-expected.html: Renamed from LayoutTests/fast/text/loading-block-finish-expected.html.
            * fast/text/font-display/block-finish.html: Renamed from LayoutTests/fast/text/loading-block-finish.html.
            * fast/text/font-display/block-nofinish-expected.html: Renamed from LayoutTests/fast/text/loading-block-nofinish-expected.html.
            * fast/text/font-display/block-nofinish.html: Renamed from LayoutTests/fast/text/loading-block-nofinish.html.
            * fast/text/font-display/failure-finish-expected.html: Renamed from LayoutTests/fast/text/loading-failure-finish-expected.html.
            * fast/text/font-display/failure-finish.html: Renamed from LayoutTests/fast/text/loading-failure-finish.html.
            * fast/text/font-display/failure-nofinish-expected.html: Renamed from LayoutTests/fast/text/loading-failure-nofinish-expected.html.
            * fast/text/font-display/failure-nofinish.html: Renamed from LayoutTests/fast/text/loading-failure-nofinish.html.
            * fast/text/font-display/swap-finish-expected.html: Renamed from LayoutTests/fast/text/loading-swap-finish-expected.html.
            * fast/text/font-display/swap-finish.html: Renamed from LayoutTests/fast/text/loading-swap-finish.html.
            * fast/text/font-display/swap-nofinish-expected.html: Renamed from LayoutTests/fast/text/loading-swap-nofinish-expected.html.
            * fast/text/font-display/swap-nofinish.html: Renamed from LayoutTests/fast/text/loading-swap-nofinish.html.
            * fast/text/font-display/swap-flash-expected.html: Added.
            * fast/text/font-display/swap-flash.html: Added.
            * platform/win/TestExpectations:

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226653. rdar://problem/36429147

    2018-01-09  Antti Koivisto  <antti@apple.com>

            Blank page except for inner iframes because pending stylesheets cause style.isNotFinal() to be true
            https://bugs.webkit.org/show_bug.cgi?id=180940
            <rdar://problem/36116507>

            Reviewed by Darin Adler.

            * http/tests/local/loading-stylesheet-import-remove.html: Added.
            * http/tests/local/loading-stylesheet-import-remove-expected.html: Added.
            * http/tests/local/resources/slow-import.css: Added.

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226599. rdar://problem/36429130

    2018-01-08  Said Abou-Hallawa  <sabouhallawa@apple.com>

            A canvas should not be tainted if it draws a data URL SVGImage with a <foreignObject>
            https://bugs.webkit.org/show_bug.cgi?id=180301

            Reviewed by Dean Jackson.

            * svg/as-image/svg-canvas-data-url-svg-with-feimage-not-tainted-expected.txt: Added.
            * svg/as-image/svg-canvas-data-url-svg-with-feimage-not-tainted.html: Added.
            * svg/as-image/svg-canvas-data-url-svg-with-foreign-object-not-tainted-expected.txt: Added.
            * svg/as-image/svg-canvas-data-url-svg-with-foreign-object-not-tainted.html: Added.
            * svg/as-image/svg-canvas-data-url-svg-with-image-not-tainted-expected.txt: Added.
            * svg/as-image/svg-canvas-data-url-svg-with-image-not-tainted.html: Added.

2018-01-11  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226527. rdar://problem/36429143

    2018-01-08  Basuke Suzuki  <Basuke.Suzuki@sony.com>

            [WinCairo] Add default port TestExpectations for wincairo
            https://bugs.webkit.org/show_bug.cgi?id=179221

            Reviewed by Alex Christensen.

            * platform/wincairo-win10/TestExpectations: Added.

2018-01-09  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226638. rdar://problem/36392286

    2018-01-09  Said Abou-Hallawa  <sabouhallawa@apple.com>

            Check Image::m_image is not null in ImageLoader::decode()
            https://bugs.webkit.org/show_bug.cgi?id=180386
            <rdar://problem/34634483>

            Reviewed by Tim Horton.

            Add a new rejected case for decoding an image with an invalid URL.

            * fast/images/decode-static-image-reject-expected.txt:
            * fast/images/decode-static-image-reject.html:

2018-01-09  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226617. rdar://problem/36392336

    2018-01-09  Ryosuke Niwa  <rniwa@webkit.org>

            Release assert in addResourceTiming when a cache resource is requested during style recalc
            https://bugs.webkit.org/show_bug.cgi?id=181137
            <rdar://problem/35666574>

            Reviewed by Simon Fraser.

            Added a regression test for the crash.

            Also fixed test cases in rt-performance-extensions.js which were incorrectly asserting and assuming that
            resourcetimingbufferfull event will be fired when there are exactly the same number of entries as the buffer size.

            * http/tests/performance/performance-resource-timing-resourcetimingbufferfull -crash-expected.txt: Added.
            * http/tests/performance/performance-resource-timing-resourcetimingbufferfull-crash.html: Added.
            * http/wpt/resource-timing/rt-performance-extensions.js: Fixed the test cases.

2018-01-09  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226526. rdar://problem/36392384

    2018-01-08  Youenn Fablet  <youenn@apple.com>

            Stop exposing fetch and extendable events to window
            https://bugs.webkit.org/show_bug.cgi?id=181325

            Reviewed by Chris Dumez.

            * http/wpt/service-workers/extendableEvent.https-expected.txt:
            * http/wpt/service-workers/extendableEvent.https.html:
            * http/wpt/service-workers/fetchEvent.https-expected.txt:
            * http/wpt/service-workers/fetchEvent.https.html:

2018-01-09  Jason Marcell  <jmarcell@apple.com>

        Cherry-pick r226521. rdar://problem/36392339

    2018-01-08  Antti Koivisto  <antti@apple.com>

            REGRESSION (r219145): Toggling layer borders on a static document no longer works immediately
            https://bugs.webkit.org/show_bug.cgi?id=176260
            <rdar://problem/34219966>

            Reviewed by Simon Fraser.

            * compositing/debug-borders-dynamic-expected.html: Added.
            * compositing/debug-borders-dynamic.html: Added.

2018-01-09  Jason Marcell  <jmarcell@apple.com>

        Revert r226432. rdar://problem/10353542

2018-01-08  Ms2ger  <Ms2ger@igalia.com>

        Update imagebitmap tests.
        https://bugs.webkit.org/show_bug.cgi?id=181379

        Unreviewed test gardening.

        * platform/gtk/imported/w3c/web-platform-tests/2dcontext/imagebitmap/createImageBitmap-drawImage-expected.txt:
        * platform/gtk/imported/w3c/web-platform-tests/2dcontext/imagebitmap/createImageBitmap-invalid-args-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/2dcontext/imagebitmap/createImageBitmap-drawImage-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/2dcontext/imagebitmap/createImageBitmap-invalid-args-expected.txt:

2018-01-08  Youenn Fablet  <youenn@apple.com>

        navigator.onLine does not work inside service workers
        https://bugs.webkit.org/show_bug.cgi?id=181079
        <rdar://problem/36178606>

        Reviewed by Darin Adler.

        * http/wpt/service-workers/online-worker.js: Added.
        (async.waitForOnlineEvent):
        (async.doTest):
        * http/wpt/service-workers/online.https-expected.txt: Added.
        * http/wpt/service-workers/online.https.html: Added.

2018-01-08  Youenn Fablet  <youenn@apple.com>

        imported/w3c/web-platform-tests/service-workers/service-worker/interfaces-sw.https.html is slow in Debug
        https://bugs.webkit.org/show_bug.cgi?id=181382

        Unreviewed.

        * TestExpectations:

2018-01-08  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK gardening. Rebaseline test again after r226500.

        * platform/gtk/imported/w3c/web-platform-tests/2dcontext/imagebitmap/createImageBitmap-invalid-args-expected.txt:

2018-01-08  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK gardening. Partially revert r224460.

        Two tests were incorrectly rebaselined in r224460.

        * platform/gtk/fast/forms/auto-fill-button/input-strong-confirmation-password-auto-fill-button-expected.txt:
        * platform/gtk/fast/forms/auto-fill-button/input-strong-password-auto-fill-button-expected.txt:

2018-01-07  Ms2ger  <Ms2ger@igalia.com>

        Implement createImageBitmap(ImageBitmap)
        https://bugs.webkit.org/show_bug.cgi?id=181287

        Reviewed by Darin Adler.

        * platform/gtk/imported/w3c/web-platform-tests/2dcontext/imagebitmap/createImageBitmap-drawImage-expected.txt: rebaseline.
        * platform/gtk/imported/w3c/web-platform-tests/2dcontext/imagebitmap/createImageBitmap-invalid-args-expected.txt: rebaseline.
        * platform/wpe/imported/w3c/web-platform-tests/2dcontext/imagebitmap/createImageBitmap-drawImage-expected.txt: rebaseline.
        * platform/wpe/imported/w3c/web-platform-tests/2dcontext/imagebitmap/createImageBitmap-invalid-args-expected.txt: rebaseline.

2018-01-07  Ryosuke Niwa  <rniwa@webkit.org>

        Reduce the precision of "high" resolution time to 1ms
        https://bugs.webkit.org/show_bug.cgi?id=180910
        <rdar://problem/36085943>

        Reviewed by Saam Barati.

        Add a flaky test expectation to imported/w3c/web-platform-tests/workers/worker-performance.worker.html
        due to a test bug. The test fix is tracked in https://github.com/w3c/web-platform-tests/pull/8711

        * TestExpectations:

2018-01-06  Simon Fraser  <simon.fraser@apple.com>

        Possible crash computing event regions
        https://bugs.webkit.org/show_bug.cgi?id=181368
        rdar://problem/34847081

        Reviewed by Zalan Bujtas.

        * fast/events/event-handler-regions-layout-expected.txt: Added.
        * fast/events/event-handler-regions-layout.html: Added.

2018-01-06  Simon Fraser  <simon.fraser@apple.com>

        Crash under RenderLayer::scrollTo() with marquee
        https://bugs.webkit.org/show_bug.cgi?id=181349
        rdar://problem/36190168

        Reviewed by Zalan Bujtas.

        * fast/scrolling/marquee-scroll-crash-expected.txt: Added.
        * fast/scrolling/marquee-scroll-crash.html: Added.

2018-01-05  Dean Jackson  <dino@apple.com>

        Accurately clip copyTexImage2D and copyTexSubImage2D
        https://bugs.webkit.org/show_bug.cgi?id=181356
        <rdar://problem/35083877>

        Reviewed by Eric Carlson.

        * fast/canvas/webgl/copy-tex-image-and-sub-image-2d-bad-input-expected.txt: Added.
        * fast/canvas/webgl/copy-tex-image-and-sub-image-2d-bad-input.html: Added.

2018-01-06  Yusuke Suzuki  <utatane.tea@gmail.com>

        Object.getOwnPropertyNames includes "arguments" and "caller" for bound functions
        https://bugs.webkit.org/show_bug.cgi?id=181321

        Reviewed by Saam Barati.

        * inspector/model/remote-object-get-properties-expected.txt:
        * inspector/runtime/getProperties-expected.txt:
        * js/script-tests/strict-throw-type-error.js:
        * js/strict-throw-type-error-expected.txt:

2018-01-05  Youenn Fablet  <youenn@apple.com>

        Implement Cache API partitioning based on ClientOrigin
        https://bugs.webkit.org/show_bug.cgi?id=181240

        Reviewed by Alex Christensen.

        Beefing up test to ensure that client and top origins are taken into consideration.

        * http/tests/cache-storage/cache-origins.https-expected.txt:
        * http/tests/cache-storage/cache-origins.https.html:
        * http/tests/cache-storage/cache-clearing-origin.https-expected.txt:
        * http/tests/cache-storage/cache-clearing-origin.https.html:

2017-12-21  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/workers/worker-terminate.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=181098

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2018-01-05  Per Arne Vollan  <pvollan@apple.com>

        Mark mathml/opentype/horizontal-munderover.html as failure on Windows.
        https://bugs.webkit.org/show_bug.cgi?id=181346

        Unreviewed test gardening.

        * platform/win/TestExpectations:

2018-01-05  Youenn Fablet  <youenn@apple.com>

        Skip LayoutTests/imported/w3c/web-platform-tests/service-workers/service-worker/claim-shared-worker-fetch.https.html
        https://bugs.webkit.org/show_bug.cgi?id=181329

        Unreviewed.
        SharedWorker is not supported.

        * TestExpectations:

2018-01-05  Matt Lewis  <jlewis3@apple.com>

        Marked fast/mediastream/MediaStream-MediaElement-setObject-null.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=181069

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2018-01-05  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r226401.

        This caused timeouts on multiple platforms.

        Reverted changeset:

        "Implement Cache API partitioning based on ClientOrigin"
        https://bugs.webkit.org/show_bug.cgi?id=181240
        https://trac.webkit.org/changeset/226401

2018-01-05  Joseph Pecoraro  <pecoraro@apple.com>

        ServiceWorkers: Enable UserTiming / ResourceTiming
        https://bugs.webkit.org/show_bug.cgi?id=181297
        <rdar://problem/36307306>

        Reviewed by Youenn Fablet.

        * http/tests/workers/service/resources/data1.txt: Added.
        * http/tests/workers/service/resources/data2.txt: Added.
        Resources to load from a service-worker.

        * http/tests/workers/service/resources/service-worker-resource-timing.js: Added.
        * http/tests/workers/service/service-worker-resource-timing.https-expected.txt: Added.
        * http/tests/workers/service/service-worker-resource-timing.https.html: Added.
        Test that a ServiceWorker can produce resource entries for a few
        different kinds of loads (CacheStorage load, and a fetch).

        * http/tests/workers/service/resources/service-worker-user-timing.js: Added.
        * http/tests/workers/service/service-worker-user-timing.https-expected.txt: Added.
        * http/tests/workers/service/service-worker-user-timing.https.html: Added.
        Test that a ServiceWorker can produce a mark/measure entries.

2018-01-05  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE][GTK] Unreviewed gardening

        Unskip svg/hittest/svg-shapes-non-scale-stroke.html, passing after
        r226443.
        * platform/gtk/TestExpectations:
        * platform/wpe/TestExpectations:

2018-01-05  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Unreviewed gardening

        * platform/wpe/TestExpectations: Unskip two tests passing after r226404.

2018-01-05  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Rebaseline test expectations after r226404

        Unreviewed gardening.

        * platform/wpe/css1/font_properties/font_size-expected.txt:
        * platform/wpe/css1/text_properties/letter_spacing-expected.txt:
        * platform/wpe/css1/text_properties/line_height-expected.txt:
        * platform/wpe/css1/text_properties/text_indent-expected.txt:
        * platform/wpe/css1/text_properties/word_spacing-expected.txt:
        * platform/wpe/css1/units/length_units-expected.txt:
        * platform/wpe/css2.1/t040302-c61-ex-len-00-b-a-expected.txt:
        * platform/wpe/css2.1/t040302-c61-rel-len-00-b-ag-expected.txt:
        * platform/wpe/css2.1/t1008-c44-ln-box-02-d-ag-expected.txt:
        * platform/wpe/css2.1/t100801-c544-valgn-01-d-ag-expected.txt:
        * platform/wpe/css2.1/t100801-c544-valgn-03-d-agi-expected.txt:
        * platform/wpe/css2.1/t100801-c548-ln-ht-02-b-ag-expected.txt:
        * platform/wpe/css2.1/t1507-c526-font-sz-02-b-a-expected.txt:
        * platform/wpe/css2.1/t1601-c547-indent-00-b-a-expected.txt:
        * platform/wpe/css2.1/t1604-c542-letter-sp-00-b-a-expected.txt:
        * platform/wpe/svg/W3C-SVG-1.1-SE/coords-units-03-b-expected.txt:
        * platform/wpe/svg/W3C-SVG-1.1/coords-units-03-b-expected.txt:
        * platform/wpe/svg/custom/alignment-baseline-modes-expected.txt:
        * platform/wpe/svg/custom/dominant-baseline-modes-expected.txt:
        * platform/wpe/tables/mozilla/bugs/bug55527-expected.txt:

2018-01-05  Fujii Hironori  <Hironori.Fujii@sony.com>

        [Cairo] Canvas: Path::clear should clear its transform
        https://bugs.webkit.org/show_bug.cgi?id=181320

        Reviewed by Carlos Garcia Campos.

        * fast/canvas/reset-scaling-by-height-change-expected.txt: Added.
        * fast/canvas/reset-scaling-by-height-change.html: Added.

2018-01-04  Joseph Pecoraro  <pecoraro@apple.com>

        REGRESSION (r225709): Web Inspector: CSS Source maps not loading
        https://bugs.webkit.org/show_bug.cgi?id=181314
        <rdar://problem/36177620>

        Reviewed by Brian Burg.

        * http/tests/inspector/network/resources/script-with-sourcemap.js: Added.
        * http/tests/inspector/network/resources/script-with-sourcemap.js.map: Added.
        * http/tests/inspector/network/resources/stylesheet-with-sourcemap.css: Added.
        * http/tests/inspector/network/resources/stylesheet-with-sourcemap.css.map: Added.
        * http/tests/inspector/network/resources/stylesheet-with-sourcemap.scss: Added.
        Add a real script minified with a source map.
        Add a real scss stylesheet compiled to css with a source map.

        * http/tests/inspector/network/source-map-loads-expected.txt: Added.
        * http/tests/inspector/network/source-map-loads.html: Added.
        Test that we load source maps for resources with sourceMappingURL directives.

2018-01-04  Chris Fleizach  <cfleizach@apple.com>

        AX: Implement updated CSS3 Speech for 'speak' and 'speak-as' properties
        https://bugs.webkit.org/show_bug.cgi?id=180361

        Reviewed by Zalan Bujtas.

        * accessibility/mac/css-speech-speak-expected.txt:
        * accessibility/mac/css-speech-speak.html:
        * fast/css/getComputedStyle/computed-style-expected.txt:
        * fast/css/getComputedStyle/computed-style-without-renderer-expected.txt:
        * platform/ios/fast/css/getComputedStyle/computed-style-expected.txt:
        * platform/ios/fast/css/getComputedStyle/computed-style-without-renderer-expected.txt:
        * platform/mac-sierra/fast/css/getComputedStyle/computed-style-expected.txt:
        * platform/mac-sierra/fast/css/getComputedStyle/computed-style-without-renderer-expected.txt:
        * platform/mac-sierra/svg/css/getComputedStyle-basic-expected.txt:
        * platform/mac/fast/css/getComputedStyle/computed-style-expected.txt:
        * platform/mac/fast/css/getComputedStyle/computed-style-without-renderer-expected.txt:
        * platform/mac/svg/css/getComputedStyle-basic-expected.txt:
        * svg/css/getComputedStyle-basic-expected.txt:

2018-01-04  Brian Burg  <bburg@apple.com>

        Web Inspector: Capture Element Screenshot looks fuzzy
        https://bugs.webkit.org/show_bug.cgi?id=175734
        <rdar://problem/33803377>

        Reviewed by Joseph Pecoraro and Simon Fraser.

        * inspector/page/hidpi-snapshot-size-expected.txt: Added.
        * inspector/page/hidpi-snapshot-size.html: Added.

2018-01-04  Brian Burg  <bburg@apple.com>

        Web Inspector: add RemoteObject.fetchProperties and some basic tests for RemoteObject API
        https://bugs.webkit.org/show_bug.cgi?id=180945

        Reviewed by Joseph Pecoraro.

        Add new test coverage for existing RemoteObject.prototype.getProperty.
        Add new test coverage for new method RemoteObject.prototype.fetchProperties.
        I didn't add test coverage for callFunction, as I had to stop somewhere.

        * inspector/model/remote-object-api-expected.txt: Added.
        * inspector/model/remote-object-api.html: Added.

2018-01-04  Brian Burg  <bburg@apple.com>

        Web Inspector: add TestPage.debug() to inspect evaluations being sent to Inspector page
        https://bugs.webkit.org/show_bug.cgi?id=181005

        Rubber-stamped by Joseph Pecoraro.

        When TestPage.debug() is called, dump out all code that is sent to be evaluated in
        the inspector page. This is useful for debugging initialization and InspectorTest.awaitEvent.

        * http/tests/inspector/resources/inspector-test.js:
        (runTest):
        (TestPage.debug):
        (TestPage.evaluateInWebInspector):
        (TestPage.dispatchEventToFrontend):

        * http/tests/inspector/network/har/har-page-expected.txt:
        Rebaseline, as this depends on the size of inspector-test.js. Removing this
        fragile test expectation behavior is tracked by https://bugs.webkit.org/show_bug.cgi?id=181300.


2018-01-04  Zalan Bujtas  <zalan@apple.com>

        WebContent process crashes while loading https://www.classicspecs.com
        https://bugs.webkit.org/show_bug.cgi?id=181290
        <rdar://problem/36225906>

        Reviewed by Simon Fraser.

        * fast/block/float/crash-when-intruding-float-has-anonymous-parent-and-detach-expected.txt: Added.
        * fast/block/float/crash-when-intruding-float-has-anonymous-parent-and-detach.html: Added.

2018-01-04  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] Add Mock screen capture source
        https://bugs.webkit.org/show_bug.cgi?id=181291
        <rdar://problem/36298164>

        Reviewed by Dean Jackson.

        * http/tests/media/media-stream/get-display-media-prompt-expected.txt: Added.
        * http/tests/media/media-stream/get-display-media-prompt.html: Added.

2018-01-04  John Wilander  <wilander@apple.com>

        Storage Access API: Remove JavaScript confirm() prompt from Document::requestStorageAccess()
        https://bugs.webkit.org/show_bug.cgi?id=181276
        <rdar://problem/36290463>

        Reviewed by Alex Christensen.

        Two test cases are deleted since the user has no way
        to deny access through a prompt anymore. The rest
        are updated to not expect a "CONFIRM:..." text output.

        * http/tests/storageAccess/request-and-deny-storage-access-cross-origin-iframe-expected.txt: Removed.
        * http/tests/storageAccess/request-and-deny-storage-access-cross-origin-iframe.html: Removed.
        * http/tests/storageAccess/request-and-deny-storage-access-cross-origin-sandboxed-iframe-expected.txt: Removed.
        * http/tests/storageAccess/request-and-deny-storage-access-cross-origin-sandboxed-iframe.html: Removed.
        * http/tests/storageAccess/request-and-grant-access-then-detach-should-not-have-access-expected.txt:
        * http/tests/storageAccess/request-and-grant-access-then-navigate-should-not-have-access-expected.txt:
        * http/tests/storageAccess/request-and-grant-storage-access-cross-origin-non-sandboxed-iframe-expected.txt:
        * http/tests/storageAccess/request-and-grant-storage-access-cross-origin-sandboxed-iframe-expected.txt:
        * http/tests/storageAccess/request-and-grant-storage-access-cross-origin-sandboxed-iframe-from-prevalent-domain-with-non-recent-user-interaction-and-try-access-from-right-frame-expected.txt:
        * http/tests/storageAccess/request-and-grant-storage-access-cross-origin-sandboxed-iframe-from-prevalent-domain-with-non-recent-user-interaction-but-try-access-from-wrong-frame-expected.txt:
        * http/tests/storageAccess/request-and-grant-storage-access-cross-origin-sandboxed-iframe-from-prevalent-domain-with-recent-user-interaction-expected.txt:
        * http/tests/storageAccess/request-and-grant-storage-access-cross-origin-sandboxed-iframe-from-prevalent-domain-without-user-interaction-expected.txt:
        * platform/mac-wk2/TestExpectations:
            Removed entries for the deleted test cases.

2018-01-04  Carlos Garcia Campos  <cgarcia@igalia.com>

        [GTK] Issues with Ahem's ex / x-height
        https://bugs.webkit.org/show_bug.cgi?id=180581

        Reviewed by Michael Catanzaro.

        Unskip two tests that are now passing and rebaseline others.

        * platform/gtk/TestExpectations:
        * platform/gtk/css1/font_properties/font_size-expected.png:
        * platform/gtk/css1/font_properties/font_size-expected.txt:
        * platform/gtk/css1/text_properties/letter_spacing-expected.png:
        * platform/gtk/css1/text_properties/letter_spacing-expected.txt:
        * platform/gtk/css1/text_properties/line_height-expected.png:
        * platform/gtk/css1/text_properties/line_height-expected.txt:
        * platform/gtk/css1/text_properties/text_indent-expected.png:
        * platform/gtk/css1/text_properties/text_indent-expected.txt:
        * platform/gtk/css1/text_properties/word_spacing-expected.png:
        * platform/gtk/css1/text_properties/word_spacing-expected.txt:
        * platform/gtk/css1/units/length_units-expected.png:
        * platform/gtk/css1/units/length_units-expected.txt:
        * platform/gtk/css2.1/t040302-c61-ex-len-00-b-a-expected.png:
        * platform/gtk/css2.1/t040302-c61-ex-len-00-b-a-expected.txt:
        * platform/gtk/css2.1/t040302-c61-rel-len-00-b-ag-expected.png:
        * platform/gtk/css2.1/t040302-c61-rel-len-00-b-ag-expected.txt:
        * platform/gtk/css2.1/t1008-c44-ln-box-02-d-ag-expected.png:
        * platform/gtk/css2.1/t1008-c44-ln-box-02-d-ag-expected.txt:
        * platform/gtk/css2.1/t100801-c544-valgn-01-d-ag-expected.png:
        * platform/gtk/css2.1/t100801-c544-valgn-01-d-ag-expected.txt:
        * platform/gtk/css2.1/t100801-c544-valgn-03-d-agi-expected.png:
        * platform/gtk/css2.1/t100801-c544-valgn-03-d-agi-expected.txt:
        * platform/gtk/css2.1/t100801-c548-ln-ht-02-b-ag-expected.png:
        * platform/gtk/css2.1/t100801-c548-ln-ht-02-b-ag-expected.txt:
        * platform/gtk/css2.1/t1507-c526-font-sz-02-b-a-expected.png:
        * platform/gtk/css2.1/t1507-c526-font-sz-02-b-a-expected.txt:
        * platform/gtk/css2.1/t1601-c547-indent-00-b-a-expected.png:
        * platform/gtk/css2.1/t1601-c547-indent-00-b-a-expected.txt:
        * platform/gtk/css2.1/t1604-c542-letter-sp-00-b-a-expected.png:
        * platform/gtk/css2.1/t1604-c542-letter-sp-00-b-a-expected.txt:
        * platform/gtk/editing/selection/caret-ltr-2-expected.png:
        * platform/gtk/editing/selection/caret-ltr-2-expected.txt:
        * platform/gtk/editing/selection/caret-ltr-2-left-expected.png:
        * platform/gtk/editing/selection/caret-ltr-2-left-expected.txt:
        * platform/gtk/editing/selection/caret-ltr-expected.png:
        * platform/gtk/editing/selection/caret-ltr-expected.txt:
        * platform/gtk/editing/selection/caret-ltr-right-expected.png:
        * platform/gtk/editing/selection/caret-ltr-right-expected.txt:
        * platform/gtk/editing/selection/caret-rtl-2-expected.png:
        * platform/gtk/editing/selection/caret-rtl-2-expected.txt:
        * platform/gtk/editing/selection/caret-rtl-2-left-expected.png:
        * platform/gtk/editing/selection/caret-rtl-2-left-expected.txt:
        * platform/gtk/editing/selection/caret-rtl-expected.png:
        * platform/gtk/editing/selection/caret-rtl-expected.txt:
        * platform/gtk/editing/selection/caret-rtl-right-expected.png:
        * platform/gtk/editing/selection/caret-rtl-right-expected.txt:
        * platform/gtk/editing/selection/select-across-readonly-input-1-expected.png:
        * platform/gtk/editing/selection/select-across-readonly-input-1-expected.txt:
        * platform/gtk/editing/selection/select-across-readonly-input-2-expected.png:
        * platform/gtk/editing/selection/select-across-readonly-input-2-expected.txt:
        * platform/gtk/editing/selection/select-across-readonly-input-3-expected.png:
        * platform/gtk/editing/selection/select-across-readonly-input-3-expected.txt:
        * platform/gtk/editing/selection/select-across-readonly-input-4-expected.png:
        * platform/gtk/editing/selection/select-across-readonly-input-4-expected.txt:
        * platform/gtk/editing/selection/select-across-readonly-input-5-expected.png:
        * platform/gtk/editing/selection/select-across-readonly-input-5-expected.txt:
        * platform/gtk/editing/selection/vertical-lr-ltr-extend-line-backward-br-expected.png:
        * platform/gtk/editing/selection/vertical-lr-ltr-extend-line-backward-br-expected.txt:
        * platform/gtk/editing/selection/vertical-lr-ltr-extend-line-forward-br-expected.png:
        * platform/gtk/editing/selection/vertical-lr-ltr-extend-line-forward-br-expected.txt:
        * platform/gtk/editing/selection/vertical-rl-ltr-extend-line-backward-br-expected.png:
        * platform/gtk/editing/selection/vertical-rl-ltr-extend-line-backward-br-expected.txt:
        * platform/gtk/editing/selection/vertical-rl-ltr-extend-line-backward-p-expected.png:
        * platform/gtk/editing/selection/vertical-rl-ltr-extend-line-backward-p-expected.txt:
        * platform/gtk/editing/selection/vertical-rl-ltr-extend-line-forward-br-expected.png:
        * platform/gtk/editing/selection/vertical-rl-ltr-extend-line-forward-br-expected.txt:
        * platform/gtk/editing/selection/vertical-rl-ltr-extend-line-forward-p-expected.png:
        * platform/gtk/editing/selection/vertical-rl-ltr-extend-line-forward-p-expected.txt:
        * platform/gtk/editing/selection/vertical-rl-rtl-extend-line-backward-br-expected.png:
        * platform/gtk/editing/selection/vertical-rl-rtl-extend-line-backward-br-expected.txt:
        * platform/gtk/editing/selection/vertical-rl-rtl-extend-line-backward-p-expected.png:
        * platform/gtk/editing/selection/vertical-rl-rtl-extend-line-backward-p-expected.txt:
        * platform/gtk/editing/selection/vertical-rl-rtl-extend-line-forward-br-expected.png:
        * platform/gtk/editing/selection/vertical-rl-rtl-extend-line-forward-br-expected.txt:
        * platform/gtk/editing/selection/vertical-rl-rtl-extend-line-forward-p-expected.png:
        * platform/gtk/editing/selection/vertical-rl-rtl-extend-line-forward-p-expected.txt:
        * platform/gtk/fast/css/bidi-override-in-anonymous-block-expected.png:
        * platform/gtk/fast/css/bidi-override-in-anonymous-block-expected.txt:
        * platform/gtk/fast/css/ex-after-font-variant-expected.png:
        * platform/gtk/fast/css/ex-after-font-variant-expected.txt:
        * platform/gtk/fast/forms/auto-fill-button/input-strong-confirmation-password-auto-fill-button-expected.txt:
        * platform/gtk/fast/forms/auto-fill-button/input-strong-password-auto-fill-button-expected.txt:
        * platform/gtk/fast/forms/minWidthPercent-expected.png:
        * platform/gtk/fast/forms/minWidthPercent-expected.txt:
        * platform/gtk/fast/lists/008-expected.png:
        * platform/gtk/fast/lists/008-expected.txt:
        * platform/gtk/fast/lists/008-vertical-expected.png:
        * platform/gtk/fast/lists/008-vertical-expected.txt:
        * platform/gtk/fast/overflow/overflow-rtl-expected.png:
        * platform/gtk/fast/overflow/overflow-rtl-expected.txt:
        * platform/gtk/fast/overflow/overflow-rtl-vertical-expected.png:
        * platform/gtk/fast/overflow/overflow-rtl-vertical-expected.txt:
        * platform/gtk/fast/text/vertical-rl-rtl-linebreak-expected.png:
        * platform/gtk/fast/text/vertical-rl-rtl-linebreak-expected.txt:
        * platform/gtk/svg/W3C-SVG-1.1-SE/coords-units-03-b-expected.png:
        * platform/gtk/svg/W3C-SVG-1.1-SE/coords-units-03-b-expected.txt:
        * platform/gtk/svg/W3C-SVG-1.1/coords-units-03-b-expected.png:
        * platform/gtk/svg/W3C-SVG-1.1/coords-units-03-b-expected.txt: Added.
        * platform/gtk/svg/custom/alignment-baseline-modes-expected.png:
        * platform/gtk/svg/custom/alignment-baseline-modes-expected.txt:
        * platform/gtk/svg/custom/dominant-baseline-modes-expected.png:
        * platform/gtk/svg/custom/dominant-baseline-modes-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug55527-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug55527-expected.txt:

2018-01-04  Minsheng Liu  <lambda@liu.ms>

        Add a test to ensure <mo> paints its leading and trailing space as specified in its attributes.
        https://bugs.webkit.org/show_bug.cgi?id=170272

        Reviewed by Frdric Wang.

        A reference test is added to ensure <mo> paints its leading and trailing space as specified in its attributes.

        The bug itself is fixed as a part of 179682.
        https://bugs.webkit.org/show_bug.cgi?id=179682

        * mathml/presentation/mo-paint-lspace-rspace-expected.html: Added.
        * mathml/presentation/mo-paint-lspace-rspace.html: Added.

2018-01-04  Youenn Fablet  <youenn@apple.com>

        Implement Cache API partitioning based on ClientOrigin
        https://bugs.webkit.org/show_bug.cgi?id=181240

        Reviewed by Alex Christensen.

        Beefing up test to ensure that client and top origins are taken into consideration.

        * http/tests/cache-storage/cache-origins.https-expected.txt:
        * http/tests/cache-storage/cache-origins.https.html:
        * http/tests/cache-storage/cache-clearing-origin.https-expected.txt:
        * http/tests/cache-storage/cache-clearing-origin.https.html:

2018-01-03  Wenson Hsieh  <wenson_hsieh@apple.com>

        [Attachment Support] Add plumbing for starting a drag with promised blob data
        https://bugs.webkit.org/show_bug.cgi?id=181201

        Reviewed by Tim Horton.

        Remove a WK1 LayoutTest testing drag and drop of an attachment element into a contenteditable. This test no
        longer passes because the implementation of attachment dragging on macOS is not yet implemented. Subsequent
        patches will test this scenario once again, but as a WK2 macOS drag and drop API test.

        * editing/pasteboard/drag-and-drop-attachment-contenteditable-expected.txt: Removed.
        * editing/pasteboard/drag-and-drop-attachment-contenteditable.html: Removed.
        * platform/gtk/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/mac-wk2/TestExpectations:
        * platform/win/TestExpectations:

2018-01-03  John Wilander  <wilander@apple.com>

        Storage Access API: Refactor XPC for access removal to go straight from the web process to the network process
        https://bugs.webkit.org/show_bug.cgi?id=181270
        <rdar://problem/36289544>

        Reviewed by Alex Christensen.

        This change refactors how the web process tells the network process
        to remove storage access. Previously, this was done over the UI process
        just like requests for storage access. But since no further reasoning
        is needed, the message should go straight from the web process to the
        network process for performance reasons and to minimize the risk of a
        race.

        As a consequence, the XPC code for storage access removal in the UI
        process is deleted.

        * platform/mac-wk2/TestExpectations:
            Re-enables the test for this code path.

2018-01-03  Michael Saboff  <msaboff@apple.com>

        Disable SharedArrayBuffers from Web API
        https://bugs.webkit.org/show_bug.cgi?id=181266

        Reviewed by Saam Barati.

        Disabled SharedArrayBuffer tests.

        * TestExpectations:

2018-01-03  James Craig  <jcraig@apple.com>

        AX: when invert colors is on, double-invert certain media elements in UserAgentStyleSheet
        https://bugs.webkit.org/show_bug.cgi?id=168447
        <rdar://problem/30559874>

        Reviewed by Simon Fraser.

        Double-invert video when platform "invert colors" setting is enabled. Behavior matches 
        current "Smart Invert" feature of Safari Reader on macOS/iOS and other iOS native apps.

        * TestExpectations: Platform setting only available on Mac and iOS.
        * accessibility/smart-invert-expected.txt: Added. 
        * accessibility/smart-invert-reference-expected.html: Added.
        * accessibility/smart-invert-reference.html: Added. Ref to ensure invert and blur filters render as expected.
        * accessibility/smart-invert.html: Added. Computed expectatons of filter property text values.
        * platform/ios-wk2/TestExpectations: Runs on iOS.
        * platform/mac-wk2/TestExpectations: Runs on Mac.

2018-01-03  Alexey Proskuryakov  <ap@apple.com>

        Update expectations for some range tests.
        Cf. https://bugs.webkit.org/show_bug.cgi?id=144682 and rdar://problem/34716163

        * platform/ios-wk1/TestExpectations:
        * platform/mac-wk1/TestExpectations:
        * platform/mac/TestExpectations:

2018-01-03  Simon Fraser  <simon.fraser@apple.com>

        feLighting is broken with primitiveUnits="objectBoundingBox"
        https://bugs.webkit.org/show_bug.cgi?id=181197

        Reviewed by Tim Horton.
        
        Ref tests with primitiveUnits=objectBoundingBox for feSpotLight and fePointLight.

        * svg/filters/feDiffuseLighting-fePointLight-primitiveUnits-objectBoundingBox-expected.svg: Added.
        * svg/filters/feDiffuseLighting-fePointLight-primitiveUnits-objectBoundingBox.svg: Added.
        * svg/filters/feDiffuseLighting-feSpotLight-primitiveUnits-objectBoundingBox-expected.svg: Added.
        * svg/filters/feDiffuseLighting-feSpotLight-primitiveUnits-objectBoundingBox.svg: Added.
        * svg/filters/feSpecularLighting-fePointLight-primitiveUnits-objectBoundingBox-expected.svg: Added.
        * svg/filters/feSpecularLighting-fePointLight-primitiveUnits-objectBoundingBox.svg: Added.

2018-01-03  Antti Koivisto  <antti@apple.com>

        Crash beneath CSSValue::equals @ csas.cz
        https://bugs.webkit.org/show_bug.cgi?id=181243
        <rdar://problem/35990826>

        Reviewed by Alex Christensen.

        * fast/text/oblique-degree-equals-crash-expected.txt: Added.
        * fast/text/oblique-degree-equals-crash.html: Added.

2018-01-03  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Slow open time enumerating system fonts (FontCache::systemFontFamilies)
        https://bugs.webkit.org/show_bug.cgi?id=180979
        <rdar://problem/36146670>

        Reviewed by Matt Baker.

        * inspector/css/get-system-fonts.html:
        Cleanup the test a bit.

2018-01-03  Simon Fraser  <simon.fraser@apple.com>

        SVG lighting filter lights are in the wrong coordinate system
        https://bugs.webkit.org/show_bug.cgi?id=181147

        Reviewed by Zalan Bujtas.

        * svg/filters/fePointLight-coordinates-expected.svg: Added.
        * svg/filters/fePointLight-coordinates.svg: Added.
        * svg/filters/feSpotLight-coordinates-expected.svg: Added.
        * svg/filters/feSpotLight-coordinates.svg: Added.
        * svg/filters/hidpi/fePointLight-coordinates-expected.svg: Added.
        * svg/filters/hidpi/fePointLight-coordinates.svg: Added.
        * svg/filters/hidpi/feSpotLight-coordinates-expected.svg: Added.
        * svg/filters/hidpi/feSpotLight-coordinates.svg: Added.

2018-01-03  Youenn Fablet  <youenn@apple.com>

        Select service worker for documents with data/blob URLS
        https://bugs.webkit.org/show_bug.cgi?id=181213

        Reviewed by Alex Christensen.

        * http/tests/workers/service/serviceworkerclients-claim.https-expected.txt:
        * http/tests/workers/service/serviceworkerclients-claim.https.html:

2018-01-03  Ms2ger  <Ms2ger@igalia.com>

        [GTK] Remove crash annotation for createImageBitmap-invalid-args.html.
        https://bugs.webkit.org/show_bug.cgi?id=181238

        Unreviewed test gardening.

        I forgot to remove this when fixing the bug.

        * platform/gtk/TestExpectations:

2018-01-03  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r226352.

        Breaks Sierra and El Capitan builds.

        Reverted changeset:

        "Web Inspector: Slow open time enumerating system fonts
        (FontCache::systemFontFamilies)"
        https://bugs.webkit.org/show_bug.cgi?id=180979
        https://trac.webkit.org/changeset/226352

2018-01-03  Carlos Garcia Campos  <cgarcia@igalia.com>

        [GTK] Crash destroying WebCore::FileMonitor
        https://bugs.webkit.org/show_bug.cgi?id=181138

        Reviewed by Michael Catanzaro.

        Remove test expectations associated to this bug.

        * platform/gtk/TestExpectations:

2018-01-02  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Slow open time enumerating system fonts (FontCache::systemFontFamilies)
        https://bugs.webkit.org/show_bug.cgi?id=180979
        <rdar://problem/36146670>

        Reviewed by Matt Baker.

        * inspector/css/get-system-fonts.html:
        Cleanup the test a bit.

2018-01-02  Michael Catanzaro  <mcatanzaro@igalia.com>

        REGRESSION(r223253): Broke ResourceLoadStatistics layout tests for non-Cocoa ports
        https://bugs.webkit.org/show_bug.cgi?id=181231

        Reviewed by Alex Christensen.

        Unskip the tests.

        * platform/gtk/TestExpectations:
        * platform/wpe/TestExpectations:

2018-01-02  Michael Catanzaro  <mcatanzaro@igalia.com>

        Unreviewed WPE test gardening.

        * platform/wpe/TestExpectations:

2018-01-02  Youenn Fablet  <youenn@apple.com>

        Memory cache should not reuse resources with different credential fetch option
        https://bugs.webkit.org/show_bug.cgi?id=181212

        Reviewed by Alex Christensen.

        * TestExpectations: Removing test flakiness expectation.

2018-01-02  Jiewen Tan  <jiewen_tan@apple.com>

        Update Credential Management API for WebAuthentication
        https://bugs.webkit.org/show_bug.cgi?id=181082
        <rdar://problem/36055239>

        Reviewed by Brent Fulgham.

        This patch moves original tests for Credential Management API to http/wpt/ to better integrate
        with web-platform-tests infrastructure. Hopefully this will help us later on contribute tests
        back to W3C.

        * credentials/idlharness-expected.txt: Removed.
        * credentials/idlharness.html: Removed.
        * fast/dom/navigator-detached-no-crash-expected.txt:
        * http/wpt/credential-management/credentialscontainer-create-basics.https-expected.txt: Added.
        * http/wpt/credential-management/credentialscontainer-create-basics.https.html: Added.
        * http/wpt/credential-management/credentialscontainer-get-basics.https-expected.txt: Added.
        * http/wpt/credential-management/credentialscontainer-get-basics.https.html: Added.
        * http/wpt/credential-management/credentialscontainer-preventSilentAccess-basics.https-expected.txt: Added.
        * http/wpt/credential-management/credentialscontainer-preventSilentAccess-basics.https.html: Added.
        * http/wpt/credential-management/idl.https-expected.txt: Added.
        * http/wpt/credential-management/idl.https.html: Added.
        * platform/gtk/TestExpectations:
        * platform/gtk/fast/dom/navigator-detached-no-crash-expected.txt:
        * platform/mac-elcapitan-wk2/fast/dom/navigator-detached-no-crash-expected.txt:
        * platform/mac-wk1/fast/dom/navigator-detached-no-crash-expected.txt:
        * platform/win/TestExpectations:
        * platform/win/fast/dom/navigator-detached-no-crash-expected.txt:

2018-01-02  Ms2ger  <Ms2ger@igalia.com>

        Remove obsolete expectations for updated imported/w3c/web-platform-tests/html/browsers/windows/browsing-context.html.
        https://bugs.webkit.org/show_bug.cgi?id=172255

        Unreviewed test gardening.

        * platform/gtk/TestExpectations:
        * platform/mac/TestExpectations:

2018-01-02  Oleksandr Skachkov  <gskachkov@gmail.com>

        WebAssembly: sending module to iframe fails
        https://bugs.webkit.org/show_bug.cgi?id=179263

        Reviewed by JF Bastien.

        * platform/ios-simulator/TestExpectations:
        * platform/win/TestExpectations:
        * resources/wasm-builder.js: Renamed from LayoutTests/workers/wasm-resources/builder.js.
        * wasm/iframe-parent-postmessage-expected.txt: Added.
        * wasm/iframe-parent-postmessage.html: Added.
        * wasm/iframe-postmessage-expected.txt: Added.
        * wasm/iframe-postmessage.html: Added.
        * wasm/resources/frame-parent.html: Added.
        * wasm/resources/frame.html: Added.
        * wasm/resources/load_wasm.js: Added.
        (createWasmModule):
        * wasm/window-postmessage-expected.txt: Added.
        * wasm/window-postmessage.html: Added.
        * workers/wasm-mem-post-message.html:

2018-01-02  Ms2ger  <Ms2ger@igalia.com>

        [WPE] Update some test expectations
        https://bugs.webkit.org/show_bug.cgi?id=181211

        Unreviewed test gardening.

        * platform/wpe/TestExpectations: disable more SW tests.
        * platform/wpe/imported/w3c/web-platform-tests/2dcontext/imagebitmap/createImageBitmap-invalid-args-expected.txt:
          rebaseline to match the features enabled on the bot.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/encrypted-media-default-feature-policy.https.sub-expected.txt:
          rebaseline for r225963.
        * platform/wpe/imported/w3c/web-platform-tests/fetch/api/basic/request-headers.any-expected.txt:
          rebaseline for r226162.
        * platform/wpe/imported/w3c/web-platform-tests/fetch/api/basic/request-headers.any.worker-expected.txt:
          rebaseline for r226162.
        * platform/wpe/imported/w3c/web-platform-tests/html/dom/interfaces-expected.txt:
          Added: rebaseline to match the features enabled on the bot.
        * platform/wpe/imported/w3c/web-platform-tests/html/dom/reflection-embedded-expected.txt:
          Added: rebaseline to match the features enabled on the bot.
        * platform/wpe/imported/w3c/web-platform-tests/html/dom/reflection-forms-expected.txt:
          Added: rebaseline to match the features enabled on the bot.
        * platform/wpe/imported/w3c/web-platform-tests/html/dom/reflection-text-expected.txt:
          Added: rebaseline to match the features enabled on the bot.

== Rolled over to ChangeLog-2018-01-01 ==
