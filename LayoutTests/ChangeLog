2017-04-28  Matt Lewis  <jlewis3@apple.com>

        Rebaselining test after r215916.
        https://bugs.webkit.org/show_bug.cgi?id=171438

        Unreviewed test gardening.

        * js/dom/global-constructors-attributes-dedicated-worker-expected.txt:
        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-04-28  Eric Carlson  <eric.carlson@apple.com>

        Implement ondevicechange
        https://bugs.webkit.org/show_bug.cgi?id=169872
        <rdar://problem/28945035>

        Reviewed by Jer Noble.

        * fast/mediastream/device-change-event-expected.txt: Added.
        * fast/mediastream/device-change-event.html: Added.

2017-04-28  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: Implement aria-value support for focusable separators
        https://bugs.webkit.org/show_bug.cgi?id=171169

        Reviewed by Chris Fleizach.

        * accessibility/separator-values-expected.txt: Added.
        * accessibility/separator-values.html: Added.

2017-04-28  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] GridCellRole should implement AtkTableCell (regression?)
        https://bugs.webkit.org/show_bug.cgi?id=171179

        Reviewed by Chris Fleizach.

        * accessibility/gtk/interface-table-cell-expected.txt: Added.
        * accessibility/gtk/interface-table-cell.html: Added.

2017-04-28  Miguel Gomez  <magomez@igalia.com>

        REGRESSION(r215211): [GTK] Several webgl related tests are failing
        https://bugs.webkit.org/show_bug.cgi?id=170730

        Reviewed by Said Abou-Hallawa.

        Adjust test expectations for the tests that were failing. They must pass now.

        * platform/gtk/TestExpectations:

2017-04-27  Andy VanWagoner  <thetalecrafter@gmail.com>

        [INTL] Implement the caseFirst option for Intl.Collator
        https://bugs.webkit.org/show_bug.cgi?id=158188

        Reviewed by Geoffrey Garen.

        Updates the Intl.Collator tests to check caseFirst support.
        The caseFirst option or unicode locale extension lets the user explicitly
        set if lower or upper case characters should be first in order.

        * js/intl-collator-expected.txt:
        * js/script-tests/intl-collator.js:
        (testCollator):

2017-04-27  Joseph Pecoraro  <pecoraro@apple.com>

        Support for promise rejection events (unhandledrejection)
        https://bugs.webkit.org/show_bug.cgi?id=150358
        <rdar://problem/28441651>

        Reviewed by Saam Barati.

        Patch by Joseph Pecoraro and Yusuke Suzuki.

        * js/dom/unhandled-promise-rejection-basic-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-basic.html: Added.
        * js/dom/unhandled-promise-rejection-bindings-type-error-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-bindings-type-error.html: Added.
        * js/dom/unhandled-promise-rejection-console-no-report-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-console-no-report.html: Added.
        * js/dom/unhandled-promise-rejection-console-report-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-console-report.html: Added.
        * js/dom/unhandled-promise-rejection-handle-during-event-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-handle-during-event.html: Added.
        * js/dom/unhandled-promise-rejection-handle-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-handle-in-handler-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-handle-in-handler.html: Added.
        * js/dom/unhandled-promise-rejection-handle.html: Added.
        * js/dom/unhandled-promise-rejection-order-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-order.html: Added.
        New tests specific to the `onunhandledrejection` and `onrejectionhandled` events.

        * resources/testharnessreport.js:
        (self.testRunner.add_completion_callback.sanitize):
        (self.testRunner.add_completion_callback):
        Report results immediately and then finish the test after a turn. This way
        if the test ends with a pass, but may get unhandled rejections after
        completing which should not make the test appear as if it failed. Some tests
        have unhandled promise rejections but are expected to pass. Likewise some
        tests perform cleanup in their own completion callbacks, which happen after
        this initial completion callback, and we want to report results after all
        the work is done as it may eliminate non-deterministic debug test output.

        * TestExpectations:
        Mark some tests as flakey that have sometimes have unhandled promise rejections.
        These tests are all various imported tests that use the testharness.

        * fast/mediastream/MediaStream-MediaElement-setObject-null-expected.txt:
        * http/tests/security/video-cross-origin-caching-expected.txt:
        * inspector/debugger/break-on-exception-throw-in-promise-expected.txt:
        * inspector/debugger/break-on-uncaught-exception-throw-in-promise-expected.txt:
        * inspector/worker/resources-in-worker-expected.txt:
        * js/dom/dom-static-property-for-in-iteration-expected.txt:
        * js/dom/global-constructors-attributes-dedicated-worker-expected.txt:
        * js/promises-tests/promises-tests-2-2-6-expected.txt:
        * platform/mac/inspector/model/remote-object-expected.txt:
        * webrtc/libwebrtc/release-while-creating-offer-expected.txt:
        * webrtc/libwebrtc/release-while-setting-local-description-expected.txt:
        Update tests with unhandled promise rejection messages.

        * media/W3C/audio/events/event_pause_manual.html:
        * media/audio-playback-restriction-play-expected.txt:
        * media/audio-playback-restriction-play.html:
        * media/click-volume-bar-not-pausing.html:
        * media/remote-control-command-is-user-gesture-expected.txt:
        * media/remote-control-command-is-user-gesture.html:
        * media/track/track-mode.html:
        * media/video-autoplay-allowed-but-fullscreen-required.html:
        * media/video-display-none-crash.html:
        * media/video-main-content-deny-display-none.html:
        * media/video-main-content-deny-not-in-dom.html:
        * media/video-main-content-deny-not-visible.html:
        * media/video-main-content-deny-obscured.html:
        * media/video-main-content-deny-too-small.html:
        * media/video-multiple-concurrent-playback-expected.txt:
        * media/video-play-audio-require-user-gesture-expected.txt:
        * media/video-play-audio-require-user-gesture.html:
        * media/video-play-pause-events-expected.txt:
        * media/video-play-pause-events.html:
        * media/video-play-pause-exception-expected.txt:
        * media/video-play-pause-exception.html:
        * media/video-play-require-user-gesture-expected.txt:
        * media/video-play-require-user-gesture.html:
        * media/video-preload-expected.txt:
        * media/video-preload.html:
        * media/video-test.js:
        (handlePromise.handle):
        Snuff many possible unhandled promise rejections in media via media.play().

        * streams/reference-implementation/pipe-to-expected.txt:
        * streams/reference-implementation/pipe-to-options-expected.txt:
        * streams/reference-implementation/readable-stream-templated-expected.txt:
        * streams/reference-implementation/writable-stream-abort-expected.txt:
        * streams/reference-implementation/writable-stream-expected.txt:
        These stream tests are out of date and produce unhandled rejections.

        * streams/shadowing-Promise.html:
        Update non-imported tests to prevent unhandled rejection messages.

2017-04-27  Chris Dumez  <cdumez@apple.com>

        Align colspan/rowspan limits with the latest HTML specification
        https://bugs.webkit.org/show_bug.cgi?id=171322

        Reviewed by Darin Adler.

        Rebaseline a couple of rowspan tests now that our max limit has changed.

        * fast/table/giantRowspan2-expected.txt:
        * platform/ios/fast/table/giantRowspan-expected.txt:
        * platform/ios/imported/w3c/web-platform-tests/html/dom/reflection-embedded-expected.txt:
        * platform/mac/fast/table/giantRowspan-expected.txt:

2017-04-27  Matt Lewis  <jlewis3@apple.com>

        Mark fast/mediacapturefromelement/CanvasCaptureMediaStream-2d-events.html as a flaky failure.
        https://bugs.webkit.org/show_bug.cgi?id=170835

        Unreviewed test gardening.

        * TestExpectations:

2017-04-27  Matt Lewis  <jlewis3@apple.com>

        Mark imported/blink/paint/deprecatedpaintlayer/non-self-painting-layer-overrides-visibility.html as a flaky crash.
        https://bugs.webkit.org/show_bug.cgi?id=171406

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Add missing expected file for fast/inline/simple-line-layout-16bit-content.html.
        https://bugs.webkit.org/show_bug.cgi?id=171379

        Unreviewed test gardening.

        * fast/inline/simple-line-layout-16bit-content-expected-mismatch.html: Added.

2017-04-27  David Kilzer  <ddkilzer@apple.com>

        Enhance shouldBe()/shouldNotBe() to accept anonymous function arguments
        <https://webkit.org/b/171362>
        <rdar://problem/31867686>

        Reviewed by Joseph Pecoraro.

        This change makes it possible to pass either the first or second
        argument (or both) as anonymous functions into shouldBe() and
        shouldNotBe() to make it easy to capture local variables when
        writing tests.  This is similar to the change in r202609 for Bug
        159232 for shouldThrow() and shouldNotThrow().

        Note that shouldBe()/shouldNotBe() from the following files were
        NOT updated since they were imported from other projects and did
        share the full WebKit history of resources/js-test-pre.js:

            http/tests/webgl/1.0.2/resources/webgl_test_files/resources/js-test-pre.js
            js/mozilla/resources/js-test-pre.js
            webgl/1.0.2/resources/webgl_test_files/resources/js-test-pre.js
            webgl/1.0.3/resources/webgl_test_files/resources/js-test-pre.js

        However, these files WERE brought up-to-date with the ability to
        pass anonymous functions into shouldBe()/shouldNotBe() for this
        bug, and shouldThrow()/shouldNotThrow() which should have
        originally been fixed with Bug 159232:

            http/tests/resources/js-test-pre.js
            resources/standalone-pre.js

        * css3/scroll-snap/resources/iframe-content.html: Drive-by fix
        to debug message for copy-paste error.  Found by searching
        LayoutTests directory for "expects string arguments".

        * fast/canvas/webgl/array-unit-tests-expected.txt: Update test
        results.
        * fast/canvas/webgl/array-unit-tests.html: Fix warning by making
        second argument to shouldBe() a string.

        * fast/css/script-tests/image-set-parsing.js:
        (testImageSetRule): Remove comment by changing second argument
        to shouldBe() into an anonymous function.

        * http/tests/resources/js-test-pre.js:
        (evalAndLog):
        (evalAndLogResult):
        (shouldBe):
        (shouldNotBe):
        (shouldEvaluateTo):
        - Made a full copy of resources/js-test-pre.js to bring this up
          to speed.  Needs a checker written for it to keep them in sync.
        * http/tests/security/xssAuditor/block-does-not-leak-location-expected.txt:
        * http/tests/security/xssAuditor/block-does-not-leak-referrer-expected.txt:
        - Update line numbers after updating http/tests/resources/js-test-pre.js.

        * js/function-declarations-in-switch-statement-expected.txt:
        - Update results after fixing warnings.
        * js/script-tests/function-declarations-in-switch-statement.js:
        - Fix warnings by passing in strings to shouldBe().

        * js/script-tests/stack-unwinding.js:
        - Update results after fixing warnings.
        * js/stack-unwinding-expected.txt:
        - Fix warnings by passing in strings to shouldBe().

        * resources/js-test-pre.js:
        (shouldBe):
        (shouldNotBe):
        * resources/js-test.js:
        (shouldBe):
        (shouldNotBe):
        - Update shouldBe()/shouldNotBe() to accept anonymous function
          arguments.

        * resources/standalone-pre.js:
        (shouldBe):
        (shouldNotBe):
        (shouldNotThrow):
        (shouldThrow):
        - Update shouldBe()/shouldNotBe() to accept anonymous function
          arguments.
        - Also fix shouldThrow()/shouldNotThrow() to accept anonymous
          function arguments (which were missed in r202609 for Bug
          159232).

2017-04-27  Chris Dumez  <cdumez@apple.com>

        Element.getBoundingClientRect() / getClientRects() should return a DOMRect types
        https://bugs.webkit.org/show_bug.cgi?id=171226

        Reviewed by Simon Fraser.

        Update existing tests to reflect behavior change.

        * TestExpectations:
        * css3/flexbox/align-absolute-child-expected.txt:
        * fast/css/ClientRect-attributes-prototype-expected.txt: Removed.
        * fast/css/ClientRect-attributes-prototype.html: Removed.
        * fast/css/ClientRect-serialization-expected.txt: Removed.
        * fast/css/ClientRect-serialization.html: Removed.
        * fast/css/DOMRect-attributes-prototype-expected.txt: Added.
        * fast/css/DOMRect-attributes-prototype.html: Added.
        * fast/css/DOMRect-serialization-expected.txt: Added.
        * fast/css/DOMRect-serialization.html: Added.
        * fast/dom/Element/getClientRects-return-type-expected.txt: Added.
        * fast/dom/Element/getClientRects-return-type.html: Added.
        * fast/dom/collection-iterators-expected.txt:
        * fast/dom/collection-iterators.html:
        * fast/visual-viewport/zoomed-fixed-expected.txt:
        * fast/visual-viewport/zoomed-fixed-header-and-footer-expected.txt:
        * fast/zooming/client-rect-in-fixed-zoomed-expected.txt:
        * fast/zooming/client-rect-in-fixed-zoomed.html:
        * js/resources/JSON-stringify.js:

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/fullscreen-button/fullscreen-button.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171391

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/security/contentSecurityPolicy/source-list-parsing-05.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171389

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/xmlhttprequest/workers/methods.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170181

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-04-27  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: Expose elements with the ARIA "feed" role
        https://bugs.webkit.org/show_bug.cgi?id=171184

        Reviewed by Chris Fleizach.

        Add "feed" role to roles-exposed.html, xml-roles-exposed.html, and
        roles-computedRoleString.html. Update expectations accordingly.

        * accessibility/gtk/xml-roles-exposed-expected.txt:
        * accessibility/gtk/xml-roles-exposed.html:
        * accessibility/roles-computedRoleString.html:
        * accessibility/roles-exposed.html:
        * platform/gtk/accessibility/roles-exposed-expected.txt:
        * platform/mac/accessibility/roles-computedRoleString-expected.txt:
        * platform/mac/accessibility/roles-exposed-expected.txt:

2017-04-27  Myles C. Maxfield  <mmaxfield@apple.com>

        REGRESSION(r214572): Update fast/text/variations/advances.html to understand normalized variation widths
        https://bugs.webkit.org/show_bug.cgi?id=171356
        <rdar://problem/28670085>

        Reviewed by Dean Jackson.

        Unspecified 'wdth' axis values are being normalized because the font is a GX font. However, this
        font assumes no normalization, which means one of the comparisons in the test is bogus.

        * fast/text/variations/advances-expected.txt:
        * fast/text/variations/advances.html:
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:

2017-04-27  Antti Koivisto  <antti@apple.com>

        Skip css3/viewport-percentage-lengths/vh-auto-size.html on WK1.

        Looks like use of auto-sizing leaves state behind in DRT.

        * platform/mac-wk1/TestExpectations:

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/buttons-container/buttons-container-buttons-property.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=167371

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark webgl/1.0.2/conformance/glsl/misc/shader-with-reserved-words.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170877

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-27  Zalan Bujtas  <zalan@apple.com>

        Use text-shadow to visualize simple line layout coverage.
        https://bugs.webkit.org/show_bug.cgi?id=171379

        Reviewed by Antti Koivisto.

        * fast/inline/simple-line-layout-16bit-content-expected-mismatch.html: Added.
        * fast/inline/simple-line-layout-16bit-content-expected.html: Removed.
        * fast/inline/simple-line-layout-16bit-content.html:

2017-04-27  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] ARIA alertdialogs should be exposed with ROLE_DIALOG
        https://bugs.webkit.org/show_bug.cgi?id=171187

        Reviewed by Chris Fleizach.

        * accessibility/aria-mappings-expected.txt: Updated.
        * accessibility/gtk/xml-roles-exposed-expected.txt: Updated.
        * platform/gtk/accessibility/roles-exposed-expected.txt: Updated.

2017-04-27  Myles C. Maxfield  <mmaxfield@apple.com>

        Make fast/text/complex-small-caps-non-bmp-capitalize.html more robust
        https://bugs.webkit.org/show_bug.cgi?id=171366
        <rdar://problem/30060323>

        Reviewed by Alex Christensen.

        This test needs a font which supports Deseret but doesn't support small caps.
        Geneva is a better choice for such a font.

        * fast/text/complex-small-caps-non-bmp-capitalize-expected.html:
        * fast/text/complex-small-caps-non-bmp-capitalize.html:

2017-04-27  Antti Koivisto  <antti@apple.com>

        Repeated layouts in Mail due to viewport units being used with auto-sizing
        https://bugs.webkit.org/show_bug.cgi?id=171371
        <rdar://problem/28780084>

        Reviewed by Zalan Bujtas.

        * css3/viewport-percentage-lengths/vh-auto-size-expected.html: Added.
        * css3/viewport-percentage-lengths/vh-auto-size.html: Added.

2017-04-27  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: Inconsistent exposure of ARIA "button" role with non-false value of aria-haspopup
        https://bugs.webkit.org/show_bug.cgi?id=171204

        Reviewed by Chris Fleizach.

        It turns out that this bug was fixed as a side effect of the changes made
        to fix WebKitGtk bug 171164 (r215821). But we didn't realize it due to the
        lack of an existing layout test covering the mappings for other platforms.
        The test created for the WebKitGtk port was modified and moved to the shared
        tests. Shared expectations are based on the Mac's mappings.

        * accessibility/button-with-aria-haspopup-role-expected.txt: Added.
        * accessibility/button-with-aria-haspopup-role.html: Renamed from LayoutTests/accessibility/gtk/button-with-aria-haspopup-is-not-a-combobox.html.
        * accessibility/gtk/button-with-aria-haspopup-is-not-a-combobox-expected.txt: Removed.
        * platform/gtk/accessibility/button-with-aria-haspopup-role-expected.txt: Added.

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/local/blob/send-hybrid-blob-using-open-panel.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171353

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-04-27  Frederic Wang  <fwang@igalia.com>

        Fix some tests from platform-tests/cssom-view/cssom-view/
        https://bugs.webkit.org/show_bug.cgi?id=171228

        Reviewed by Youenn Fablet.

        * TestExpectations: Unskip media-query-list-interface.

2017-04-27  Zalan Bujtas  <zalan@apple.com>

        Text gets cut off when bailing out of simple line layout with widows.
        https://bugs.webkit.org/show_bug.cgi?id=171370
        <rdar://problem/31563414>

        Reviewed by Antti Koivisto.

        * fast/multicol/simple-line-layout-widows-when-switching-over-to-normal-line-layout-expected.html: Added.
        * fast/multicol/simple-line-layout-widows-when-switching-over-to-normal-line-layout.html: Added.

2017-04-26  Chris Dumez  <cdumez@apple.com>

        Unreviewed, remove unnecessary expected result in platform/ios-wk2

        * platform/ios-wk2/imported/w3c/web-platform-tests/html/dom/reflection-embedded-expected.txt: Removed.
        * platform/ios/imported/w3c/web-platform-tests/html/dom/reflection-embedded-expected.txt:

2017-04-26  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Uint8ClampedArray should be treated like an array, not an object
        https://bugs.webkit.org/show_bug.cgi?id=171364
        <rdar://problem/10873037>

        Reviewed by Sam Weinig.

        * inspector/model/remote-object-expected.txt:
        * inspector/model/remote-object.html:
        * platform/mac/inspector/model/remote-object-expected.txt:
        Test a Uint8ClampedArray is treated like an array.

2017-04-26  Saam Barati  <sbarati@apple.com>

        ASSERTION FAILED: inIndex != notFound in JSC::invalidParameterInSourceAppender()
        https://bugs.webkit.org/show_bug.cgi?id=170924
        <rdar://problem/31721052>

        Reviewed by Mark Lam.

        * js/let-syntax-expected.txt:

2017-04-26  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] ARIA buttons which have a popup should be ATK_ROLE_PUSH_BUTTON; not ATK_ROLE_COMBO_BOX
        https://bugs.webkit.org/show_bug.cgi?id=171182

        Reviewed by Chris Fleizach.

        * accessibility/gtk/button-with-aria-haspopup-is-not-a-combobox-expected.txt: Added.
        * accessibility/gtk/button-with-aria-haspopup-is-not-a-combobox.html: Added.

2017-04-26  Tim Horton  <timothy_horton@apple.com>

        Should not drag x-apple-data-detectors links
        https://bugs.webkit.org/show_bug.cgi?id=171352
        <rdar://problem/31309081>

        Reviewed by Beth Dakin.

        * fast/events/do-not-drag-and-drop-data-detectors-link-expected.txt: Added.
        * fast/events/do-not-drag-and-drop-data-detectors-link.html: Added.

2017-04-26  Tim Horton  <timothy_horton@apple.com>

        Revert accidentally smushed commit.

        * TestExpectations:
        * fast/events/do-not-drag-and-drop-data-detectors-link-expected.txt: Removed.
        * fast/events/do-not-drag-and-drop-data-detectors-link.html: Removed.
        * platform/mac/TestExpectations:

2017-04-26  Matt Lewis  <jlewis3@apple.com>

        Re-baseline inspector/dom/getAccessibilityPropertiesForNode.html after r215821
        https://bugs.webkit.org/show_bug.cgi?id=171346

        Unreviewed test gardening.

        * inspector/dom/getAccessibilityPropertiesForNode-expected.txt:

2017-04-26  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] Elements with a defined, non-false value for aria-current should expose ATK_STATE_ACTIVE
        https://bugs.webkit.org/show_bug.cgi?id=171163

        Reviewed by Chris Fleizach.

        * accessibility/gtk/aria-current-changed-notification-expected.txt: Added.
        * accessibility/gtk/aria-current-changed-notification.html: Added.
        * accessibility/gtk/aria-current-expected.txt: Added.
        * accessibility/gtk/aria-current.html: Added.

2017-04-26  Youenn Fablet  <youenn@apple.com>

        LayoutTest webrtc/datachannel/bufferedAmountLowThreshold.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170701

        Reviewed by Eric Carlson.

        * platform/mac-wk1/TestExpectations: Removing flaky expectation.
        * webrtc/datachannel/bufferedAmountLowThreshold-expected.txt:
        * webrtc/datachannel/bufferedAmountLowThreshold.html:

2017-04-26  Said Abou-Hallawa  <sabouhallawa@apple.com>

        Restrict WebKit image formats to a known whitelist
        https://bugs.webkit.org/show_bug.cgi?id=170700

        Reviewed by Tim Horton.

        * fast/images/image-formats-support-expected.txt: Added.
        * fast/images/image-formats-support.html: Added.
        * fast/images/resources/100x100-red-psd-renamed.png: Added.
        * fast/images/resources/100x100-red-tga-renamed.png: Added.
        * fast/images/resources/100x100-red.psd: Added.
        * fast/images/resources/100x100-red.tga: Added.

2017-04-26  Matt Lewis  <jlewis3@apple.com>

        Mark swipe/main-frame-pinning-requirement.html as a flaky failure on mac-wk2.
        https://bugs.webkit.org/show_bug.cgi?id=170484

        Reviewed by Alexey Proskuryakov.

        * platform/mac-wk2/TestExpectations:

2017-04-26  Chris Dumez  <cdumez@apple.com>

        Re-sync html/browsers/the-window-object web-platform-tests from upstream
        https://bugs.webkit.org/show_bug.cgi?id=171313

        Reviewed by Alex Christensen.

        * tests-options.json:

2017-04-26  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] Implement support for new ARIA 1.1 values of aria-haspopup
        https://bugs.webkit.org/show_bug.cgi?id=171164

        Reviewed by Chris Fleizach.

        In addition to the new test, update xml-roles-exposed.html's expectations
        because the implicit value of aria-haspopup for the combobox role is now
        listbox, and that value should be exposed via an AtkObject attribute.

        * accessibility/gtk/aria-haspopup-expected.txt: Added.
        * accessibility/gtk/aria-haspopup.html: Added.
        * accessibility/gtk/xml-roles-exposed-expected.txt:

2017-04-26  Simon Fraser  <simon.fraser@apple.com>

        http/tests/frame-throttling tests failing on iOS
        https://bugs.webkit.org/show_bug.cgi?id=171314
        rdar://problem/31691134

        Reviewed by Chris Dumez.

        The tests use UIHelper.activateAt(), which in DumpRenderTree dispatches mouse events via EventSender, and in iOS WK2 uses
        UIScriptController to dispatch touch events. The former just use standard hit testing, which works fine.
        The latter go via Frame::qualifyingNodeAtViewportLocation(), which calls ancestorRespondingToClickEvents()
        and does area hit testing, and this fails to find anything clickable inside the <iframe>s.

        Fix by putting a div with an onlick handler inside the iframes, and adjusting the click
        locations.

        * http/tests/frame-throttling/raf-throttle-in-cross-origin-subframe.html:
        * http/tests/frame-throttling/resources/requestAnimationFrame-frame.html:
        * http/tests/frame-throttling/resources/timer-throttling-frame.html:
        * http/tests/frame-throttling/timer-throttle-in-cross-origin-subframe.html:

2017-04-26  Matt Lewis  <jlewis3@apple.com>

        Removing Flaky timeout expectation for swipe/main-frame-pinning-requirement.html.
        https://bugs.webkit.org/show_bug.cgi?id=161887

        Reviewed by Tim Horton.

        * platform/mac-wk2/TestExpectations:

2017-04-25  Dean Jackson  <dino@apple.com>

        [Color] Make gradients work with ExtendedColors
        https://bugs.webkit.org/show_bug.cgi?id=171315
        <rdar://problems/31830177>

        Reviewed by Antoine Quint.

        Test for gradients using the color() syntax. Unfortunately,
        due to rounding errors, we can't use a ref test for some
        transparent colors, so comment them out for the moment.
        These can be re-enabled when we can specify a tolerance
        value for image comparison in the testing framework.

        * css3/color/gradients-expected.html: Added.
        * css3/color/gradients.html: Added.

2017-04-26  Zalan Bujtas  <zalan@apple.com>

        Forced page break on :after triggers infinite loop in column balancing
        https://bugs.webkit.org/show_bug.cgi?id=171309
        rdar://problem/26285884

        Reviewed by David Hyatt.

        * fast/multicol/infinite-loop-when-forced-break-expected.txt: Added.
        * fast/multicol/infinite-loop-when-forced-break.html: Added.

2017-04-26  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r215767.

        The LayoutTest for this change is a flaky failure.

        Reverted changeset:

        "Restrict WebKit image formats to a known whitelist"
        https://bugs.webkit.org/show_bug.cgi?id=170700
        http://trac.webkit.org/changeset/215767

2017-04-24  Sergio Villar Senin  <svillar@igalia.com>

        [css-grid] Remove most of the usage of SizingOperation
        https://bugs.webkit.org/show_bug.cgi?id=171225

        Reviewed by Darin Adler.

        Added a new test case which was working correctly but that was not properly tested before.

        * fast/css-grid-layout/grid-track-sizing-with-percentages-and-orthogonal-flows-expected.txt:
        * fast/css-grid-layout/grid-track-sizing-with-percentages-and-orthogonal-flows.html:

2017-04-25  Joseph Pecoraro  <pecoraro@apple.com>

        [mac-wk1 Debug] LayoutTest http/tests/inspector/network/resource-sizes-network.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170953

        Reviewed by Brian Burg.

        * http/tests/inspector/network/resource-sizes-disk-cache.html:
        * http/tests/inspector/network/resource-sizes-network.html:
        Read the entire data to ensure the load is complete before we notify the frontend.

        * platform/mac-wk1/TestExpectations:
        * platform/mac-wk2/TestExpectations:
        Unflake these tests, they should be more reliable now.

2017-04-25  Youenn Fablet  <youenn@apple.com>

        fast/mediastream/RTCPeerConnection-icecandidate-event.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=171242

        Reviewed by Alex Christensen.

        * TestExpectations:
        * fast/mediastream/RTCPeerConnection-icecandidate-event-expected.txt:
        * fast/mediastream/RTCPeerConnection-icecandidate-event.html: Updating test to be more deterministic.

2017-04-25  Brent Fulgham  <bfulgham@apple.com>

        Relax the event firing ASSERT for Attr changes
        https://bugs.webkit.org/show_bug.cgi?id=171236
        <rdar://problem/30516349>

        Reviewed by Dean Jackson.

        * fast/dom/HTMLLinkElement/event-while-removing-attribute-expected.txt: Added.
        * fast/dom/HTMLLinkElement/event-while-removing-attribute.html: Added.

2017-04-25  Dean Jackson  <dino@apple.com>

        REGRESSION (r214129): fast/media/mq-prefers-reduced-motion.html fails
        https://bugs.webkit.org/show_bug.cgi?id=171303
        <rdar://problem/31434879>

        Reviewed by Brent Fulgham.

        This particular test was calling notifyDone() from within
        a callback triggered by the UIScriptController script, which
        meant that by the time the controller tried to call its callback,
        the test had finished.

        * fast/media/mq-prefers-reduced-motion-matchMedia.html: Make sure
        notifyDone is called after both the callback-like functions have
        triggered.

2017-04-25  John Wilander  <wilander@apple.com>

        Resource Load Statistics: Introduce shorter time-to-live for cookie partition whitelisting
        https://bugs.webkit.org/show_bug.cgi?id=171295
        <rdar://problem/31823818>

        Reviewed by Brent Fulgham.

        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-deletion.html:
            Changed a TestRunner function name to
            statisticsFireShouldPartitionCookiesHandlerForOneDomain().
        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-with-partitioning-timeout-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-with-partitioning-timeout.html: Added.
        * http/tests/loading/resourceLoadStatistics/partitioned-cookies-with-and-without-user-interaction.html:
            Changed a TestRunner function name to
            statisticsFireShouldPartitionCookiesHandlerForOneDomain().

2017-04-25  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r215476.
        https://bugs.webkit.org/show_bug.cgi?id=171304

        "It broke JSBench" (Requested by saamyjoon on #webkit).

        Reverted changeset:

        "[ES6]. Implement Annex B.3.3 function hoisting rules for
        eval"
        https://bugs.webkit.org/show_bug.cgi?id=163208
        http://trac.webkit.org/changeset/215476

2017-04-25  Saam Barati  <sbarati@apple.com>

        JSArray::isArrayPrototypeIteratorProtocolFastAndNonObservable is wrong because it does not do the necessary checks on the base object
        https://bugs.webkit.org/show_bug.cgi?id=171150
        <rdar://problem/31771880>

        Reviewed by Sam Weinig.

        * js/sequence-iterator-protocol-2-expected.txt: Added.
        * js/sequence-iterator-protocol-2.html: Added.
        * js/sequence-iterator-protocol-expected.txt: Added.
        * js/sequence-iterator-protocol.html: Added.

2017-04-25  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/pip-support/pip-support-click.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=165311

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-25  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/security/contentSecurityPolicy/1.1/module-scriptnonce-invalidnonce.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171301

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-04-25  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r215730.

        The LayoutTest for this change is a flaky timeout on mac-wk1
        debug.

        Reverted changeset:

        "Enable expired-only reload policy on Mac and iOS"
        https://bugs.webkit.org/show_bug.cgi?id=171264
        http://trac.webkit.org/changeset/215730

2017-04-25  Said Abou-Hallawa  <sabouhallawa@apple.com>

        Restrict WebKit image formats to a known whitelist
        https://bugs.webkit.org/show_bug.cgi?id=170700

        Reviewed by Tim Horton.

        * fast/images/image-formats-support-expected.txt: Added.
        * fast/images/image-formats-support.html: Added.
        * fast/images/resources/100x100-red-psd-renamed.png: Added.
        * fast/images/resources/100x100-red-tga-renamed.png: Added.
        * fast/images/resources/100x100-red.psd: Added.
        * fast/images/resources/100x100-red.tga: Added.

2017-04-25  Tim Horton  <timothy_horton@apple.com>

        Deduplicate some lines in the toplevel TestExpectations

        * TestExpectations:
        Remove a duplicate line and consolidate another.

2017-04-25  Chris Dumez  <cdumez@apple.com>

        Element.dataset.name incorrectly returns undefined
        https://bugs.webkit.org/show_bug.cgi?id=161454
        <rdar://problem/31818563>

        Reviewed by Mark Lam.

        Add layout test for JS caching bug on DOMStringMap that was fixed as part
        of a large named property getter refactoring in r210667.

        * fast/dom/dataset-caching-bug-expected.txt: Added.
        * fast/dom/dataset-caching-bug.html: Added.

2017-04-25  Myles C. Maxfield  <mmaxfield@apple.com>

        Supplementary Multilingual Plane Complex Scripts Rendered Incorrectly
        https://bugs.webkit.org/show_bug.cgi?id=171272
        <rdar://problem/30966764>

        Reviewed by Zalan Bujtas.

        * fast/text/kaithi-expected.html: Added.
        * fast/text/kaithi.html: Added.
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:

2017-04-25  Daniel Bates  <dabates@apple.com>

        [Cocoa][Win] Enable of X-Content-Type-Options: nosniff header
        https://bugs.webkit.org/show_bug.cgi?id=136452
        <rdar://problem/23412620>

        Reviewed by Brent Fulgham.

        Unskip nosniff tests on Mac, iOS and Windows and update expected results now that
        we support X-Content-Type-Options: nosniff.

        Merge Blink test from <https://src.chromium.org/viewvc/blink?revision=168570&view=revision>.

        * TestExpectations: Unskip all nosniff tests except imported/w3c/web-platform-tests/fetch/nosniff/importscripts.html.
        We need to fix <https://bugs.webkit.org/show_bug.cgi?id=171248> before we can unskip it.
        When running the nosniff Web Platform Tests (WPT) dump console messages to standard error
        to avoid a difference of console message ordering due to the non-determinism of the WPT
        tests from affecting the matching of the expected result.
        * http/tests/security/contentTypeOptions/nosniff-dynamic-script-blocked-expected.txt: Added.
        * http/tests/security/contentTypeOptions/nosniff-dynamic-script-blocked.html: Copied from LayoutTests/http/tests/security/contentTypeOptions/nosniff-script-blocked.html.
        * http/tests/security/contentTypeOptions/nosniff-script-blocked-expected.txt: Update expected result.
        * http/tests/security/contentTypeOptions/nosniff-script-blocked.html: Substitute the not executable
        MIME type "text/xx-javascript" for "text/x-javascript" as the latter is an acceptable MIME type for
        JavaScript scripts as per the Fetch standard, <https://html.spec.whatwg.org/multipage/scripting.html#javascript-mime-type> (30 March 2017).
        * http/tests/security/contentTypeOptions/nosniff-script-without-content-type-blocked-expected.txt: Update
        expected result.
        * platform/gtk/TestExpectations: Skip the nosniff tests as GTK does not enable ENABLE(NOSNIFF).
        * platform/ios/TestExpectations: Unskip nosniff tests.
        * platform/mac/TestExpectations: Ditto.
        * platform/win/TestExpectations: Ditto.
        * platform/wk2/TestExpectations: Ditto.

2017-04-25  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/inspector/network/resource-sizes-disk-cache.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170971

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-04-25  Chris Dumez  <cdumez@apple.com>

        Content-Disposition header filename is ignored when 'download' attribute is specified in HTML
        https://bugs.webkit.org/show_bug.cgi?id=171239
        <rdar://problem/31789855>

        Reviewed by Alex Christensen.

        * http/tests/security/anchor-download-allow-sameorigin.html:
        Stop using attachment.php as resource for this download attribute test because attachment.php
        returns a Content-Disposition header with a filename. Given the behavior change in this patch,
        this resource is no longer suitable for testing the download attribute.

        * http/tests/download/anchor-download-attribute-content-disposition-expected.txt: Added.
        * http/tests/download/anchor-download-attribute-content-disposition.html: Added.
        * http/tests/download/resources/content-disposition-pass.php: Added.
        Add layout test coverage.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-wk1/TestExpectations:
        * platform/win/TestExpectations:
        Skip new test on platforms where the download attribute is not supported.

2017-04-25  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline fast/canvas/canvas-crash.html for ios-simulator.
        https://bugs.webkit.org/show_bug.cgi?id=171238

        Unreviewed test gardening.

        * platform/ios-simulator/fast/canvas/canvas-crash-expected.txt: Added.

2017-04-25  Antti Koivisto  <antti@apple.com>

        Enable expired-only reload policy on Mac and iOS
        https://bugs.webkit.org/show_bug.cgi?id=171264
        <rdar://problem/31807637>

        Reviewed by Andreas Kling.

        * fast/loader/display-image-unset-can-block-image-and-can-reload-in-place.html:

        WebKitDisplayImages preference blocks loads, it does not prevent images already in memory cache from displaying.
        Modify the test to clear the memory cache so it still tests what it is supposed to.

2017-04-25  Frederic Wang  <fwang@igalia.com>

        Import W3C tests for the CSSOM View module
        https://bugs.webkit.org/show_bug.cgi?id=171215

        Reviewed by Youenn Fablet.

        * TestExpectations: Skip some completely failing CSSOM View tests.
        * platform/ios-simulator/imported/w3c/web-platform-tests/cssom-view/Screen-pixelDepth-Screen-colorDepth001-actual.txt: Added. Add an expectation for iOS simulator, differing from other platform.
        * platform/ios-simulator/imported/w3c/web-platform-tests/cssom-view/scrolling-quirks-vs-nonquirks-expected.txt: Added. Ditto.

2017-04-24  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/language/expressions/object/method-definition/early-errors-object-method-duplicate-parameters.js
        https://bugs.webkit.org/show_bug.cgi?id=171190

        Reviewed by Saam Barati.

        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:
        Extend to cover method duplicate parameter cases.

2017-04-24  Jiewen Tan  <jiewen_tan@apple.com>

        LayoutTests crypto/subtle/ecdsa-generate-key-sign-verify-p384.html and crypto/subtle/ecdsa-generate-key-sign-verify-p256.html are flaky failures
        https://bugs.webkit.org/show_bug.cgi?id=171059
        <rdar://problem/31734958>

        Reviewed by Brent Fulgham.

        * TestExpectations:
        Remove test expectations.

2017-04-24  Manuel Rego Casasnovas  <rego@igalia.com>

        [selectors4] :focus-within should use the flat tree
        https://bugs.webkit.org/show_bug.cgi?id=170899

        Reviewed by Antti Koivisto.

        * TestExpectations: Remove test that is passing now.

2017-04-24  Nan Wang  <n_wang@apple.com>

        AX: Crash at WebCore::AXObjectCache::characterOffsetForIndex(int, WebCore::AccessibilityObject const*) + 703
        https://bugs.webkit.org/show_bug.cgi?id=171247

        Reviewed by Chris Fleizach.

        * accessibility/mac/input-string-for-range-crash-expected.txt: Added.
        * accessibility/mac/input-string-for-range-crash.html: Added.

2017-04-24  Youenn Fablet  <youenn@apple.com>

        Set defaults video getUserMedia constraints
        https://bugs.webkit.org/show_bug.cgi?id=171127

        Reviewed by Eric Carlson.

        * fast/mediastream/getUserMedia-default-expected.txt: Added.
        * fast/mediastream/getUserMedia-default.html: Added.

2017-04-24  Chris Dumez  <cdumez@apple.com>

        createElementNS() should now throw only InvalidCharacterError, not NamespaceError
        https://bugs.webkit.org/show_bug.cgi?id=171052

        Reviewed by Sam Weinig.

        Updated / rebaselined existing tests to reflect behavior change.

        * fast/dom/DOMImplementation/createDocument-namespace-err-expected.txt:
        * fast/dom/DOMImplementation/createDocumentType-err-expected.txt:
        * fast/dom/DOMImplementation/script-tests/createDocument-namespace-err.js:
        * fast/dom/DOMImplementation/script-tests/createDocumentType-err.js:
        * fast/dom/Document/createAttributeNS-namespace-err-expected.txt:
        * fast/dom/Document/createElementNS-namespace-err-expected.txt:
        * fast/dom/Document/script-tests/createAttributeNS-namespace-err.js:
        * fast/dom/Document/script-tests/createElementNS-namespace-err.js:
        * fast/dom/Element/script-tests/setAttributeNS-namespace-err.js:
        * fast/dom/Element/setAttributeNS-namespace-err-expected.txt:

2017-04-24  Chris Dumez  <cdumez@apple.com>

        REGRESSION (214503): Webkit crash under RenderElement::repaintForPausedImageAnimationsIfNeeded() when scrolling giphy pages
        https://bugs.webkit.org/show_bug.cgi?id=171243
        <rdar://problem/31715572>

        Reviewed by Antti Koivisto.

        Add layout test coverage.

        * fast/images/animated-gif-scrolling-crash-expected.txt: Added.
        * fast/images/animated-gif-scrolling-crash.html: Added.

2017-04-24  Saam Barati  <sbarati@apple.com>

        [mac debug] LayoutTest workers/wasm-long-compile-many.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=171120
        <rdar://problem/31781889>

        Rubber stamped by Mark Lam.

        Make the wasm binary we compile close to 50% smaller.

        * workers/wasm-resources/long-compile-many.js:
        (i.async.run):
        (i.worker.onmessage):
        * workers/wasm-resources/long-compile-worker.js:
        * workers/wasm-resources/long-compile.js:
        (async.run):
        (worker.onmessage):

2017-04-24  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/scrubber-support/scrubber-support-click.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171245

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-24  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/language/computed-property-names/class/static/getter-prototype.js
        https://bugs.webkit.org/show_bug.cgi?id=170897

        Reviewed by Saam Barati.

        * js/class-syntax-declaration-expected.txt:
        * js/script-tests/class-syntax-declaration.js:
        Extend tests for static and non-static methods named "constructor" and "prototype".

2017-04-24  Joseph Pecoraro  <pecoraro@apple.com>

        Address some FIXMEs in JavaScript tests for bugs that have been fixed
        https://bugs.webkit.org/show_bug.cgi?id=171191

        Reviewed by JF Bastien.

        * js/dom/custom-constructors-expected.txt:
        * js/dom/script-tests/custom-constructors.js:
        * js/script-tests/keyword-method-names.js:

2017-04-24  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/language/expressions/generators/yield-as-label.js
        https://bugs.webkit.org/show_bug.cgi?id=170979

        Reviewed by Saam Barati.

        * js/object-literal-shorthand-construction-expected.txt:
        * js/script-tests/object-literal-shorthand-construction.js:
        Extend this test to cover object literal shorthand with keywords.

        * js/dom/reserved-words-as-property-expected.txt:
        * js/let-syntax-expected.txt:
        * js/parser-syntax-check-expected.txt:
        Improved error messages.

2017-04-23  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r215674.
        https://bugs.webkit.org/show_bug.cgi?id=171212

        Possible unintended commit. This patch was on the wrong bug.
        (Requested by JoePeck on #webkit).

        Reverted changeset:

        "test262: test262/test/language/expressions/generators/yield-
        as-label.js"
        https://bugs.webkit.org/show_bug.cgi?id=170979
        http://trac.webkit.org/changeset/215674

2017-04-23  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/language/expressions/generators/yield-as-label.js
        https://bugs.webkit.org/show_bug.cgi?id=170979

        Reviewed by Saam Barati.

        * js/object-literal-shorthand-construction-expected.txt:
        * js/script-tests/object-literal-shorthand-construction.js:
        Extend this test to cover object literal shorthand with keywords.

        * js/dom/reserved-words-as-property-expected.txt:
        * js/let-syntax-expected.txt:
        * js/parser-syntax-check-expected.txt:
        Improved error messages.

2017-04-21  Zalan Bujtas  <zalan@apple.com>

        REGRESSION(r205374): <li> content inside <ul> should mid-word wrap when word-break: break-word is present.
        https://bugs.webkit.org/show_bug.cgi?id=171108
        <rdar://problem/30271747>

        Reviewed by Dan Bernstein.

        * fast/replaced/ul-li-word-break-break-word-expected.html: Added.
        * fast/replaced/ul-li-word-break-break-word.html: Added.
        * fast/replaced/zero-width-image-force-linebreak-expected.html: Added.
        * fast/replaced/zero-width-image-force-linebreak.html: Added.

2017-04-21  Aaron Chu  <aaron_chu@apple.com>

        AX: FKA: Buttons need a visible focus indicator
        https://bugs.webkit.org/show_bug.cgi?id=171040
        <rdar://problem/30922548>

        Reviewed by Antoine Quint.

        * TestExpectations:
        * media/modern-media-controls/icon-button/icon-button-focus-state-expected.txt: Added.
        * media/modern-media-controls/icon-button/icon-button-focus-state.html: Added.
        * platform/mac/TestExpectations:

2017-04-21  Ryan Haddad  <ryanhaddad@apple.com>

        Mark inspector/debugger/tail-deleted-frames-this-value.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=169119

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-21  Chris Dumez  <cdumez@apple.com>

        Regression(r206240): XMLSerializer.serializeToString() does not properly escape '<' / '>' in attribute values
        https://bugs.webkit.org/show_bug.cgi?id=171132
        <rdar://problem/31426752>

        Reviewed by Ryosuke Niwa.

        Add layout test coverage. This test is passing in both Firefox and Chrome.

        * fast/dom/XMLSerializer-serializeToString-entities-expected.txt: Added.
        * fast/dom/XMLSerializer-serializeToString-entities.html: Added.

2017-04-21  Youenn Fablet  <youenn@apple.com>

        [ios-simulator] LayoutTest webrtc/multi-video.html is a flaky crash
        https://bugs.webkit.org/show_bug.cgi?id=170823
        <rdar://problem/31611583>

        Unreviewed.

        * TestExpectations: Reactivating test.

2017-04-21  Daniel Bates  <dabates@apple.com>

        [iOS] Skip http/tests/security/contentSecurityPolicy/{audio, video}-redirect-allowed2.html
        <rdar://problem/31690952>

        Rubber-stamped by Jer Noble.

        We can enable these tests again once we fix <rdar://problem/25780035>.

        * platform/ios/TestExpectations:

2017-04-21  Per Arne Vollan  <pvollan@apple.com>

        Validate vImage arguments
        https://bugs.webkit.org/show_bug.cgi?id=171109

        Reviewed by Brent Fulgham.

        * fast/canvas/canvas-crash-expected.txt: Added.
        * fast/canvas/canvas-crash.html: Added.

2017-04-21  Ryan Haddad  <ryanhaddad@apple.com>

        Mark webrtc/datachannel/bufferedAmountLowThreshold.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170701

        Unreviewed test gardening.

        * TestExpectations:

2017-04-21  Andy VanWagoner  <thetalecrafter@gmail.com>

        [INTL] Implement Intl.DateTimeFormat.prototype.formatToParts
        https://bugs.webkit.org/show_bug.cgi?id=169458

        Reviewed by JF Bastien.

        Add tests for formatToParts

        * js/intl-datetimeformat-expected.txt:
        * js/script-tests/intl-datetimeformat.js:

2017-04-21  Timothy Horton  <timothy_horton@apple.com>

        Expose obscured insets to web content (as "safe area insets")
        https://bugs.webkit.org/show_bug.cgi?id=171013
        <rdar://problem/31564652>

        Reviewed by Wenson Hsieh and Dave Hyatt.

        * TestExpectations:
        * fast/css/variables/constants/invalid-constant-name-fallback-expected.html: Added.
        * fast/css/variables/constants/invalid-constant-name-fallback.html: Added.
        * fast/css/variables/constants/ios/safe-area-inset-set-expected.html: Added.
        * fast/css/variables/constants/ios/safe-area-inset-set.html: Added.
        * fast/css/variables/constants/safe-area-inset-cannot-override-expected.html: Added.
        * fast/css/variables/constants/safe-area-inset-cannot-override.html: Added.
        * fast/css/variables/constants/safe-area-inset-zero-expected.html: Added.
        * fast/css/variables/constants/safe-area-inset-zero.html: Added.
        * platform/ios-wk2/TestExpectations:

2017-04-20  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r215597.
        https://bugs.webkit.org/show_bug.cgi?id=171102

        Made all tests crash under GuardMalloc (Requested by ap on
        #webkit).

        Reverted changeset:

        "Expose obscured insets to web content (as "safe area
        insets")"
        https://bugs.webkit.org/show_bug.cgi?id=171013
        http://trac.webkit.org/changeset/215597

2017-04-20  Timothy Horton  <timothy_horton@apple.com>

        Expose obscured insets to web content (as "safe area insets")
        https://bugs.webkit.org/show_bug.cgi?id=171013
        <rdar://problem/31564652>

        Reviewed by Wenson Hsieh and Dave Hyatt.

        * TestExpectations:
        * fast/css/variables/constants/invalid-constant-name-fallback-expected.html: Added.
        * fast/css/variables/constants/invalid-constant-name-fallback.html: Added.
        * fast/css/variables/constants/ios/safe-area-inset-set-expected.html: Added.
        * fast/css/variables/constants/ios/safe-area-inset-set.html: Added.
        * fast/css/variables/constants/safe-area-inset-cannot-override-expected.html: Added.
        * fast/css/variables/constants/safe-area-inset-cannot-override.html: Added.
        * fast/css/variables/constants/safe-area-inset-zero-expected.html: Added.
        * fast/css/variables/constants/safe-area-inset-zero.html: Added.
        * platform/ios-wk2/TestExpectations:

2017-04-20  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/tracks-support/tracks-support-click-track-in-panel.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=169109

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-20  Ryan Haddad  <ryanhaddad@apple.com>

        Mark imported/w3c/web-platform-tests/WebCryptoAPI/sign_verify/ecdsa.worker.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170921

        Unreviewed test gardening.

        * TestExpectations:

2017-04-20  Matt Baker  <mattbaker@apple.com>

        Web Inspector: Add regular expression support to XHR breakpoints
        https://bugs.webkit.org/show_bug.cgi?id=170099
        <rdar://problem/31558082>

        Reviewed by Joseph Pecoraro.

        Update tests and expectations for new XHR breakpoint type.

        * inspector/dom-debugger/xhr-breakpoints-expected.txt:
        * inspector/dom-debugger/xhr-breakpoints.html:

2017-04-20  Wenson Hsieh  <wenson_hsieh@apple.com>

        Inline anchor elements cannot be dragged when starting the drag from a block descendant
        https://bugs.webkit.org/show_bug.cgi?id=171062
        <rdar://problem/31697835>

        Reviewed by Tim Horton.

        Adds a new test on WK1 Mac to verify that link dragging succeeds when the link's anchor element is inline and
        the drag is started from a block element under the link.

        * fast/events/drag-and-drop-link-containing-block-expected.txt: Added.
        * fast/events/drag-and-drop-link-containing-block.html: Added.
        * platform/ios/TestExpectations:
        * platform/mac-wk2/TestExpectations:

        Skip the test on iOS and Mac WK2.

2017-04-20  Aaron Chu  <aaron_chu@apple.com>

        AX: Modern Media Controls Timeline slider should be operable
        https://bugs.webkit.org/show_bug.cgi?id=170250

        Reviewed by Antoine Quint.

        * media/modern-media-controls/scrubber/scrubber-has-correct-ax-label-expected.txt: Added.
        * media/modern-media-controls/scrubber/scrubber-has-correct-ax-label.html: Added.

2017-04-18  Filip Pizlo  <fpizlo@apple.com>

        Optimize SharedArrayBuffer in the DFG+FTL
        https://bugs.webkit.org/show_bug.cgi?id=164108

        Reviewed by Saam Barati.
        
        Add a test of futex performance.

        * workers/sab/cascade_lock-worker.js: Added.
        (onmessage):
        * workers/sab/cascade_lock.html: Added.
        * workers/sab/worker-resources.js:
        (cascadeLockSlow):
        (cascadeLock):
        (cascadeUnlock):

2017-04-20  Jon Lee  <jonlee@apple.com>

        Update pip placard to "picture in picture"
        https://bugs.webkit.org/show_bug.cgi?id=171036
        rdar://problem/30201536

        Reviewed by Antoine Quint.

        * media/modern-media-controls/pip-placard/pip-placard-expected.txt: Updated expected results.
        * media/modern-media-controls/pip-placard/pip-placard.html:

2017-04-20  Ryan Haddad  <ryanhaddad@apple.com>

        Mark two crypto/subtle/ecdsa LayoutTests as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171059

        Unreviewed test gardening.

        * TestExpectations:

2017-04-20  Ryan Haddad  <ryanhaddad@apple.com>

        Mark memory/memory-pressure-simulation.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170629

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-04-20  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        [GTK] Update layout tests expectations after r215556
        https://bugs.webkit.org/show_bug.cgi?id=170942

        Unreviewed gardening.

        * platform/gtk/TestExpectations:

2017-04-20  Youenn Fablet  <youenn@apple.com>

        RTCPeerConnection is stopping its backend twice sometimes
        https://bugs.webkit.org/show_bug.cgi?id=171043

        Reviewed by Eric Carlson.

        * webrtc/closing-peerconnection-expected.txt: Added.
        * webrtc/closing-peerconnection.html: Added.

2017-04-20  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] Implement support for DPub ARIA roles
        https://bugs.webkit.org/show_bug.cgi?id=170679

        Reviewed by Chris Fleizach.

        Update tests and expectations to reflect the modified WebCore Accessibility
        role mappings, and the corresponding changes for the platforms.

        * accessibility/gtk/xml-roles-exposed-expected.txt:
        * accessibility/gtk/xml-roles-exposed.html:
        * accessibility/roles-exposed.html:
        * inspector/dom/getAccessibilityPropertiesForNode-expected.txt:
        * platform/gtk/TestExpectations:
        * platform/gtk/accessibility/roles-exposed-expected.txt:
        * platform/mac/accessibility/roles-exposed-expected.txt:

2017-04-19  Ryan Haddad  <ryanhaddad@apple.com>

        Mark imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/hkdf.worker.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170907

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-04-19  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline imported/w3c/web-platform-tests/html/dom/reflection-embedded.html.

        Unreviewed test gardening.

        * platform/ios-wk2/imported/w3c/web-platform-tests/html/dom/reflection-embedded-expected.txt:

2017-04-19  Ryan Haddad  <ryanhaddad@apple.com>

        Mark imported/w3c/web-platform-tests/XMLHttpRequest/getallresponseheaders-cl.htm as failing.
        https://bugs.webkit.org/show_bug.cgi?id=171031

        Unreviewed test gardening.

        * TestExpectations:

2017-04-19  Ryan Haddad  <ryanhaddad@apple.com>

        Remove two tests after r215515.
        https://bugs.webkit.org/show_bug.cgi?id=171014

        Unreviewed test gardening.

        * TestExpectations:

2017-04-19  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline tests after r215515.
        https://bugs.webkit.org/show_bug.cgi?id=171014

        Unreviewed test gardening.

        * TestExpectations:
        * platform/ios-wk2/imported/w3c/web-platform-tests/html/dom/reflection-embedded-expected.txt:
        * platform/ios/imported/w3c/web-platform-tests/html/browsers/browsing-the-web/history-traversal/persisted-user-state-restoration/scroll-restoration-fragment-scrolling-cross-origin-expected.txt:
        * platform/ios/imported/w3c/web-platform-tests/html/dom/reflection-embedded-expected.txt:

2017-04-19  Alex Christensen  <achristensen@webkit.org>

        Parsing large XML strings fails
        https://bugs.webkit.org/show_bug.cgi?id=170999
        <rdar://problem/17336267>

        Reviewed by Brady Eidson.

        * fast/dom/xml-large-expected.txt: Added.
        * fast/dom/xml-large.html: Added.

2017-04-19  Chris Fleizach  <cfleizach@apple.com>

        AX: <hr> should use a different role description than interactive separators
        https://bugs.webkit.org/show_bug.cgi?id=170317
        <rdar://problem/31363024>

        Reviewed by Joanmarie Diggs.

        * accessibility/mac/hr-element-expected.txt:
        * accessibility/mac/hr-element.html:

2017-04-19  JF Bastien  <jfbastien@apple.com>

        Unreviewed, rolling out r215520.

        Broke Debian 8

        Reverted changeset:

        "[INTL] Implement Intl.DateTimeFormat.prototype.formatToParts"
        https://bugs.webkit.org/show_bug.cgi?id=169458
        http://trac.webkit.org/changeset/215520

2017-04-19  Andy VanWagoner  <thetalecrafter@gmail.com>

        [INTL] Implement Intl.DateTimeFormat.prototype.formatToParts
        https://bugs.webkit.org/show_bug.cgi?id=169458

        Reviewed by JF Bastien.

        Add tests for formatToParts

        * js/intl-datetimeformat-expected.txt:
        * js/script-tests/intl-datetimeformat.js:

2017-04-19  Youenn Fablet  <youenn@apple.com>

        Import web-platform-tests/tools
        https://bugs.webkit.org/show_bug.cgi?id=170718

        Reviewed by Alex Christensen.

        * TestExpectations:
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any.worker-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any.worker-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any.worker-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/request/request-cache-only-if-cached-expected.txt: Renamed from LayoutTests/platform/mac/imported/w3c/web-platform-tests/fetch/api/request/request-cache-only-if-cached-expected.txt.
        * tests-options.json:

2017-04-19  Antti Koivisto  <antti@apple.com>

        Avoid repaints for invisible animations on tumblr.com/search/aww
        https://bugs.webkit.org/show_bug.cgi?id=170986
        <rdar://problem/28644580>

        Reviewed by Andreas Kling.

        * fast/repaint/mutate-non-visible-expected.txt: Added.
        * fast/repaint/mutate-non-visible.html: Added.

2017-04-18  John Wilander  <wilander@apple.com>

        Resource Load Statistics: Check both origins and cookieHostNames for domain matches in data removal
        https://bugs.webkit.org/show_bug.cgi?id=170763
        <rdar://problem/31573091>

        Reviewed by Alex Christensen.

        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-deletion-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-deletion.html: Added.

2017-04-18  Dean Jackson  <dino@apple.com>

        Update ANGLE
        https://bugs.webkit.org/show_bug.cgi?id=170941
        <rdar://problem/31633999>

        Reviewed by Alex Christensen.

        * fast/canvas/webgl/fragment-shader-assertion-expected.txt:

2017-04-18  Brent Fulgham  <bfulgham@apple.com>

        Correct handling of isolatedWorld in event handling
        https://bugs.webkit.org/show_bug.cgi?id=65589
        <rdar://problem/24097804>

        Reviewed by Geoffrey Garen.

        This following test cases are from the following Blink change:
        https://src.chromium.org/viewvc/blink?revision=152377&view=revision

        * fast/dom/event-attrs-isolated-world-expected.txt: Added.
        * fast/dom/event-attrs-isolated-world.html: Added.
        * http/tests/security/isolatedWorld/onclick-attribute-expected.txt: Added.
        * http/tests/security/isolatedWorld/onclick-attribute.html: Added.

2017-04-18  Wenson Hsieh  <wenson_hsieh@apple.com>

        [WK2] Cannot select text on nytimes.com when the selection granularity is WKSelectionGranularityCharacter
        https://bugs.webkit.org/show_bug.cgi?id=170968
        <rdar://problem/31692560>

        Reviewed by Dan Bernstein.

        Adds a new layout test checking that text within a node with a click handler can be selected when using
        character selection granularity.

        * editing/selection/character-granularity-select-text-with-click-handler-expected.txt: Added.
        * editing/selection/character-granularity-select-text-with-click-handler.html: Added.

2017-04-18  Joseph Pecoraro  <pecoraro@apple.com>

        [mac-wk1 Debug] LayoutTest http/tests/inspector/network/resource-sizes-network.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170953

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:
        Mark a flakey test in WebKit1.

2017-04-17  Sam Weinig  <sam@webkit.org>

        [WebIDL] Make annotated types first class allowing them to be used in sequences and unions
        https://bugs.webkit.org/show_bug.cgi?id=170926

        Reviewed by Chris Dumez.

        * js/dom/webidl-type-mapping-expected.txt:
        * js/dom/webidl-type-mapping.html:
        Update test to account for testDictionary now being an attribute,
        and test that the annotated type members behave correctly.

2017-04-18  Oleksandr Skachkov  <gskachkov@gmail.com>

        [ES6]. Implement Annex B.3.3 function hoisting rules for eval
        https://bugs.webkit.org/show_bug.cgi?id=163208

        Reviewed by Saam Barati.

        * inspector/runtime/evaluate-CommandLineAPI-expected.txt:
        * inspector/runtime/evaluate-CommandLineAPI.html:
        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:

2017-04-18  Antti Koivisto  <antti@apple.com>

        Enable optimized layer flushes on iOS
        https://bugs.webkit.org/show_bug.cgi?id=170938
        <rdar://problem/31677395>

        Reviewed by Simon Fraser.

        Add test verifying that tiles get created for touch overflow scrolling.

        * compositing/ios/overflow-scroll-touch-tiles-expected.txt: Added.
        * compositing/ios/overflow-scroll-touch-tiles.html: Added.

2017-04-18  Ryan Haddad  <ryanhaddad@apple.com>

        Update TestExpectations for "selectors4" tests on mac-wk1.
        https://trac.webkit.org/changeset/215457/webkit

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-18  Manuel Rego Casasnovas  <rego@igalia.com>

        [css-grid] Add support for percentage gaps
        https://bugs.webkit.org/show_bug.cgi?id=170764

        Reviewed by Sergio Villar Senin.

        Import tests from Blink.

        * fast/css-grid-layout/grid-gutters-as-percentage-expected.txt: Added.
        * fast/css-grid-layout/grid-gutters-as-percentage.html: Added.
        * fast/css-grid-layout/grid-gutters-get-set-expected.txt:
        * fast/css-grid-layout/grid-gutters-get-set.html:

2017-04-18  Miguel Gomez  <magomez@igalia.com>

        [GTK+] Crash in WebCore::ImageFrame::ImageFrame()
        https://bugs.webkit.org/show_bug.cgi?id=170332

        Reviewed by Carlos Garcia Campos.

        Added a test to ensure that the browser doesn't crash when loading a PNG image which
        reports a wrong number of frames.

        * fast/images/bad-png-missing-fdat-expected.txt: Added.
        * fast/images/bad-png-missing-fdat.html: Added.
        * fast/images/resources/bad-png-missing-fdAT.png: Added.

2017-04-18  Manuel Rego Casasnovas  <rego@igalia.com>

        [selectors4] Import W3C Test Suite
        https://bugs.webkit.org/show_bug.cgi?id=170898

        Reviewed by Youenn Fablet.

        * TestExpectations: Mark a few tests as failure linking to the related bugs.
        * platform/mac-wk1/TestExpectations: Marking some tests that have issues on WK1.

2017-04-18  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Add several test expectations.

        * platform/gtk/TestExpectations:

2017-04-17  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Doesn't show size of compressed content correctly
        https://bugs.webkit.org/show_bug.cgi?id=155112
        <rdar://problem/25006728>

        Reviewed by Alex Christensen and Timothy Hatcher.

        * http/tests/inspector/network/resource-sizes-disk-cache-expected.txt: Added.
        * http/tests/inspector/network/resource-sizes-disk-cache.html: Added.
        * http/tests/inspector/network/resource-sizes-memory-cache-expected.txt: Added.
        * http/tests/inspector/network/resource-sizes-memory-cache.html: Added.
        * http/tests/inspector/network/resource-sizes-network-expected.txt: Added.
        * http/tests/inspector/network/resource-sizes-network.html: Added.
        Test resource sizes under different load conditions.

        * platform/mac/http/tests/inspector/network/resource-sizes-memory-cache-expected.txt: Added.
        * platform/mac/http/tests/inspector/network/resource-sizes-network-expected.txt: Added.
        Older versions of macOS will not have the new metrics, but test their output anyways.

        * http/tests/inspector/network/resources/404.php: Added.
        * http/tests/inspector/network/resources/gzipped-lorem-no-content-length.php: Added.
        * http/tests/inspector/network/resources/gzipped-lorem.php: Added.
        * http/tests/inspector/network/resources/lorem.txt: Added.
        Different resources with fixed sizes (text, gzipped, 404 with fixed response).

        * http/tests/inspector/network/resources/resource-size-test.js: Added.
        (TestPage.registerInitializer.InspectorTest.gracefulExpectEquals):
        (TestPage.registerInitializer.window.addResourceSizeTest):
        (TestPage.registerInitializer):
        Shared test code for resource sizes.

        * platform/mac-wk1/TestExpectations:
        * platform/win/TestExpectations:

2017-04-17  Youenn Fablet  <youenn@apple.com>

        Enable video autoplay when getUserMedia is on
        https://bugs.webkit.org/show_bug.cgi?id=170919

        Reviewed by Geoffrey Garen.

        * webrtc/video-autoplay-expected.txt: Added.
        * webrtc/video-autoplay.html: Added.

2017-04-17  Ryan Haddad  <ryanhaddad@apple.com>

        Skip webrtc/multi-video.html.
        https://bugs.webkit.org/show_bug.cgi?id=170823

        Unreviewed test gardening.

        * TestExpectations:

2017-04-17  Youenn Fablet  <youenn@apple.com>

        LayoutTest webrtc/video-mute.html is a flaky failure
        https://bugs.webkit.or
        g/show_bug.cgi?id=170704

        Reviewed by Eric Carlson.

        * webrtc/video-mute.html: Another try at making the test not flaky.

2017-04-17  Tim Horton  <timothy_horton@apple.com>

        Provide a viewport parameter to disable clipping to the safe area
        https://bugs.webkit.org/show_bug.cgi?id=170766
        <rdar://problem/31564634>

        Reviewed by Beth Dakin.

        * tiled-drawing/ios/viewport-clip-to-safe-area-no-gets-margin-tiles-expected.txt: Added.
        * tiled-drawing/ios/viewport-clip-to-safe-area-no-gets-margin-tiles.html: Added.
        * tiled-drawing/ios/viewport-clip-to-safe-area-yes-gets-no-margin-tiles-expected.txt: Added.
        * tiled-drawing/ios/viewport-clip-to-safe-area-yes-gets-no-margin-tiles.html: Added.

2017-04-14  Jiewen Tan  <jiewen_tan@apple.com>

        [WebCrypto] Add support for ECDSA
        https://bugs.webkit.org/show_bug.cgi?id=170789
        <rdar://problem/31588604>

        Reviewed by Brent Fulgham.

        * crypto/subtle/ec-generate-key-malformed-parameters-expected.txt:
        * crypto/subtle/ec-generate-key-malformed-parameters.html:
        * crypto/subtle/ec-import-key-malformed-parameters-expected.txt:
        * crypto/subtle/ec-import-key-malformed-parameters.html:
        * crypto/subtle/ecdh-generate-export-key-pkcs8-p256-expected.txt: Renamed from LayoutTests/crypto/subtle/ecdh-generate-export-pkcs8-p256-expected.txt.
        * crypto/subtle/ecdh-generate-export-key-pkcs8-p256.html: Renamed from LayoutTests/crypto/subtle/ecdh-generate-export-pkcs8-p256.html.
        * crypto/subtle/ecdh-generate-export-key-pkcs8-p384-expected.txt: Renamed from LayoutTests/crypto/subtle/ecdh-generate-export-pkcs8-p384-expected.txt.
        * crypto/subtle/ecdh-generate-export-key-pkcs8-p384.html: Renamed from LayoutTests/crypto/subtle/ecdh-generate-export-pkcs8-p384.html.
        * crypto/subtle/ecdsa-generate-export-jwk-key-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-export-jwk-key.html: Added.
        * crypto/subtle/ecdsa-generate-export-key-pkcs8-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-export-key-pkcs8.html: Added.
        * crypto/subtle/ecdsa-generate-export-key-raw-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-export-key-raw.html: Added.
        * crypto/subtle/ecdsa-generate-export-key-spki-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-export-key-spki.html: Added.
        * crypto/subtle/ecdsa-generate-key-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-key-sign-verify-p256-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-key-sign-verify-p256.html: Added.
        * crypto/subtle/ecdsa-generate-key-sign-verify-p384-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-key-sign-verify-p384.html: Added.
        * crypto/subtle/ecdsa-generate-key.html: Added.
        * crypto/subtle/ecdsa-import-jwk-private-key-expected.txt: Added.
        * crypto/subtle/ecdsa-import-jwk-private-key.html: Added.
        * crypto/subtle/ecdsa-import-jwk-public-key-alg-256-expected.txt: Added.
        * crypto/subtle/ecdsa-import-jwk-public-key-alg-256.html: Added.
        * crypto/subtle/ecdsa-import-jwk-public-key-alg-384-expected.txt: Added.
        * crypto/subtle/ecdsa-import-jwk-public-key-alg-384.html: Added.
        * crypto/subtle/ecdsa-import-jwk-public-key-expected.txt: Added.
        * crypto/subtle/ecdsa-import-jwk-public-key.html: Added.
        * crypto/subtle/ecdsa-import-key-sign-p256-expected.txt: Added.
        * crypto/subtle/ecdsa-import-key-sign-p256.html: Added.
        * crypto/subtle/ecdsa-import-key-sign-p384-expected.txt: Added.
        * crypto/subtle/ecdsa-import-key-sign-p384.html: Added.
        * crypto/subtle/ecdsa-import-key-verify-p256-expected.txt: Added.
        * crypto/subtle/ecdsa-import-key-verify-p256.html: Added.
        * crypto/subtle/ecdsa-import-key-verify-p384-expected.txt: Added.
        * crypto/subtle/ecdsa-import-key-verify-p384.html: Added.
        * crypto/subtle/ecdsa-import-pkcs8-key-expected.txt: Added.
        * crypto/subtle/ecdsa-import-pkcs8-key.html: Added.
        * crypto/subtle/ecdsa-import-raw-key-expected.txt: Added.
        * crypto/subtle/ecdsa-import-raw-key.html: Added.
        * crypto/subtle/ecdsa-import-spki-key-expected.txt: Added.
        * crypto/subtle/ecdsa-import-spki-key.html: Added.
        * crypto/subtle/ecdsa-verify-malformed-parameters-expected.txt: Added.
        * crypto/subtle/ecdsa-verify-malformed-parameters.html: Added.
        * crypto/workers/subtle/ecdsa-import-key-sign-expected.txt: Added.
        * crypto/workers/subtle/ecdsa-import-key-sign.html: Added.
        * crypto/workers/subtle/ecdsa-import-key-verify-expected.txt: Added.
        * crypto/workers/subtle/ecdsa-import-key-verify.html: Added.
        * crypto/workers/subtle/resources/ecdsa-import-key-sign.js: Added.
        * crypto/workers/subtle/resources/ecdsa-import-key-verify.js: Added.

2017-04-17  Youenn Fablet  <youenn@apple.com>

        LayoutTestwebrtc/audio-replace-track.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170837

        Reviewed by Eric Carlson.

        * webrtc/audio-replace-track.html: Updating the test to be less flaky.

2017-04-17  Youenn Fablet  <youenn@apple.com>

        RTCPeerConnection addTrack does not require a stream parameter
        https://bugs.webkit.org/show_bug.cgi?id=170894

        Reviewed by Alex Christensen.

        * webrtc/video-addTrack-expected.txt: Added.
        * webrtc/video-addTrack.html: Added.

2017-04-16  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/built-ins/Object/prototype/toLocaleString/primitive_this_value.js
        https://bugs.webkit.org/show_bug.cgi?id=170882

        Reviewed by Saam Barati.

        * js/dom/object-prototype-toLocaleString-expected.txt:
        * js/dom/script-tests/object-prototype-toLocaleString.js:
        Test the case of toLocaleString where toString does not exist.

2017-04-16  Chris Dumez  <cdumez@apple.com>

        CMD+R / CMD+Q is considered as user interaction and beforeunload alert is shown
        https://bugs.webkit.org/show_bug.cgi?id=169995
        <rdar://problem/23798897>

        Reviewed by Sam Weinig.

        Add layout test coverage.

        * fast/events/beforeunload-alert-handled-keydown-expected.txt: Added.
        * fast/events/beforeunload-alert-handled-keydown.html: Added.
        * fast/events/beforeunload-alert-unhandled-keydown-expected.txt: Added.
        * fast/events/beforeunload-alert-unhandled-keydown.html: Added.

2017-04-16  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/built-ins/Object/getOwnPropertyNames/15.2.3.4-4-44.js
        https://bugs.webkit.org/show_bug.cgi?id=170879

        Reviewed by Saam Barati.

        * js/Object-getOwnPropertyNames-expected.txt:
        * js/script-tests/Object-getOwnPropertyNames.js:

2017-04-14  Nikita Vasilyev  <nvasilyev@apple.com>

        Web Inspector: WebSockets: messages with non-latin letters are displayed incorrectly
        https://bugs.webkit.org/show_bug.cgi?id=170760

        Reviewed by Joseph Pecoraro.

        Test sending and receiving text and binary (blob and array buffer) data.

        * http/tests/websocket/tests/hybi/inspector/binary-expected.txt: Added.
        * http/tests/websocket/tests/hybi/inspector/binary.html: Added.
        * http/tests/websocket/tests/hybi/inspector/binary_wsh.py: Added.
        (web_socket_do_extra_handshake):
        (web_socket_transfer_data):
        (all_distinct_bytes):
        * http/tests/websocket/tests/hybi/inspector/send-and-receive-expected.txt: Added.
        * http/tests/websocket/tests/hybi/inspector/send-and-receive.html: Added.
        * http/tests/websocket/tests/hybi/inspector/send-and-receive_wsh.py: Added.
        (web_socket_do_extra_handshake):
        (web_socket_transfer_data):

2017-04-14  Jiewen Tan  <jiewen_tan@apple.com>

        [WebCrypto] Support HKDF
        https://bugs.webkit.org/show_bug.cgi?id=170636
        <rdar://problem/23539827>

        Reviewed by Brent Fulgham.

        * TestExpectations:
        * crypto/subtle/ecdh-import-key-derive-hkdf-key-expected.txt: Added.
        * crypto/subtle/ecdh-import-key-derive-hkdf-key.html: Added.
        * crypto/subtle/hkdf-derive-bits-malformed-parametrs-expected.txt: Added.
        * crypto/subtle/hkdf-derive-bits-malformed-parametrs.html: Added.
        * crypto/subtle/hkdf-import-key-derive-bits-expected.txt: Added.
        * crypto/subtle/hkdf-import-key-derive-bits.html: Added.
        * crypto/subtle/hkdf-import-key-derive-hmac-key-expected.txt: Added.
        * crypto/subtle/hkdf-import-key-derive-hmac-key.html: Added.
        * crypto/subtle/hkdf-import-key-expected.txt: Added.
        * crypto/subtle/hkdf-import-key-malformed-parameters-expected.txt: Added.
        * crypto/subtle/hkdf-import-key-malformed-parameters.html: Added.
        * crypto/subtle/hkdf-import-key.html: Added.
        * crypto/workers/subtle/hkdf-import-key-derive-bits-expected.txt: Added.
        * crypto/workers/subtle/hkdf-import-key-derive-bits.html: Added.
        * crypto/workers/subtle/hkdf-import-key-derive-hmac-key-expected.txt: Added.
        * crypto/workers/subtle/hkdf-import-key-derive-hmac-key.html: Added.
        * crypto/workers/subtle/hkdf-import-key-expected.txt: Added.
        * crypto/workers/subtle/hkdf-import-key.html: Added.
        * crypto/workers/subtle/resources/hkdf-import-key-derive-bits.js: Added.
        * crypto/workers/subtle/resources/hkdf-import-key-derive-hmac-key.js: Added.
        * crypto/workers/subtle/resources/hkdf-import-key.js: Added.

2017-04-14  Ryan Haddad  <ryanhaddad@apple.com>

        Skip workers/wasm-* LayoutTests on ios-simulator.

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-04-14  Zalan Bujtas  <zalan@apple.com>

        text-align start / end failure in table cells
        https://bugs.webkit.org/show_bug.cgi?id=141417
        <rdar://problem/31051672>

        Reviewed by Antti Koivisto.

        * fast/table/center-th-when-parent-has-initial-text-align-expected.html: Added.
        * fast/table/center-th-when-parent-has-initial-text-align.html: Added.

2017-04-13  Saam Barati  <sbarati@apple.com>

        WebAssembly: We should be able to postMessage a JSWebAssemblyModule
        https://bugs.webkit.org/show_bug.cgi?id=170573

        Reviewed by Filip Pizlo.

        * storage/indexeddb/resources/wasm-exceptions.js: Added.
        (const._fail):
        (const.isNotA.assert.isNotA):
        (const):
        (switch.typeof):
        (Builder):
        (Builder.prototype.setChecked):
        (Builder.prototype.setPreamble):
        (Builder.prototype._functionIndexSpaceKeyHash):
        (Builder.prototype._registerFunctionToIndexSpace):
        (Builder.prototype._getFunctionFromIndexSpace):
        (Builder.prototype._registerSectionBuilders.const.section.in.WASM.description.section.switch.section.case.string_appeared_here.this.section):
        (Builder.prototype._registerSectionBuilders.const.section.in.WASM.description.section.switch.section.const.codeBuilder.End.switch.case.string_appeared_here.e):
        (Builder.prototype._registerSectionBuilders.this.Unknown):
        (prepareDatabase):
        (testDatabase):
        * storage/indexeddb/wasm-exceptions-expected.txt: Added.
        * storage/indexeddb/wasm-exceptions.html: Added.
        * workers/wasm-hashset: Added.
        * workers/wasm-hashset-expected.txt: Added.
        * workers/wasm-hashset-many-expected.txt: Added.
        * workers/wasm-hashset-many.html: Added.
        * workers/wasm-hashset.html: Added.
        * workers/wasm-hashset/many-test.js: Added.
        (reallyDone):
        (console.log):
        (console.error):
        (console.assert):
        (i.worker.onmessage):
        (Module.print):
        (Module.printErr):
        (Module.canvas):
        (Module.setStatus):
        (Module):
        (setValue):
        (getValue):
        (allocate):
        (getMemory):
        (Pointer_stringify):
        (AsciiToString):
        (stringToAscii):
        (UTF8ArrayToString):
        (UTF8ToString):
        (stringToUTF8Array):
        (stringToUTF8):
        (lengthBytesUTF8):
        (demangle):
        (demangleAll):
        (stackTrace):
        (alignUp):
        (updateGlobalBuffer):
        (updateGlobalBufferViews):
        (abortOnCannotGrowMemory):
        (enlargeMemory):
        (getTotalMemory):
        (callRuntimeCallbacks):
        (preRun):
        (ensureInitRuntime):
        (preMain):
        (exitRuntime):
        (postRun):
        (addOnPreRun):
        (addOnInit):
        (addOnPreMain):
        (addOnExit):
        (addOnPostRun):
        (intArrayFromString):
        (intArrayToString):
        (writeStringToMemory):
        (writeArrayToMemory):
        (writeAsciiToMemory):
        (Math.string_appeared_here):
        (addRunDependency):
        (removeRunDependency):
        (integrateWasmJS.asm2wasmImports.string_appeared_here):
        (integrateWasmJS.lookupImport):
        (integrateWasmJS.mergeMemory):
        (integrateWasmJS.fixImports):
        (integrateWasmJS.getBinary):
        (integrateWasmJS.doJustAsm):
        (integrateWasmJS.receiveInstance):
        (integrateWasmJS.):
        (integrateWasmJS.doNativeWasm):
        (integrateWasmJS.doWasmPolyfill):
        (integrateWasmJS.Module.string_appeared_here):
        (integrateWasmJS):
        (___setErrNo):
        (__ZSt18uncaught_exceptionv):
        (EXCEPTIONS.deAdjust):
        (EXCEPTIONS.addRef):
        (EXCEPTIONS.decRef):
        (EXCEPTIONS.clearRef):
        (___cxa_find_matching_catch):
        (___gxx_personality_v0):
        (___lock):
        (_emscripten_memcpy_big):
        (_gettimeofday):
        (_abort):
        (SYSCALLS):
        (SYSCALLS.get getStr):
        (SYSCALLS.get64):
        (SYSCALLS.getZero):
        (try.___syscall146.printChar):
        (___syscall146):
        (___syscall54):
        (___unlock):
        (___syscall6):
        (invoke_ii):
        (invoke_iiii):
        (invoke_v):
        (_malloc.Module.string_appeared_here):
        (getTempRet0.Module.string_appeared_here):
        (_free.Module.string_appeared_here):
        (_main.Module.string_appeared_here):
        (setTempRet0.Module.string_appeared_here):
        (establishStackSpace.Module.string_appeared_here):
        (stackSave.Module.string_appeared_here):
        (_memset.Module.string_appeared_here):
        (_sbrk.Module.string_appeared_here):
        (_emscripten_get_global_libc.Module.string_appeared_here):
        (_memcpy.Module.string_appeared_here):
        (___errno_location.Module.string_appeared_here):
        (setThrew.Module.string_appeared_here):
        (_fflush.Module.string_appeared_here):
        (stackAlloc.Module.string_appeared_here):
        (stackRestore.Module.string_appeared_here):
        (_llvm_bswap_i32.Module.string_appeared_here):
        (runPostSets.Module.string_appeared_here):
        (dynCall_ii.Module.string_appeared_here):
        (dynCall_iiii.Module.string_appeared_here):
        (dynCall_v.Module.string_appeared_here):
        (else.applyMemoryInitializer):
        (else):
        (else.useRequest):
        (ExitStatus):
        (dependenciesFulfilled):
        (Module.string_appeared_here.Module.callMain.callMain.pad):
        (Module.string_appeared_here.Module.callMain):
        (run.doRun):
        (run):
        (exit):
        * workers/wasm-hashset/many-worker.js: Added.
        (console.log):
        (console.error):
        (console.assert):
        (Module.print):
        (Module.printErr):
        (Module.canvas):
        (Module.setStatus):
        (Module):
        (setValue):
        (getValue):
        (allocate):
        (getMemory):
        (Pointer_stringify):
        (AsciiToString):
        (stringToAscii):
        (UTF8ArrayToString):
        (UTF8ToString):
        (stringToUTF8Array):
        (stringToUTF8):
        (lengthBytesUTF8):
        (demangle):
        (demangleAll):
        (stackTrace):
        (alignUp):
        (updateGlobalBuffer):
        (updateGlobalBufferViews):
        (abortOnCannotGrowMemory):
        (enlargeMemory):
        (getTotalMemory):
        (callRuntimeCallbacks):
        (preRun):
        (ensureInitRuntime):
        (preMain):
        (exitRuntime):
        (postRun):
        (addOnPreRun):
        (addOnInit):
        (addOnPreMain):
        (addOnExit):
        (addOnPostRun):
        (intArrayFromString):
        (intArrayToString):
        (writeStringToMemory):
        (writeArrayToMemory):
        (writeAsciiToMemory):
        (Math.string_appeared_here):
        (addRunDependency):
        (removeRunDependency):
        (integrateWasmJS.asm2wasmImports.string_appeared_here):
        (integrateWasmJS.lookupImport):
        (integrateWasmJS.mergeMemory):
        (integrateWasmJS.fixImports):
        (integrateWasmJS.getBinary):
        (integrateWasmJS.doJustAsm):
        (integrateWasmJS.receiveInstance):
        (integrateWasmJS.doNativeWasm):
        (integrateWasmJS.doWasmPolyfill):
        (integrateWasmJS.Module.string_appeared_here):
        (integrateWasmJS):
        (___setErrNo):
        (__ZSt18uncaught_exceptionv):
        (EXCEPTIONS.deAdjust):
        (EXCEPTIONS.addRef):
        (EXCEPTIONS.decRef):
        (EXCEPTIONS.clearRef):
        (___cxa_find_matching_catch):
        (___gxx_personality_v0):
        (___lock):
        (_emscripten_memcpy_big):
        (_gettimeofday):
        (_abort):
        (SYSCALLS):
        (SYSCALLS.get getStr):
        (SYSCALLS.get64):
        (SYSCALLS.getZero):
        (try.___syscall146.printChar):
        (___syscall146):
        (___syscall54):
        (___unlock):
        (___syscall6):
        (invoke_ii):
        (invoke_iiii):
        (invoke_v):
        (_malloc.Module.string_appeared_here):
        (getTempRet0.Module.string_appeared_here):
        (_free.Module.string_appeared_here):
        (_main.Module.string_appeared_here):
        (setTempRet0.Module.string_appeared_here):
        (establishStackSpace.Module.string_appeared_here):
        (stackSave.Module.string_appeared_here):
        (_memset.Module.string_appeared_here):
        (_sbrk.Module.string_appeared_here):
        (_emscripten_get_global_libc.Module.string_appeared_here):
        (_memcpy.Module.string_appeared_here):
        (___errno_location.Module.string_appeared_here):
        (setThrew.Module.string_appeared_here):
        (_fflush.Module.string_appeared_here):
        (stackAlloc.Module.string_appeared_here):
        (stackRestore.Module.string_appeared_here):
        (_llvm_bswap_i32.Module.string_appeared_here):
        (runPostSets.Module.string_appeared_here):
        (dynCall_ii.Module.string_appeared_here):
        (dynCall_iiii.Module.string_appeared_here):
        (dynCall_v.Module.string_appeared_here):
        (else.applyMemoryInitializer):
        (else):
        (else.useRequest):
        (ExitStatus):
        (dependenciesFulfilled):
        (Module.string_appeared_here.Module.callMain.callMain.pad):
        (Module.string_appeared_here.Module.callMain):
        (run.doRun):
        (run):
        (exit):
        * workers/wasm-hashset/test.js: Added.
        (reallyDone):
        (console.log):
        (console.error):
        (console.assert):
        (Module.print):
        (Module.printErr):
        (Module.canvas):
        (Module.setStatus):
        (Module):
        (setValue):
        (getValue):
        (allocate):
        (getMemory):
        (Pointer_stringify):
        (AsciiToString):
        (stringToAscii):
        (UTF8ArrayToString):
        (UTF8ToString):
        (stringToUTF8Array):
        (stringToUTF8):
        (lengthBytesUTF8):
        (demangle):
        (demangleAll):
        (stackTrace):
        (alignUp):
        (updateGlobalBuffer):
        (updateGlobalBufferViews):
        (abortOnCannotGrowMemory):
        (enlargeMemory):
        (getTotalMemory):
        (callRuntimeCallbacks):
        (preRun):
        (ensureInitRuntime):
        (preMain):
        (exitRuntime):
        (postRun):
        (addOnPreRun):
        (addOnInit):
        (addOnPreMain):
        (addOnExit):
        (addOnPostRun):
        (intArrayFromString):
        (intArrayToString):
        (writeStringToMemory):
        (writeArrayToMemory):
        (writeAsciiToMemory):
        (Math.string_appeared_here):
        (addRunDependency):
        (removeRunDependency):
        (integrateWasmJS.asm2wasmImports.string_appeared_here):
        (integrateWasmJS.lookupImport):
        (integrateWasmJS.mergeMemory):
        (integrateWasmJS.fixImports):
        (integrateWasmJS.getBinary):
        (integrateWasmJS.doJustAsm):
        (integrateWasmJS.receiveInstance):
        (integrateWasmJS.doNativeWasm):
        (integrateWasmJS.doWasmPolyfill):
        (integrateWasmJS.Module.string_appeared_here):
        (integrateWasmJS):
        (___setErrNo):
        (__ZSt18uncaught_exceptionv):
        (EXCEPTIONS.deAdjust):
        (EXCEPTIONS.addRef):
        (EXCEPTIONS.decRef):
        (EXCEPTIONS.clearRef):
        (___cxa_find_matching_catch):
        (___gxx_personality_v0):
        (___lock):
        (_emscripten_memcpy_big):
        (_gettimeofday):
        (_abort):
        (SYSCALLS):
        (SYSCALLS.get getStr):
        (SYSCALLS.get64):
        (SYSCALLS.getZero):
        (try.___syscall146.printChar):
        (___syscall146):
        (___syscall54):
        (___unlock):
        (___syscall6):
        (invoke_ii):
        (invoke_iiii):
        (invoke_v):
        (_malloc.Module.string_appeared_here):
        (getTempRet0.Module.string_appeared_here):
        (_free.Module.string_appeared_here):
        (_main.Module.string_appeared_here):
        (setTempRet0.Module.string_appeared_here):
        (establishStackSpace.Module.string_appeared_here):
        (stackSave.Module.string_appeared_here):
        (_memset.Module.string_appeared_here):
        (_sbrk.Module.string_appeared_here):
        (_emscripten_get_global_libc.Module.string_appeared_here):
        (_memcpy.Module.string_appeared_here):
        (___errno_location.Module.string_appeared_here):
        (setThrew.Module.string_appeared_here):
        (_fflush.Module.string_appeared_here):
        (stackAlloc.Module.string_appeared_here):
        (stackRestore.Module.string_appeared_here):
        (_llvm_bswap_i32.Module.string_appeared_here):
        (runPostSets.Module.string_appeared_here):
        (dynCall_ii.Module.string_appeared_here):
        (dynCall_iiii.Module.string_appeared_here):
        (dynCall_v.Module.string_appeared_here):
        (else.applyMemoryInitializer):
        (else):
        (else.useRequest):
        (ExitStatus):
        (dependenciesFulfilled):
        (Module.string_appeared_here.Module.callMain.callMain.pad):
        (Module.string_appeared_here.Module.callMain):
        (run.doRun):
        (run):
        (exit):
        * workers/wasm-hashset/worker.js: Added.
        (console.log):
        (console.error):
        (console.assert):
        (Module.print):
        (Module.printErr):
        (Module.canvas):
        (Module.setStatus):
        (Module):
        (setValue):
        (getValue):
        (allocate):
        (getMemory):
        (Pointer_stringify):
        (AsciiToString):
        (stringToAscii):
        (UTF8ArrayToString):
        (UTF8ToString):
        (stringToUTF8Array):
        (stringToUTF8):
        (lengthBytesUTF8):
        (demangle):
        (demangleAll):
        (stackTrace):
        (alignUp):
        (updateGlobalBuffer):
        (updateGlobalBufferViews):
        (abortOnCannotGrowMemory):
        (enlargeMemory):
        (getTotalMemory):
        (callRuntimeCallbacks):
        (preRun):
        (ensureInitRuntime):
        (preMain):
        (exitRuntime):
        (postRun):
        (addOnPreRun):
        (addOnInit):
        (addOnPreMain):
        (addOnExit):
        (addOnPostRun):
        (intArrayFromString):
        (intArrayToString):
        (writeStringToMemory):
        (writeArrayToMemory):
        (writeAsciiToMemory):
        (Math.string_appeared_here):
        (addRunDependency):
        (removeRunDependency):
        (integrateWasmJS.asm2wasmImports.string_appeared_here):
        (integrateWasmJS.lookupImport):
        (integrateWasmJS.mergeMemory):
        (integrateWasmJS.fixImports):
        (integrateWasmJS.getBinary):
        (integrateWasmJS.doJustAsm):
        (integrateWasmJS.receiveInstance):
        (integrateWasmJS.):
        (integrateWasmJS.doNativeWasm):
        (integrateWasmJS.doWasmPolyfill):
        (integrateWasmJS.Module.string_appeared_here):
        (integrateWasmJS):
        (___setErrNo):
        (__ZSt18uncaught_exceptionv):
        (EXCEPTIONS.deAdjust):
        (EXCEPTIONS.addRef):
        (EXCEPTIONS.decRef):
        (EXCEPTIONS.clearRef):
        (___cxa_find_matching_catch):
        (___gxx_personality_v0):
        (___lock):
        (_emscripten_memcpy_big):
        (_gettimeofday):
        (_abort):
        (SYSCALLS):
        (SYSCALLS.get getStr):
        (SYSCALLS.get64):
        (SYSCALLS.getZero):
        (try.___syscall146.printChar):
        (___syscall146):
        (___syscall54):
        (___unlock):
        (___syscall6):
        (invoke_ii):
        (invoke_iiii):
        (invoke_v):
        (_malloc.Module.string_appeared_here):
        (getTempRet0.Module.string_appeared_here):
        (_free.Module.string_appeared_here):
        (_main.Module.string_appeared_here):
        (setTempRet0.Module.string_appeared_here):
        (establishStackSpace.Module.string_appeared_here):
        (stackSave.Module.string_appeared_here):
        (_memset.Module.string_appeared_here):
        (_sbrk.Module.string_appeared_here):
        (_emscripten_get_global_libc.Module.string_appeared_here):
        (_memcpy.Module.string_appeared_here):
        (___errno_location.Module.string_appeared_here):
        (setThrew.Module.string_appeared_here):
        (_fflush.Module.string_appeared_here):
        (stackAlloc.Module.string_appeared_here):
        (stackRestore.Module.string_appeared_here):
        (_llvm_bswap_i32.Module.string_appeared_here):
        (runPostSets.Module.string_appeared_here):
        (dynCall_ii.Module.string_appeared_here):
        (dynCall_iiii.Module.string_appeared_here):
        (dynCall_v.Module.string_appeared_here):
        (else.applyMemoryInitializer):
        (else):
        (else.useRequest):
        (ExitStatus):
        (dependenciesFulfilled):
        (Module.string_appeared_here.Module.callMain.callMain.pad):
        (Module.string_appeared_here.Module.callMain):
        (run.doRun):
        (run):
        (exit):
        * workers/wasm-long-compile-expected.txt: Added.
        * workers/wasm-long-compile-many-expected.txt: Added.
        * workers/wasm-long-compile-many.html: Added.
        * workers/wasm-long-compile.html: Added.
        * workers/wasm-resources: Added.
        * workers/wasm-resources/long-compile-many.js: Added.
        (done):
        (i.async.run):
        (i.worker.onmessage):
        * workers/wasm-resources/long-compile-worker.js: Added.
        (const._fail):
        (const.isNotA.assert.isNotA):
        (const):
        (switch.typeof):
        (Builder):
        (Builder.prototype.setChecked):
        (Builder.prototype.setPreamble):
        (Builder.prototype._functionIndexSpaceKeyHash):
        (Builder.prototype._registerFunctionToIndexSpace):
        (Builder.prototype._getFunctionFromIndexSpace):
        (Builder.prototype._registerSectionBuilders.const.section.in.WASM.description.section.switch.section.case.string_appeared_here.this.section):
        (Builder.prototype._registerSectionBuilders.const.section.in.WASM.description.section.switch.section.const.codeBuilder.End.switch.case.string_appeared_here.e):
        (Builder.prototype._registerSectionBuilders.this.Unknown):
        * workers/wasm-resources/long-compile.js: Added.
        (done):
        (async.run):
        (worker.onmessage):

2017-04-13  Dean Jackson  <dino@apple.com>

        Large negative animation-delays may not work depending on machine uptime
        https://bugs.webkit.org/show_bug.cgi?id=166962
        <rdar://problem/30091526>

        Reviewed by Tim Horton.

        * animations/large-negative-delay-expected.txt: Added.
        * animations/large-negative-delay.html: Added.

2017-04-13  Andy VanWagoner  <thetalecrafter@gmail.com>

        Change Intl prototypes to plain objects
        https://bugs.webkit.org/show_bug.cgi?id=168178

        Reviewed by JF Bastien.

        * js/intl-collator-expected.txt:
        * js/intl-datetimeformat-expected.txt:
        * js/intl-numberformat-expected.txt:
        * js/script-tests/intl-collator.js:
        * js/script-tests/intl-datetimeformat.js:
        * js/script-tests/intl-numberformat.js:

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/mediacapturefromelement/CanvasCaptureMediaStream-request-frame-events.html as flaky on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=169719

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-04-13  Antti Koivisto  <antti@apple.com>

        Don't invalidate composition for style changes in non-composited layers
        https://bugs.webkit.org/show_bug.cgi?id=170805
        <rdar://problem/31606185>

        Reviewed by Simon Fraser.

        * compositing/updates/animation-non-composited-expected.txt: Added.
        * compositing/updates/animation-non-composited.html: Added.

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark webrtc/video-mute.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170704

        Unreviewed test gardening.

        * TestExpectations:

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/media-controls-timeline-updates-when-hovered.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=165553

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/track/track-cue-rendering-rtl.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170831

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark inspector/sampling-profiler/named-function-expression.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170830

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Add ios-simulator baseline for imported/w3c/web-platform-tests/fetch/api/request/request-cache-only-if-cached.html.

        Unreviewed test gardening.

        * platform/ios-simulator/imported/w3c/web-platform-tests/fetch/api/request/request-cache-only-if-cached-expected.txt: Added.

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/inspector/network/resource-request-headers.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170702

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/volume-support/volume-support-click.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=164229

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-13  Chris Dumez  <cdumez@apple.com>

        LayoutTest svg/animations/animated-svg-image-outside-viewport-paused.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170745

        Reviewed by Tim Horton.

        Test was relying on a setTimeout(30) and was flaky. Now use shouldBecomeEqual() to make the
        test more robust.

        * svg/animations/animated-svg-image-outside-viewport-paused-expected.txt:
        * svg/animations/animated-svg-image-outside-viewport-paused.html:

2017-04-13  Youenn Fablet  <youenn@apple.com>

        Remove RTCSignalingState::Closed
        https://bugs.webkit.org/show_bug.cgi?id=170811

        Reviewed by Eric Carlson.

        * webrtc/connection-state.html:

2017-04-13  Jonathan Bedard  <jbedard@apple.com>

        Remove compositing/masks/solid-color-masked.html expectation
        https://bugs.webkit.org/show_bug.cgi?id=168054

        Unreviewed test gardening.

        * platform/ios/TestExpectations: Remove compositing/masks/solid-color-masked.html.

2017-04-13  Youenn Fablet  <youenn@apple.com>

        Add some more WebRTC tests
        https://bugs.webkit.org/show_bug.cgi?id=170796

        Reviewed by Eric Carlson.

        * webrtc/multi-video-expected.txt: Added.
        * webrtc/multi-video.html: Added.
        * webrtc/video-with-data-channel-expected.txt: Added.
        * webrtc/video-with-data-channel.html: Added.

2017-04-13  Romain Bellessort  <romain.bellessort@crf.canon.fr>

        [Readable Streams API] Implement cloneArrayBuffer in WebCore
        https://bugs.webkit.org/show_bug.cgi?id=170008

        Reviewed by Youenn Fablet.

        Added test to check cloneArrayBuffer behaviour. 

        * streams/clone-array-buffer-expected.txt: Added.
        * streams/clone-array-buffer.html: Added.

2017-04-13  Youenn Fablet  <youenn@apple.com>

        onnegotiationneeded should only be called once
        https://bugs.webkit.org/show_bug.cgi?id=170785

        Reviewed by Alex Christensen.

        * webrtc/negotiatedneeded-event-addStream.html:

2017-04-13  Dave Hyatt  <hyatt@apple.com>

        Rendering flexbox children across columns
        https://bugs.webkit.org/show_bug.cgi?id=164166
        <rdar://problem/29055587>

        Reviewed by Zalan Bujtas.

        * fast/multicol/flexbox-rows-expected.html: Added.
        * fast/multicol/flexbox-rows.html: Added.

2017-04-13  Antti Koivisto  <antti@apple.com>

        Try to unflake a test.

        * http/tests/cache/disk-cache/disk-cache-media-small.html:

2017-04-12  Brady Eidson  <beidson@apple.com>

        QuotaExceededError when saving to localStorage in private mode.
        https://bugs.webkit.org/show_bug.cgi?id=157010

        Reviewed by Alex Christensen.

        * platform/mac-wk2/TestExpectations:
        * storage/domstorage/localstorage/private-browsing-affects-storage-expected.txt:
        * storage/domstorage/localstorage/private-browsing-affects-storage.html:
        * storage/domstorage/localstorage/resources/private-browsing-1.html: Added.
        * storage/domstorage/localstorage/resources/private-browsing-2.html: Added.
        * storage/domstorage/localstorage/resources/private-browsing-3.html: Added.
        * storage/domstorage/localstorage/resources/private-browsing-storage-2.html: Added.
        * storage/domstorage/sessionstorage/private-browsing-affects-storage-expected.txt: Removed.
        * storage/domstorage/sessionstorage/private-browsing-affects-storage.html: Removed.

2017-04-12  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/built-ins/NativeErrors/EvalError/proto.js
        https://bugs.webkit.org/show_bug.cgi?id=170668

        Reviewed by Keith Miller.

        * ietestcenter/Javascript/15.2.3.2-2-12-expected.txt:
        * ietestcenter/Javascript/15.2.3.2-2-13-expected.txt:
        * ietestcenter/Javascript/15.2.3.2-2-14-expected.txt:
        * ietestcenter/Javascript/15.2.3.2-2-15-expected.txt:
        * ietestcenter/Javascript/15.2.3.2-2-16-expected.txt:
        * ietestcenter/Javascript/15.2.3.2-2-17-expected.txt:
        These tests are now out of date.

2017-04-12  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/language/literals/regexp/u-dec-esc.js
        https://bugs.webkit.org/show_bug.cgi?id=170687

        Reviewed by Michael Saboff.

        * js/regexp-unicode-expected.txt:
        * js/script-tests/regexp-unicode.js:
        Extend test to test invalid backreferences.

2017-04-12  Jonathan Bedard  <jbedard@apple.com>

        Move expectation for compositing/iframes/iframe-size-from-zero.htm to top level

        Unreviewed test gardening.

        * TestExpectations: Marked compositing/iframes/iframe-size-from-zero.html as flaky.
        * platform/ios-wk1/TestExpectations: Move test expectation to top level.
        * platform/mac-wk1/TestExpectations: Ditto.
        * platform/win/TestExpectations: Ditto.
        * platform/wk2/TestExpectations: Ditto.

2017-04-11  Dean Jackson  <dino@apple.com>

        canvas/2d.gradient.* LayoutTests failing
        https://bugs.webkit.org/show_bug.cgi?id=170757
        <rdar://problem/31177990>

        Reviewed by Antoine Quint.

        Add a fudge factor to the gradient tests, since we can
        now produce noisy (nicer looking) gradients. There might
        be 1 or 2 bits of difference per pixel.

        * canvas/philip/tests.js:
        (_assertPixelWithGradientNoise):
        * canvas/philip/tests/2d.gradient.linear.transform.1.html:
        * canvas/philip/tests/2d.gradient.linear.transform.2.html:
        * canvas/philip/tests/2d.gradient.linear.transform.3.html:
        * canvas/philip/tests/2d.gradient.radial.cone.bottom.html:
        * canvas/philip/tests/2d.gradient.radial.cone.cylinder.html:
        * canvas/philip/tests/2d.gradient.radial.cone.front.html:
        * canvas/philip/tests/2d.gradient.radial.cone.shape1.html:
        * canvas/philip/tests/2d.gradient.radial.cone.top.html:
        * canvas/philip/tests/2d.gradient.radial.inside1.html:
        * canvas/philip/tests/2d.gradient.radial.inside2.html:
        * canvas/philip/tests/2d.gradient.radial.inside3.html:
        * canvas/philip/tests/2d.gradient.radial.outside1.html:
        * canvas/philip/tests/2d.gradient.radial.outside2.html:
        * canvas/philip/tests/2d.gradient.radial.outside3.html:
        * canvas/philip/tests/2d.gradient.radial.touch2.html:
        * fast/canvas/script-tests/canvas-gradient-on-compositing.js:
        * fast/canvas/canvas-gradient-on-compositing-expected.html:

2017-04-12  Myles C. Maxfield  <mmaxfield@apple.com>

        Well-known variations should clamp to the values listed in the @font-face block
        https://bugs.webkit.org/show_bug.cgi?id=169260

        Reviewed by Dean Jackson.

        * fast/text/variations/font-face-clamp-expected.html: Added.
        * fast/text/variations/font-face-clamp.html: Added.

2017-04-12  Jonathan Bedard  <jbedard@apple.com>

        Remove two passing canvas tests from ios expectations

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-04-12  Youenn Fablet  <youenn@apple.com>

        REGRESSION: LayoutTest webrtc/negotiatedneeded-event-addStream.html is frequently crashing
        https://bugs.webkit.org/show_bug.cgi?id=170754
        <rdar://problem/31573169>

        Unreviewed.

        * TestExpectations: Marking test as crashing.

2017-04-12  Manuel Rego Casasnovas  <rego@igalia.com>

        [css-grid] Replaced elements don't properly resolve percentage heights
        https://bugs.webkit.org/show_bug.cgi?id=159670

        Reviewed by Darin Adler.

        The issue was fixed in r213149 (bug #168657), but the Blink test was not imported.
        This patch only adds the test to avoid regressions in the future.

        * fast/css-grid-layout/grid-item-with-percent-height-replaced-element-expected.txt: Added.
        * fast/css-grid-layout/grid-item-with-percent-height-replaced-element.html: Added.

2017-04-10  Antti Koivisto  <antti@apple.com>

        Cache small media resources in disk cache
        https://bugs.webkit.org/show_bug.cgi?id=170676
        <rdar://problem/31532649>

        Reviewed by Andreas Kling.

        * http/tests/cache/disk-cache/disk-cache-media-small-expected.txt: Added.
        * http/tests/cache/disk-cache/disk-cache-media-small.html: Added.

2017-04-12  Per Arne Vollan  <pvollan@apple.com>

        Implement stroke-color CSS property.
        https://bugs.webkit.org/show_bug.cgi?id=169352

        Reviewed by Jon Lee.

        * fast/css/stroke-color-expected.html: Added.
        * fast/css/stroke-color-fallback-expected.html: Added.
        * fast/css/stroke-color-fallback.html: Added.
        * fast/css/stroke-color.html: Added.
        * fast/css/visited-link-stroke-color-expected.html: Added.
        * fast/css/visited-link-stroke-color.html: Added.

2017-04-11  Youenn Fablet  <youenn@apple.com>

        LayoutTest webrtc/video-mute.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170704

        Reviewed by Eric Carlson.

        * webrtc/video-mute.html: Trying to make it less flaky.

2017-04-11  Youenn Fablet  <youenn@apple.com>

        [WK1] Add captureStream test with webrtc
        https://bugs.webkit.org/show_bug.cgi?id=170746

        Reviewed by Eric Carlson.

        * platform/mac-wk1/TestExpectations: Activating this new test in WK1.
        * webrtc/captureCanvas-webrtc-expected.txt: Added.
        * webrtc/captureCanvas-webrtc.html: Added.

2017-04-11  Youenn Fablet  <youenn@apple.com>

        Migrating webrtc tests to latest API
        https://bugs.webkit.org/show_bug.cgi?id=170709

        Reviewed by Eric Carlson.

        * webrtc/audio-peer-connection-webaudio.html:
        * webrtc/libwebrtc/descriptionGetters.html:
        * webrtc/negotiatedneeded-event-addStream.html:
        * webrtc/peer-connection-audio-mute.html:
        * webrtc/peer-connection-audio-mute2.html:
        * webrtc/peer-connection-remote-audio-mute.html:
        * webrtc/peer-connection-remote-audio-mute2.html:
        * webrtc/release-after-getting-track.html:
        * webrtc/video-disabled-black.html:
        * webrtc/video-mute.html:
        * webrtc/video-remote-mute.html:
        * webrtc/video-with-receiver.html:
        * webrtc/video.html:

2017-04-11  Youenn Fablet  <youenn@apple.com>

        Activate WebRTC data channel tests for WK1
        https://bugs.webkit.org/show_bug.cgi?id=170710

        Reviewed by Eric Carlson.

        * platform/mac-wk1/TestExpectations:

2017-04-11  Youenn Fablet  <youenn@apple.com>

        MediaStream id should be equal to msid
        https://bugs.webkit.org/show_bug.cgi?id=170712

        Reviewed by Eric Carlson.

        Removing no longer needed/Adding needed calls to useMockRTCPeerConnectionFactory.

        * fast/mediastream/RTCPeerConnection-inspect-answer.html:
        * fast/mediastream/RTCPeerConnection-inspect-offer.html:
        * fast/mediastream/RTCPeerConnection-legacy-stream-based-api.html:
        * fast/mediastream/RTCPeerConnection-media-setup-single-dialog.html:
        * fast/mediastream/RTCPeerConnection-remotely-assigned-transceiver-mid.html:
        * fast/mediastream/RTCPeerConnection-setLocalDescription-offer.html:
        * fast/mediastream/RTCPeerConnection-setRemoteDescription-offer.html:
        * webrtc/audio-peer-connection-webaudio.html:
        * webrtc/audio-replace-track.html:
        * webrtc/connection-state.html:
        * webrtc/datachannel/basic.html:
        * webrtc/datachannel/bufferedAmountLowThreshold.html:
        * webrtc/datachannel/datachannel-gc.html:
        * webrtc/datachannel/datachannel-stats.html:
        * webrtc/datachannel/filter-ice-candidate.html:
        * webrtc/ephemeral-certificates-and-cnames.html:
        * webrtc/libwebrtc/descriptionGetters.html:
        * webrtc/negotiatedneeded-event-addStream.html:
        * webrtc/no-port-zero-in-upd-candidates.html:
        * webrtc/peer-connection-audio-mute.html:
        * webrtc/peer-connection-audio-mute2.html:
        * webrtc/peer-connection-remote-audio-mute.html:
        * webrtc/peer-connection-remote-audio-mute2.html:
        * webrtc/release-after-getting-track.html:
        * webrtc/video-disabled-black.html:
        * webrtc/video-getParameters.html:
        * webrtc/video-mediastreamtrack-stats.html:
        * webrtc/video-mute.html:
        * webrtc/video-remote-mute.html:
        * webrtc/video-replace-track-to-null.html:
        * webrtc/video-replace-track.html:
        * webrtc/video-stats.html:
        * webrtc/video-with-receiver.html:
        * webrtc/video.html:

2017-04-11  Chris Fleizach  <cfleizach@apple.com>

        AX: Web article navigation does not work (article rotor for Facebook, Twitter, Messages etc.)
        https://bugs.webkit.org/show_bug.cgi?id=170330
        <rdar://problem/31366105>

        Reviewed by Joanmarie Diggs.

        * accessibility/mac/search-predicate-article-expected.txt:
        * accessibility/mac/search-predicate-article.html:

2017-04-11  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/annexB/language/comments/multi-line-html-close.js
        https://bugs.webkit.org/show_bug.cgi?id=170648

        Reviewed by Keith Miller.

        * js/parser-xml-close-comment-expected.txt:
        * js/script-tests/parser-xml-close-comment.js:
        Update test coverage for JavaScript HTML comments.

2017-04-11  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/built-ins/Array/S15.4.3_A2.2.js
        https://bugs.webkit.org/show_bug.cgi?id=170652

        Reviewed by Michael Saboff.

        * ietestcenter/Javascript/15.2.3.3-4-186-expected.txt:
        * ietestcenter/Javascript/15.2.3.3-4-191-expected.txt:
        * ietestcenter/Javascript/15.2.3.3-4-194-expected.txt:
        * ietestcenter/Javascript/15.2.3.3-4-201-expected.txt:
        * ietestcenter/Javascript/15.3.3.2-1-expected.txt:
        * sputnik/Conformance/15_Native_Objects/15.4_Array/15.4.3/S15.4.3_A2.2-expected.txt:
        * sputnik/Conformance/15_Native_Objects/15.9_Date/15.9.5/15.9.5.1_Date.prototype.constructor/S15.9.5.1_A3_T2-expected.txt:
        These tests expected the opposite, they are now out of date.

2017-04-11  Yoav Weiss  <yoav@yoav.ws>

        [link preload] Double downloads of preloaded content when it's in MemoryCache
        https://bugs.webkit.org/show_bug.cgi?id=170122

        Reviewed by Antti Koivisto.

        * TestExpectations: Removed flakiness label from the header preload charset test.
        * fast/loader/cache-encoding-expected.txt: Changed expectation.
        * fast/loader/cache-encoding.html: Modified behavior to stick with the first decoded string.
        * http/tests/preload/preload-encoding-expected.txt: Changed expectation.
        * http/tests/preload/preload-encoding.html: Modified behavior to stick with the first decoded string.
        * imported/w3c/web-platform-tests/html/semantics/scripting-1/the-script-element/script-charset-01-expected.txt: This test refers to the same file
        twice and expects different decoding for it each time. This is the behavior that we modified, and therefore the test expectation is changed as well.

2017-04-11  Manuel Rego Casasnovas  <rego@igalia.com>

        [css-grid] Fix fast/css-grid-layout/grid-simplified-layout-positioned.html
        https://bugs.webkit.org/show_bug.cgi?id=167538

        Reviewed by Darin Adler.

        fast/css-grid-layout/grid-simplified-layout-positioned.html was flacky
        as the caret was not always painted in the test runner.
        The test was checking for a crash in simplified layout (see bug #163450)
        and has nothing to do with the caret or "autofocus" behavior.
        "autofocus" was needed to get the crash, so this change modifies
        the test to blur the element, so the caret is not painted anymore.

        * fast/css-grid-layout/grid-simplified-layout-positioned-expected.html:
        Don't focus the input element.
        * fast/css-grid-layout/grid-simplified-layout-positioned.html: Blur
        the input element to avoid showing the caret.
        * platform/mac-wk2/TestExpectations: Remove file from expectations.

2017-04-10  Jiewen Tan  <jiewen_tan@apple.com>

        Unreviewed, test expectations update

        * platform/wk2/TestExpectations:

2017-04-10  Ryan Haddad  <ryanhaddad@apple.com>

        Mark two newly imported web-platform-tests as failing.

        Unreviewed test gardening.

        * TestExpectations:

2017-04-10  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/volume-slider/volume-slider-value.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=167475

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-10  Wenson Hsieh  <wenson_hsieh@apple.com>

        REGRESSION (r214403): fast/events/drag-to-navigate.html and fast/events/only-valid-drop-targets-receive-file-drop.html failing
        https://bugs.webkit.org/show_bug.cgi?id=170677
        <rdar://problem/31512633>

        Reviewed by Tim Horton.

        Turn enableDragDestinationActionLoad on in these two LayoutTests via WKTR options.

        * fast/events/drag-to-navigate.html:
        * fast/events/only-valid-drop-targets-receive-file-drop.html:

2017-04-10  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/volume-up-support/volume-up-support.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170682

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-10  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline js/dom/global-constructors-attributes.html after r215131.

        Unreviewed test gardening.

        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-04-10  Andreas Kling  <akling@apple.com>

        Don't generate extra scrolling tiles for non-visible pages.
        https://bugs.webkit.org/show_bug.cgi?id=167213
        <rdar://problem/30105774>

        Reviewed by Antti Koivisto.

        * TestExpectations:
        * compositing/tiling/non-visible-window-tile-coverage-expected.txt: Added.
        * compositing/tiling/non-visible-window-tile-coverage.html: Added.
        * platform/mac-wk2/TestExpectations:

2017-04-10  Carlos Garcia Campos  <cgarcia@igalia.com>

        REGRESSION(r214426): [GTK] Test media/video-click-dblckick-standalone.html started to fail in the bots after r214426
        https://bugs.webkit.org/show_bug.cgi?id=170667

        Reviewed by an Doberek.

        Unskip then test that is passing now.

        * platform/gtk/TestExpectations:

2017-04-10  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Mark several tests as failing/timing out.

        * platform/gtk/TestExpectations:

2017-04-10  Miguel Gomez  <magomez@igalia.com>

        REGRESSION(r205841): [GTK] Test fast/images/animated-png.html is failing since r205841
        https://bugs.webkit.org/show_bug.cgi?id=168425

        Reviewed by Said Abou-Hallawa.

        Adjusted expectation for fast/images/animated-png.html. It must pass now.

        * platform/gtk/TestExpectations:

2017-04-09  Devin Rousso  <webkit@devinrousso.com>

        Web Inspector: tabbing in Styles sidebar is broken when additional ":" and ";" are in the property value
        https://bugs.webkit.org/show_bug.cgi?id=170184

        Reviewed by Matt Baker.

        * inspector/unit-tests/text-utilities-expected.txt: Added.
        * inspector/unit-tests/text-utilities.html: Added.

2017-04-09  Youenn Fablet  <youenn@apple.com>

        Resync WPT tests up to 23cd07d4685d81024b7440e042f8bbdb33e7ddec
        https://bugs.webkit.org/show_bug.cgi?id=170647

        Reviewed by Sam Weinig.

        * TestExpectations:
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/http-cache/304-update-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/http-cache/cc-request-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/http-cache/heuristic-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/http-cache/invalidate-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/http-cache/status-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/html/browsers/windows/browsing-context-expected.txt: Added.
        * platform/mac/TestExpectations:
        * tests-options.json:

2017-04-09  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/annexB/language/literals/regexp/identity-escape.js
        https://bugs.webkit.org/show_bug.cgi?id=170651

        Reviewed by Saam Barati.

        * js/regexp-no-extensions-expected.txt:
        * js/script-tests/regexp-no-extensions.js:
        Update existing test for these edge cases.

2017-04-08  Myles C. Maxfield  <mmaxfield@apple.com>

        [Variation Fonts] Width values of GX fonts are not mapped correctly
        https://bugs.webkit.org/show_bug.cgi?id=170367

        Reviewed by Simon Fraser.

        * fast/text/variations/font-selection-properties-expected.html:
        * fast/text/variations/gx-width-expected.html: Added.
        * fast/text/variations/gx-width.html: Added.

2017-04-08  Said Abou-Hallawa  <sabouhallawa@apple.com>

        A synchronous DecodingOptions should be compatible with any asynchronous sizeForDrawing DecodingOptions
        https://bugs.webkit.org/show_bug.cgi?id=170577

        Reviewed by Simon Fraser.

        * fast/images/async-image-background-image-repeated-expected.html: Added.
        * fast/images/async-image-background-image-repeated.html: Added.

2017-04-08  Simon Fraser  <simon.fraser@apple.com>

        Unprefix CSS cursor values grab and grabbing
        https://bugs.webkit.org/show_bug.cgi?id=170543

        Reviewed by Jon Lee.

        Enhanced the cursor test to check round-tripping of all values.

        * fast/css/cursor-parsing-expected.txt:
        * fast/css/cursor-parsing.html:

2017-04-08  Youenn Fablet  <youenn@apple.com>

        WebRTC tests gardening
        https://bugs.webkit.org/show_bug.cgi?id=170508

        Reviewed by Eric Carlson.

        * platform/ios-wk1/TestExpectations:
        * platform/ios-wk2/TestExpectations:
        * platform/ios/TestExpectations:

2017-04-08  Youenn Fablet  <youenn@apple.com>

        MediaStreamTrack id should be preserved by PeerConnection
        https://bugs.webkit.org/show_bug.cgi?id=170624

        Reviewed by Eric Carlson.

        * webrtc/video.html:

2017-04-07  Chris Dumez  <cdumez@apple.com>

        Unreviewed, update 2 media tests after r215120 so they work on iOS.

        Setting the volume is a no-op on iOS so mute the video instead.

        * media/video-restricted-invisible-autoplay-allowed-when-visible.html:
        * media/video-restricted-invisible-autoplay-not-allowed.html:

2017-04-07  Yuichiro Kikura  <y.kikura@gmail.com>

        WebGPU: implement ComputeCommandEncoder and related components    
        https://bugs.webkit.org/show_bug.cgi?id=170444

        Reviewed by Alex Christensen.

        Added a test case to ensure ComputeCommandEncoder is dispatched successfully

        * fast/canvas/webgpu/webgpu-dispatch-expected.txt: Added.
        * fast/canvas/webgpu/webgpu-dispatch.html: Added.

2017-04-07  Zalan Bujtas  <zalan@apple.com>

        Simple line layout: FlowContents::segmentIndexForRunSlow skips empty runs.
        https://bugs.webkit.org/show_bug.cgi?id=170552

        Reviewed by Antti Koivisto.

        * fast/text/simple-line-layout-hover-over-subsequent-linebreaks-expected.txt: Added.
        * fast/text/simple-line-layout-hover-over-subsequent-linebreaks.html: Added.

2017-04-07  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/media-controller/media-controller-auto-hide-mouse-leave-after-play.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=168540

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-07  Ryan Haddad  <ryanhaddad@apple.com>

        Mark inspector/codemirror/prettyprinting-css.html as a flaky timeout.
        https://bugs.webkit.org/show_bug.cgi?id=170615

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-07  Chris Dumez  <cdumez@apple.com>

        Audible autoplay videos should not get paused when outside the viewport
        https://bugs.webkit.org/show_bug.cgi?id=170610
        <rdar://problem/31505984>

        Reviewed by Eric Carlson.

        Add layout test coverage.

        * media/video-restricted-invisible-autoplay-allowed-if-audible-expected.txt: Added.
        * media/video-restricted-invisible-autoplay-allowed-if-audible.html: Copied from LayoutTests/media/video-restricted-invisible-autoplay-not-allowed.html.
        * media/video-restricted-invisible-autoplay-allowed-when-visible.html:
        * media/video-restricted-invisible-autoplay-not-allowed.html:

2017-04-07  Chris Dumez  <cdumez@apple.com>

        Throttle / Align DOM Timers in cross-origin iframes to 30fps
        https://bugs.webkit.org/show_bug.cgi?id=170613
        <rdar://problem/31506444>

        Reviewed by Simon Fraser.

        Add layout test coverage.

        * http/tests/frame-throttling/resources/timer-throttling-frame.html: Added.
        * http/tests/frame-throttling/timer-throttle-in-cross-origin-subframe-expected.txt: Added.
        * http/tests/frame-throttling/timer-throttle-in-cross-origin-subframe.html: Added.

2017-04-07  Brent Fulgham  <bfulgham@apple.com>

        Rebaseline additional tests after r215096.
        https://bugs.webkit.org/show_bug.cgi?id=170561
        <rdar://problem/7415154>

        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-cross-in-cross-none-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-cross-in-cross-self-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-cross-in-same-none-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-cross-in-same-self-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-same-in-cross-none-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-same-in-cross-self-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-same-in-same-none-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-none-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-self-block-expected.txt:
        * http/tests/security/no-popup-from-sandbox-top-expected.txt:
        * http/tests/xmlhttprequest/origin-exact-matching-expected.txt:

2017-04-07  Brent Fulgham  <bfulgham@apple.com>

        WebKit should percent encode single quotes in query strings
        https://bugs.webkit.org/show_bug.cgi?id=170561
        <rdar://problem/7415154>

        Reviewed by Alex Christensen.

        Rebaseline tests after change.

        * fast/events/popup-blocked-from-unique-frame-via-window-open-named-sibling-frame-expected.txt:
        * fast/frames/xss-auditor-handles-file-urls-expected.txt:
        * http/tests/security/xssAuditor/base-href-control-char-expected.txt:
        * http/tests/security/xssAuditor/base-href-expected.txt:
        * http/tests/security/xssAuditor/base-href-null-char-expected.txt:
        * http/tests/security/xssAuditor/base-href-scheme-relative-expected.txt:
        * http/tests/security/xssAuditor/embed-tag-control-char-expected.txt:
        * http/tests/security/xssAuditor/embed-tag-expected.txt:
        * http/tests/security/xssAuditor/embed-tag-javascript-url-expected.txt:
        * http/tests/security/xssAuditor/embed-tag-null-char-expected.txt:
        * http/tests/security/xssAuditor/form-action-expected.txt:
        * http/tests/security/xssAuditor/formaction-on-button-expected.txt:
        * http/tests/security/xssAuditor/formaction-on-input-expected.txt:
        * http/tests/security/xssAuditor/frameset-injection-expected.txt:
        * http/tests/security/xssAuditor/full-block-base-href-expected.txt:
        * http/tests/security/xssAuditor/full-block-link-onclick-expected.txt:
        * http/tests/security/xssAuditor/full-block-object-tag-expected.txt:
        * http/tests/security/xssAuditor/full-block-script-tag-with-source-expected.txt:
        * http/tests/security/xssAuditor/iframe-injection-expected.txt:
        * http/tests/security/xssAuditor/iframe-javascript-url-more-encoding-expected.txt:
        * http/tests/security/xssAuditor/img-onerror-non-ASCII-char-default-encoding-expected.txt:
        * http/tests/security/xssAuditor/img-onerror-non-ASCII-char-expected.txt:
        * http/tests/security/xssAuditor/link-onclick-ampersand-expected.txt:
        * http/tests/security/xssAuditor/link-onclick-control-char-expected.txt:
        * http/tests/security/xssAuditor/link-onclick-entities-expected.txt:
        * http/tests/security/xssAuditor/link-onclick-expected.txt:
        * http/tests/security/xssAuditor/link-onclick-null-char-expected.txt:
        * http/tests/security/xssAuditor/object-embed-tag-control-char-expected.txt:
        * http/tests/security/xssAuditor/object-embed-tag-expected.txt:
        * http/tests/security/xssAuditor/object-embed-tag-null-char-expected.txt:
        * http/tests/security/xssAuditor/object-tag-expected.txt:
        * http/tests/security/xssAuditor/object-tag-javascript-url-expected.txt:
        * http/tests/security/xssAuditor/script-tag-expression-follows-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-16bit-unicode4-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-16bit-unicode5-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-comma-01-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-source-control-char-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-source-entities-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-source-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-source-null-char-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-source-same-host-with-query-expected.txt:
        * http/tests/security/xssAuditor/svg-animate-expected.txt:
        * http/tests/security/xssAuditor/svg-script-tag-expected.txt:
        * http/tests/security/xssAuditor/xss-filter-bypass-big5-expected.txt:
        * http/tests/security/xssAuditor/xss-filter-bypass-sjis-expected.txt:

2017-04-07  Youenn Fablet  <youenn@apple.com>

        Improve some WebRTC flaky tests
        https://bugs.webkit.org/show_bug.cgi?id=170584

        Reviewed by Alex Christensen.

        * webrtc/libwebrtc/descriptionGetters.html:
        * webrtc/video-replace-track-to-null.html:

2017-04-07  Zalan Bujtas  <zalan@apple.com>

        Text insertion cursor disappears after pressing enter
        https://bugs.webkit.org/show_bug.cgi?id=169291
        <rdar://problem/30899611>

        Reviewed by Tim Horton.

        * editing/simple-line-layout-caret-is-gone-expected.txt: Added.
        * editing/simple-line-layout-caret-is-gone.html: Added.

2017-04-06  Myles C. Maxfield  <mmaxfield@apple.com>

        Make FontWithFeatures test font pass OTS
        https://bugs.webkit.org/show_bug.cgi?id=169788

        Reviewed by Tim Horton.

        Updated font to the one which passes the tests.

        * css3/resources/FontWithFeatures.otf:

2017-04-06  Jiewen Tan  <jiewen_tan@apple.com>

        LayoutTest crypto/subtle/aes-ctr-encrypt-malformed-parameters.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170571

        Unreviewed.

        * crypto/subtle/aes-ctr-encrypt-malformed-parameters-expected.txt:
        * crypto/subtle/aes-ctr-encrypt-malformed-parameters.html:

2017-04-06  Wenson Hsieh  <wenson_hsieh@apple.com>

        Scroll offset jumps after a programmatic scroll in an overflow container with scroll snapping
        https://bugs.webkit.org/show_bug.cgi?id=170560
        <rdar://problem/31484693>

        Reviewed by Tim Horton.

        Add a test verifying that programmatically changing the scroll offset of an overflow container does not cause the
        scroll offset to jump back to the last active snap position. See WebCore ChangeLog for more details.

        * css3/scroll-snap/scroll-snap-programmatic-overflow-scroll-expected.txt: Added.
        * css3/scroll-snap/scroll-snap-programmatic-overflow-scroll.html: Added.

2017-04-05  Simon Fraser  <simon.fraser@apple.com>

        Throttle requestAnimationFrame in cross-origin iframes to 30fps
        https://bugs.webkit.org/show_bug.cgi?id=170534

        Reviewed by Dan Bates.

        * http/tests/frame-throttling/raf-throttle-in-cross-origin-subframe-expected.txt: Added.
        * http/tests/frame-throttling/raf-throttle-in-cross-origin-subframe.html: Added.
        * http/tests/frame-throttling/resources/requestAnimationFrame-frame.html: Added.

2017-04-06  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r215041.

        The LayoutTest for this change is failing on ios-simulator.

        Reverted changeset:

        "Rendering flexbox children across columns"
        https://bugs.webkit.org/show_bug.cgi?id=164166
        http://trac.webkit.org/changeset/215041

2017-04-06  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r215046.

        This change broke internal builds.

        Reverted changeset:

        "WebRTC tests gardening"
        https://bugs.webkit.org/show_bug.cgi?id=170508
        http://trac.webkit.org/changeset/215046

2017-04-06  Ryan Haddad  <ryanhaddad@apple.com>

        Skip a test that was accidentally enabled with r214982.

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-04-06  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Show all headers in the Request Headers section of the Resource details sidebar
        https://bugs.webkit.org/show_bug.cgi?id=16531
        <rdar://problem/5712895>

        Reviewed by Timothy Hatcher.

        * http/tests/inspector/network/resource-request-headers-expected.txt: Added.
        * http/tests/inspector/network/resource-request-headers.html: Added.
        * http/tests/inspector/network/resources/basic-auth.php: Added.
        Test coverage for Cookie and Basic Authentication headers.

        * platform/mac/TestExpectations:
        * platform/mac-wk1/TestExpectations:
        * platform/win/TestExpectations:
        Mark the test as expected to fail on WebKit1 CFNetwork based platforms,
        and ElCapitan which uses the legacy non-NSURLSession loading path.

2017-04-06  Youenn Fablet  <youenn@apple.com>

        LayoutTest fast/mediastream/getUserMedia-webaudio.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=167513

        Reviewed by Eric Carlson.

        * fast/mediastream/getUserMedia-webaudio.html: Removing unecessary flaky check.

2017-04-06  Zalan Bujtas  <zalan@apple.com>

        Simple line layout: Hittest always returns the first renderer in the block.
        https://bugs.webkit.org/show_bug.cgi?id=170520
        <rdar://problem/30979175>

        Reviewed by Antti Koivisto.

        * fast/dom/Document/CaretRangeFromPoint/simple-line-layout-hittest-with-caret-range-from-point-expected.html: Added.
        * fast/dom/Document/CaretRangeFromPoint/simple-line-layout-hittest-with-caret-range-from-point.html: Added.

2017-03-31  Jiewen Tan  <jiewen_tan@apple.com>

        [WebCrypto] Add support for AES-CTR
        https://bugs.webkit.org/show_bug.cgi?id=169761
        <rdar://problem/31331321>

        Reviewed by Brent Fulgham.

        * crypto/subtle/aes-ctr-encrypt-malformed-parameters-expected.txt: Added.
        * crypto/subtle/aes-ctr-encrypt-malformed-parameters.html: Added.
        * crypto/subtle/aes-ctr-generate-export-key-jwk-length-128-expected.txt: Added.
        * crypto/subtle/aes-ctr-generate-export-key-jwk-length-128.html: Added.
        * crypto/subtle/aes-ctr-generate-export-key-jwk-length-192-expected.txt: Added.
        * crypto/subtle/aes-ctr-generate-export-key-jwk-length-192.html: Added.
        * crypto/subtle/aes-ctr-generate-export-key-jwk-length-256-expected.txt: Added.
        * crypto/subtle/aes-ctr-generate-export-key-jwk-length-256.html: Added.
        * crypto/subtle/aes-ctr-generate-export-raw-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-generate-export-raw-key.html: Added.
        * crypto/subtle/aes-ctr-generate-key-encrypt-decrypt-expected.txt: Added.
        * crypto/subtle/aes-ctr-generate-key-encrypt-decrypt.html: Added.
        * crypto/subtle/aes-ctr-generate-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-generate-key.html: Added.
        * crypto/subtle/aes-ctr-import-jwk-key-length-128-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-jwk-key-length-128.html: Added.
        * crypto/subtle/aes-ctr-import-jwk-key-length-192-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-jwk-key-length-192.html: Added.
        * crypto/subtle/aes-ctr-import-jwk-key-length-256-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-jwk-key-length-256.html: Added.
        * crypto/subtle/aes-ctr-import-key-decrypt-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-key-decrypt.html: Added.
        * crypto/subtle/aes-ctr-import-key-encrypt-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-key-encrypt.html: Added.
        * crypto/subtle/aes-ctr-import-key-unwrap-jwk-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-key-unwrap-jwk-key.html: Added.
        * crypto/subtle/aes-ctr-import-key-unwrap-raw-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-key-unwrap-raw-key.html: Added.
        * crypto/subtle/aes-ctr-import-key-wrap-jwk-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-key-wrap-jwk-key.html: Added.
        * crypto/subtle/aes-ctr-import-key-wrap-raw-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-key-wrap-raw-key.html: Added.
        * crypto/subtle/aes-ctr-import-raw-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-raw-key.html: Added.
        * crypto/subtle/aes-generate-key-malformed-parameters-expected.txt:
        * crypto/subtle/aes-generate-key-malformed-parameters.html:
        * crypto/subtle/aes-import-key-malformed-parameters-expected.txt:
        * crypto/subtle/aes-import-key-malformed-parameters.html:
        * crypto/workers/subtle/aes-ctr-import-key-decrypt-expected.txt: Added.
        * crypto/workers/subtle/aes-ctr-import-key-decrypt.html: Added.
        * crypto/workers/subtle/aes-ctr-import-key-encrypt-expected.txt: Added.
        * crypto/workers/subtle/aes-ctr-import-key-encrypt.html: Added.
        * crypto/workers/subtle/aes-ctr-import-key-unwrap-key-expected.txt: Added.
        * crypto/workers/subtle/aes-ctr-import-key-unwrap-key.html: Added.
        * crypto/workers/subtle/aes-ctr-import-key-wrap-key-expected.txt: Added.
        * crypto/workers/subtle/aes-ctr-import-key-wrap-key.html: Added.
        * crypto/workers/subtle/resources/aes-ctr-import-key-decrypt.js: Added.
        * crypto/workers/subtle/resources/aes-ctr-import-key-encrypt.js: Added.
        * crypto/workers/subtle/resources/aes-ctr-import-key-unwrap-key.js: Added.
        * crypto/workers/subtle/resources/aes-ctr-import-key-wrap-key.js: Added.

2017-04-06  Ryan Haddad  <ryanhaddad@apple.com>

        Mark inspector/codemirror/prettyprinting-css-rules.html as flaky on release.
        https://bugs.webkit.org/show_bug.cgi?id=153460

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-06  Youenn Fablet  <youenn@apple.com>

        WebRTC tests gardening
        https://bugs.webkit.org/show_bug.cgi?id=170508

        Reviewed by Eric Carlson.

        * platform/ios-wk1/TestExpectations:
        * platform/ios-wk2/TestExpectations:
        * platform/ios/TestExpectations:

2017-04-06  Antti Koivisto  <antti@apple.com>

        Implement testing mode for disk cache
        https://bugs.webkit.org/show_bug.cgi?id=170547

        Reviewed by Andreas Kling.

        Enable a few disabled tests to see how it goes.

        * platform/mac-wk2/TestExpectations:

2017-04-06  Romain Bellessort  <romain.bellessort@crf.canon.fr>

        [Readable Streams API] Implement ReadableStreamBYOBRequest respondWithNewView()
        https://bugs.webkit.org/show_bug.cgi?id=170339

        Reviewed by Youenn Fablet.

        Added new tests addressing respondWithNewView() behaviour.

        * streams/readable-stream-byob-request-expected.txt: Updated.
        * streams/readable-stream-byob-request.js: Added new tests.

2017-04-06  Dave Hyatt  <hyatt@apple.com>

        Rendering flexbox children across columns
        https://bugs.webkit.org/show_bug.cgi?id=164166
        <rdar://problem/29055587>

        Reviewed by Zalan Bujtas.

        * fast/multicol/flexbox-rows-expected.html: Added.
        * fast/multicol/flexbox-rows.html: Added.

2017-04-05  Simon Fraser  <simon.fraser@apple.com>

        Set lastHandledUserGestureTimestamp on all ancestor documents, not just the top document
        https://bugs.webkit.org/show_bug.cgi?id=170479

        Reviewed by Sam Weinig.

        * fast/frames/user-gesture-timestamp-propagation-expected.txt: Added.
        * fast/frames/user-gesture-timestamp-propagation.html: Added.
        * platform/ios/TestExpectations:

2017-04-05  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] Host application should be able to mute and unmute media streams
        https://bugs.webkit.org/show_bug.cgi?id=170519
        <rdar://problem/31174326>

        Reviewed by Youenn Fablet.

        * fast/mediastream/MediaStream-page-muted-expected.txt:
        * fast/mediastream/MediaStream-page-muted.html:

2017-04-05  Javier Fernandez  <jfernandez@igalia.com>

        [css-align] Implement the place-items shorthand
        https://bugs.webkit.org/show_bug.cgi?id=168847

        Reviewed by David Hyatt.

        Regression tests for the new place-content alignment shorthand.

        * css3/parse-place-items.html: Added.

2017-04-05  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        [WebRTC][OpenWebRTC] Add support for SDP BUNDLE ("a:group:BUNDLE" and "a=bundle-only" lines)
        https://bugs.webkit.org/show_bug.cgi?id=170157

        Reviewed by Alejandro G. Castro.

        The test fast/mediastream/RTCPeerConnection-inspect-offer-bundlePolicy-bundle-only.html
        is used to check that we generate the "a=bundle-only" lines on the "m=" sections
        according to the bundlePolicy. The 3 possible values of bundlePolicy are tested.
        To properly test bundlePolicy:"balanced" we generate 5 extra tracks (6 in total)
        for each one of the audio media type and video media type.

        * TestExpectations: Set RTCPeerConnection-inspect-offer-bundlePolicy-bundle-only.html
        as failing in the general TestExpectations, because the libwebrtc backend currently
        doesn't generate the expected a=bundle-only lines.
        On the GTK+ port TestExpectations file this is overriden, and the test is marked to pass.
        The whole fast/mediastream directory is already overriden to pass.
        * fast/mediastream/RTCPeerConnection-inspect-offer-bundlePolicy-bundle-only-expected.txt: Added.
        * fast/mediastream/RTCPeerConnection-inspect-offer-bundlePolicy-bundle-only.html: Added.
        * fast/mediastream/resources/sdp-utils.js:
        (printComparableSessionDescription): Validate the a=group:BUNDLE line to contain the required MID identifiers.
        * platform/gtk/fast/mediastream/RTCPeerConnection-inspect-answer-expected.txt: Added. Rebaseline with the expected a=group:BUNDLE line.
        * platform/gtk/fast/mediastream/RTCPeerConnection-inspect-offer-expected.txt: Added. Rebaseline with the expected a=group:BUNDLE line.

2017-04-05  Jer Noble  <jer.noble@apple.com>

        [MSE] Seeks to currentTime=0 will fail if currentTime is already 0.
        https://bugs.webkit.org/show_bug.cgi?id=170510

        Reviewed by Eric Carlson.

        * media/media-source/media-source-unnecessary-seek-seeked-expected.txt: Added.
        * media/media-source/media-source-unnecessary-seek-seeked.html: Added.

2017-04-05  Matt Baker  <mattbaker@apple.com>

        Web Inspector: XHR breakpoints should be global
        https://bugs.webkit.org/show_bug.cgi?id=170033

        Reviewed by Joseph Pecoraro..

        * inspector/dom-debugger/xhr-breakpoints.html:
        Update for XHRBreakpoint constructor change.

2017-04-05  Chris Dumez  <cdumez@apple.com>

        <input type="range"> changing to disabled while active breaks all pointer events
        https://bugs.webkit.org/show_bug.cgi?id=170447
        <rdar://problem/31442875>

        Reviewed by Geoffrey Garen.

        Add layout test coverage.

        * fast/forms/range/disabled-while-dragging-expected.txt: Added.
        * fast/forms/range/disabled-while-dragging.html: Added.

2017-04-05  Jiewen Tan  <jiewen_tan@apple.com>

        Unreviewed, rebasing crypto/subtle/rsa-import-key-malformed-parameters.html
        <rdar://problem/31322400>

        * crypto/subtle/rsa-import-key-malformed-parameters-expected.txt:
        * crypto/subtle/rsa-import-key-malformed-parameters.html:

2017-04-05  Youenn Fablet  <youenn@apple.com>

        Deprecate and remove URL.createObjectURL(mediastream)
        https://bugs.webkit.org/show_bug.cgi?id=167518
        <rdar://problem/31149607>

        Reviewed by Eric Carlson.

        * fast/mediacapturefromelement/CanvasCaptureMediaStream-2d-events.html:
        * fast/mediacapturefromelement/CanvasCaptureMediaStream-request-frame-events.html:
        * fast/mediacapturefromelement/CanvasCaptureMediaStream-webgl-events.html:
        * fast/mediastream/MediaStream-video-element-displays-buffer-expected.txt:
        * fast/mediastream/MediaStream-video-element-displays-buffer.html:
        * fast/mediastream/MediaStream-video-element-expected.txt:
        * fast/mediastream/MediaStream-video-element-track-stop-expected.txt:
        * fast/mediastream/MediaStream-video-element-track-stop.html:
        * fast/mediastream/MediaStream-video-element-video-tracks-disabled-then-enabled-expected.txt:
        * fast/mediastream/MediaStream-video-element-video-tracks-disabled.html:
        * fast/mediastream/MediaStream-video-element.html:
        * fast/mediastream/resources/getUserMedia-helper.js:
        (setupVideoElementWithStream):

2017-04-05  Javier Fernandez  <jfernandez@igalia.com>

        [GTK] Unreviewed tests gardening
        https://bugs.webkit.org/show_bug.cgi?id=170497

        Unreviewed test gardening. Rebaseline tests after r214712.

        * platform/gtk/fast/multicol/table-vertical-align-expected.txt:


2017-04-04  Alexey Proskuryakov  <ap@apple.com>

        Mark imported/w3c/web-platform-tests/fetch/api/response/response-trailer.html as flaky
        for https://bugs.webkit.org/show_bug.cgi?id=170493

        * platform/mac/TestExpectations:

2017-04-04  Youenn Fablet  <youenn@apple.com>

        Canvas is tainted when painting a video with MediaStreamTrack
        https://bugs.webkit.org/show_bug.cgi?id=170486

        Reviewed by Eric Carlson.

        * http/tests/media/media-stream/getusermedia-with-canvas-expected.txt: Added.
        * http/tests/media/media-stream/getusermedia-with-canvas.html: Added.
        * http/tests/media/media-stream/resources/getUserMedia-helper.js: Added.
        (reject):
        (getUserMedia):
        (defaultRejectOrCatch):
        (setupVideoElementWithStream):

2017-04-04  Youenn Fablet  <youenn@apple.com>

        [Mac] Add back web audio support for getUserMedia MediaStreamTrack
        https://bugs.webkit.org/show_bug.cgi?id=170482

        Reviewed by Eric Carlson.

        * TestExpectations:

2017-04-04  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/images/slower-animation-than-decoding-image.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=168390

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-04  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/images/reset-image-animation.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170177

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-04  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/airplay-button/airplay-button.html as flaky on mac-wk1 Release.
        https://bugs.webkit.org/show_bug.cgi?id=168409

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-04  Brent Fulgham  <bfulgham@apple.com>

        Do not assert when CharacterData representing an Attr fires events
        https://bugs.webkit.org/show_bug.cgi?id=170454
        <rdar://problem/30979320>

        Reviewed by Ryosuke Niwa.

        * fast/dom/no-assert-for-malformed-js-url-attribute-expected.txt: Added.
        * fast/dom/no-assert-for-malformed-js-url-attribute.html: Added.

2017-04-04  Youenn Fablet  <youenn@apple.com>

        LayoutTest webrtc/libwebrtc/descriptionGetters.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=169481

        Reviewed by Eric Carlson.

        * platform/mac-wk2/TestExpectations: Removing flaky expectation.
        * webrtc/datachannel/basic.html:

2017-04-04  Ryan Haddad  <ryanhaddad@apple.com>

        Add back results that were accidentally removed with r214848.
        https://bugs.webkit.org/show_bug.cgi?id=169301

        Unreviewed test gardening.

        * platform/mac/fast/text/international/synthesized-italic-vertical-latin-expected.png: Added.
        * platform/mac/fast/text/international/synthesized-italic-vertical-latin-expected.txt: Added.

2017-04-04  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/macos-inline-media-controls/macos-inline-media-controls-buttons-styles.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170456

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-04  Youenn Fablet  <youenn@apple.com>

        webrtc/peer-connection-audio-mute.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=170451

        Reviewed by Eric Carlson.

        * TestExpectations: Removed flaky expectation for webrtc/peer-connection-audio-mute.html.
        * webrtc/peer-connection-remote-audio-mute.html: Added timer to ensure setting enable propagates.
        Decreasing time spent at detecting hum or not.
        * webrtc/peer-connection-remote-audio-mute2.html: Ditto (but keeping flakiness expectation for now).

2017-04-04  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/images/animated-gif-webkit-transform.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170410

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-04-03  Alexey Proskuryakov  <ap@apple.com>

        Re-adding flaky timeout expectation for http/tests/loading/resourceLoadStatistics/non-prevalent-resource-with-user-interaction.html

        This test still times out, most of the time.

        * platform/wk2/TestExpectations:

2017-04-03  Javier Fernandez  <jfernandez@igalia.com>

        [css-align] Adapt place-content alignment shorthand to the new baseline syntax
        https://bugs.webkit.org/show_bug.cgi?id=170340

        Reviewed by David Hyatt.

        Added additional test cases to evaluate the new baseline-alignment syntax.

        * css3/parse-place-content-expected.txt:
        * css3/parse-place-content.html:

2017-04-03  Nan Wang  <n_wang@apple.com>

        AX: Expose link children when doing search predication on iOS
        https://bugs.webkit.org/show_bug.cgi?id=170424
        <rdar://problem/31413335>

        Reviewed by Chris Fleizach.

        * accessibility/ios-simulator/ios-search-predicate-link-children-expected.txt: Added.
        * accessibility/ios-simulator/ios-search-predicate-link-children.html: Added.

2017-04-03  Dave Hyatt  <hyatt@apple.com>

        Japanese fonts in vertical text should support synthesized italics
        https://bugs.webkit.org/show_bug.cgi?id=169301

        Reviewed by Simon Fraser.

        * fast/text/international/synthesized-italic-vertical-expected.html:
        * fast/text/international/synthesized-italic-vertical.html:
        * platform/mac/fast/text/international/synthesized-italic-vertical-latin-expected.png: Removed.
        * platform/mac/fast/text/international/synthesized-italic-vertical-latin-expected.txt: Removed.

2017-04-03  Chris Dumez  <cdumez@apple.com>

        REGRESSION (r206744): CSS background-image in style attribute ignored when using createHTMLDocument method of DOM parsing
        https://bugs.webkit.org/show_bug.cgi?id=170285
        <rdar://problem/31378543>

        Reviewed by Andy Estes.

        Add layout test coverage.

        * fast/images/background-image-relative-url-changes-document-expected.html: Added.
        * fast/images/background-image-relative-url-changes-document.html: Added.

2017-04-03  John Wilander  <wilander@apple.com>

        Remove timeout expectations after bug fix
        https://bugs.webkit.org/show_bug.cgi?id=168262

        Unreviewed test gardening.

        Remove timeout expectations after bug fix in
        https://bugs.webkit.org/show_bug.cgi?id=170400

        * platform/wk2/TestExpectations:
            Remove expected timeout for the first five test cases
            under http/tests/loading/resourceLoadStatistics/.

2017-04-03  Antti Koivisto  <antti@apple.com>

        REGRESSION (r207669): FileMaker Pro Help pages do not render correctly
        https://bugs.webkit.org/show_bug.cgi?id=170402
        <rdar://problem/31004344>

        Reviewed by Simon Fraser.

        * fast/css/document-stylesheets-dynamic-expected.html: Added.
        * fast/css/document-stylesheets-dynamic.html: Added.

2017-04-03  Jeremy Jones  <jeremyj@apple.com>

        LayoutTest pointer-lock/mouse-event-delivery.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=167965

        Reviewed by Jon Lee.

        Wait for wheel event before doing next step of test. The wheel event is delivered asynchronously and
        can therefore be delivered later than expected by the test. This is already done for the first one,
        do this for the second one also.

        * platform/mac-wk2/TestExpectations:
        * pointer-lock/mouse-event-delivery.html:

2017-04-01  Simon Fraser  <simon.fraser@apple.com>

        Clean up touch event handler registration when moving nodes between documents
        https://bugs.webkit.org/show_bug.cgi?id=170384
        rdar://problem/30816694

        Reviewed by Chris Dumez.

        Tests for moving nodes with various listener/handler combinations between documents.

        * fast/events/touch/ios/gesture-node-move-between-documents-expected.txt: Added.
        * fast/events/touch/ios/gesture-node-move-between-documents.html: Added.
        * fast/events/touch/ios/overflow-node-move-between-documents-expected.txt: Added.
        * fast/events/touch/ios/overflow-node-move-between-documents.html: Added.
        * fast/events/touch/ios/slider-node-move-between-documents-expected.txt: Added.
        * fast/events/touch/ios/slider-node-move-between-documents.html: Added.
        * fast/events/touch/ios/touch-node-move-between-documents-expected.txt: Added.
        * fast/events/touch/ios/touch-node-move-between-documents.html: Added.

2017-04-03  Carlos Garcia Campos  <cgarcia@igalia.com>

        [SOUP] URI Fragment is lost after redirect
        https://bugs.webkit.org/show_bug.cgi?id=170058

        Reviewed by Michael Catanzaro.

        Add tests to check we correctly handle fragment identifiers on server redirections.

        * http/tests/navigation/redirect-preserves-fragment-expected.txt: Added.
        * http/tests/navigation/redirect-preserves-fragment.html: Added.
        * http/tests/navigation/redirect-to-fragment-expected.txt: Added.
        * http/tests/navigation/redirect-to-fragment.html: Added.
        * http/tests/navigation/redirect-to-fragment2-expected.txt: Added.
        * http/tests/navigation/redirect-to-fragment2.html: Added.
        * http/tests/navigation/resources/redirect-preserves-fragment.php: Added.
        * http/tests/navigation/resources/redirect-to-fragment.php: Added.
        * http/tests/navigation/resources/redirect-to-fragment2.php: Added.
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:

2017-04-03  Youenn Fablet  <youenn@apple.com>

        captureStream is getting black frames with webgl canvas
        https://bugs.webkit.org/show_bug.cgi?id=170325

        Reviewed by Dean Jackson.

        * fast/mediastream/captureStream/canvas3d-expected.txt: Added.
        * fast/mediastream/captureStream/canvas3d.html: Added.

2017-04-03  Per Arne Vollan  <pvollan@apple.com>

        Implement stroke-miterlimit.
        https://bugs.webkit.org/show_bug.cgi?id=169078

        Reviewed by Dean Jackson.

        * fast/css/stroke-miterlimit-default-expected.html: Added.
        * fast/css/stroke-miterlimit-default.html: Added.
        * fast/css/stroke-miterlimit-large-expected-mismatch.html: Added.
        * fast/css/stroke-miterlimit-large.html: Added.
        * fast/css/stroke-miterlimit-zero-expected-mismatch.html: Added.
        * fast/css/stroke-miterlimit-zero.html: Added.

2017-04-02  Alexey Proskuryakov  <ap@apple.com>

        Remove accidentally added DumpJSConsoleLogInStdErr from http/tests/fetch/fetch-in-worker-crash.html expectation.

        * TestExpectations:

2017-04-02  Alexey Proskuryakov  <ap@apple.com>

        Build fix for
        Add missing text styles
        https://bugs.webkit.org/show_bug.cgi?id=170295

        * platform/ios/ios/fast/text/opticalFontWithTextStyle-expected.txt:

2017-04-02  Alexey Proskuryakov  <ap@apple.com>

        Fix lint errors.

        * TestExpectations:
        * platform/ios-wk1/TestExpectations:
        * platform/ios-wk2/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/mac-wk1/TestExpectations:

2017-04-02  Alexey Proskuryakov  <ap@apple.com>

        Mark http/tests/fetch/fetch-in-worker-crash.html and imported/w3c/web-platform-tests/fetch/api/cors/cors-preflight-status.html as flaky.

        For https://bugs.webkit.org/show_bug.cgi?id=170395
        rdar://problem/30975761, rdar://problem/31394017

        * TestExpectations:

2017-04-01  Per Arne Vollan  <pvollan@apple.com>

        Add test for expected fallback behavior between stroke-width and -webkit-text-stroke-width.
        https://bugs.webkit.org/show_bug.cgi?id=169466

        Reviewed by Jon Lee.

        Now that we have added support for stroke-width, we should have a test for expected fallback behavior between
        stroke-width and -webkit-text-stroke-width. Currently, stroke-width is always preferred, also when inherited,
        and when -webkit-text-stroke-width is declared inline. When stroke-width is not specified, we fall back to
        -webkit-text-stroke-width.

        * fast/css/stroke-width-fallback-expected.html: Added.
        * fast/css/stroke-width-fallback.html: Added.

2017-04-01  Jon Lee  <jonlee@apple.com>

        Add missing text styles
        https://bugs.webkit.org/show_bug.cgi?id=170295
        rdar://problem/30219503

        Reviewed by Dean Jackson.

        * platform/ios/ios/fast/text/opticalFontWithTextStyle.html: Update test to include title0 and title4.

2017-04-01  Chris Dumez  <cdumez@apple.com>

        We should pause silent WebAudio rendering in background tabs
        https://bugs.webkit.org/show_bug.cgi?id=170299
        <rdar://problem/31289132>

        Reviewed by Eric Carlson.

        Add layout test coverage.

        * webaudio/silent-audio-interrupted-in-background-expected.txt: Added.
        * webaudio/silent-audio-interrupted-in-background.html: Added.

2017-04-01  Alexey Proskuryakov  <ap@apple.com>

        Rolling back http://trac.webkit.org/r214663 - memory corruption

        * streams/readable-stream-byob-request-expected.txt:
        * streams/readable-stream-byob-request.js:
        (self.importScripts.test): Deleted.

2017-03-31  Zalan Bujtas  <zalan@apple.com>

        <table>: Including <caption>, <thead> or <tbody> causes clipping across page breaks
        https://bugs.webkit.org/show_bug.cgi?id=170348
        <rdar://problem/24727151>

        Reviewed by David Hyatt.

        * fast/multicol/table-section-page-break-expected.html: Added.
        * fast/multicol/table-section-page-break.html: Added.

2017-03-31  Chris Dumez  <cdumez@apple.com>

        LayoutTest fast/images/animated-gif-restored-from-bfcache.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=162510
        <rdar://problem/31380650>

        Reviewed by Alexey Proskuryakov.

        The test restores a page from PageCache and wants to check that an animated
        GIF is properly animating. To do so, it store the data of the current image
        frame, and then checks in a 100ms timer that the current image frame is
        different. This is flaky by nature since the image only has 10 frames and
        you therefore have a 1/10 chance that the new frame will be the same as the
        previous one, even if the image is properly animating.

        To address the problem, do a setInterval instead of a setTimeout and check
        until the frame becomes different.

        * fast/images/animated-gif-restored-from-bfcache.html:
        * platform/mac/TestExpectations:

2017-03-31  Wenson Hsieh  <wenson_hsieh@apple.com>

        [WK2] Tapping away to dismiss the selection does not update the selected DOM range using character granularity
        https://bugs.webkit.org/show_bug.cgi?id=170328
        <rdar://problem/30904558>

        Reviewed by Tim Horton.

        Adds a new layout test verifying that when a user taps away to clear the current selection in character
        granularity selection mode, the selected DOM range in the web process does not fall out of sync with UIKit's
        selection views, which are dismissed.

        * editing/selection/character-granularity-selected-range-after-dismissing-selection-expected.txt: Added.
        * editing/selection/character-granularity-selected-range-after-dismissing-selection.html: Added.

2017-03-31  Youenn Fablet  <youenn@apple.com>

        Add a test to ensure webrtc generated certificates and names are ephemeral
        https://bugs.webkit.org/show_bug.cgi?id=170225

        Reviewed by Jon Lee.

        * webrtc/ephemeral-certificates-and-cnames-expected.txt: Added.
        * webrtc/ephemeral-certificates-and-cnames.html: Added.

2017-03-31  Wenson Hsieh  <wenson_hsieh@apple.com>

        [WK2] Tapping editable text inside of a range selection no longer changes the selection to a caret
        https://bugs.webkit.org/show_bug.cgi?id=170327
        <rdar://problem/31363816>

        Reviewed by Tim Horton.

        Adds a new WK2 interaction test for iOS verifying that tapping a selection in editable content sets the selection
        to a caret, rather than maintaining the range selection. This test is disabled in OpenSource, since it relies on
        synthetic touch events.

        * TestExpectations:
        * editing/selection/caret-after-tap-in-editable-selection-expected.txt: Added.
        * editing/selection/caret-after-tap-in-editable-selection.html: Added.

2017-03-31  Alexey Proskuryakov  <ap@apple.com>

        Mark fast/mediastream/MediaStream-page-muted.html as flaky for
        https://bugs.webkit.org/show_bug.cgi?id=170355

        * TestExpectations:

2017-03-31  Alexey Proskuryakov  <ap@apple.com>

        Correction for the previous change - this is an image failure.

        * platform/mac-wk2/TestExpectations:

2017-03-31  Alexey Proskuryakov  <ap@apple.com>

        Mark fast/images/animated-image-different-dest-size.html as flaky for
        https://bugs.webkit.org/show_bug.cgi?id=170203

        * platform/mac-wk2/TestExpectations:

2017-03-31  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of several tests.

        Also rebaseline fast/css/getComputedStyle/computed-style-font-family.html after r214394, it also requires variation
        fonts.

        * platform/gtk/TestExpectations:
        * platform/gtk/fast/css/getComputedStyle/computed-style-font-family-expected.txt: Added.

2017-03-31  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Rebaseline several tests after r214546.

        GTK+ port doesn't support variation fonts. Also mark canvas/philip/tests/2d.pattern.animated.gif.html as failing
        after r214503.

        * platform/gtk/TestExpectations:
        * platform/gtk/fast/text/font-selection-font-loading-api-parse-expected.txt: Added.
        * platform/gtk/fast/text/font-stretch-parse-expected.txt: Added.
        * platform/gtk/fast/text/font-style-parse-expected.txt: Added.
        * platform/gtk/fast/text/font-weight-parse-expected.txt: Added.

2017-03-31  Romain Bellessort  <romain.bellessort@crf.canon.fr>

        [Readable Streams API] Implement cloneArrayBuffer in WebCore
        https://bugs.webkit.org/show_bug.cgi?id=170008

        Reviewed by Youenn Fablet.

        Added test to check cloneArrayBuffer behaviour. 

        * streams/readable-stream-byob-request.js:

2017-03-31  Oleksandr Skachkov  <gskachkov@gmail.com>

        String.prototype.replace incorrectly applies "special replacement parameters" when passed a function
        https://bugs.webkit.org/show_bug.cgi?id=170151

        Reviewed by Saam Barati.

        * js/script-tests/string_replace_function.js: Added.
        * js/script-tests/string_replace_regexp.js: Renamed from LayoutTests/js/script-tests/string_replace.js.
        * js/string_replace_function-expected.txt: Added.
        * js/string_replace_function.html: Copied from LayoutTests/js/string_replace.html.
        * js/string_replace_regexp-expected.txt: Renamed from LayoutTests/js/string_replace-expected.txt.
        * js/string_replace_regexp.html: Renamed from LayoutTests/js/string_replace.html.

2017-03-31  Manuel Rego Casasnovas  <rego@igalia.com>

        [css-grid] Update W3C Test Suite
        https://bugs.webkit.org/show_bug.cgi?id=170170

        Reviewed by Youenn Fablet.

        Update path to tests in TestExpectations as the CSS Grid Layout suite
        is now under web-platform-tests.

        * TestExpectations:

2017-03-31  Antoine Quint  <graouts@apple.com>

        [mac-wk1] LayoutTest media/modern-media-controls/airplay-button/airplay-button.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=168409
        <rdar://problem/30799198>

        Unreviewed. Capture new logging events.

        * media/modern-media-controls/airplay-button/airplay-button.html:

2017-03-30  Matt Baker  <mattbaker@apple.com>

        Unreviewed. Update test expectations after https://bugs.webkit.org/show_bug.cgi?id=170279.

        * inspector/css/getAllStyleSheets-expected.txt:

2017-03-30  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline js/dom/global-constructors-attributes.html.

        Unreviewed test gardening.

        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-03-30  Simon Fraser  <simon.fraser@apple.com>

        Rename a touch event function, and new touch region test results
        https://bugs.webkit.org/show_bug.cgi?id=170309
        rdar://problem/31329520

        Reviewed by Chris Dumez.

        A code change in WebKitAdditions progresses this test result.

        * fast/events/touch/ios/touch-event-regions/iframes-expected.txt:

2017-03-30  Said Abou-Hallawa  <sabouhallawa@apple.com>

        REGRESSION (r213764): Background image from sprite sheet incorrectly scaled
        https://bugs.webkit.org/show_bug.cgi?id=169547

        Reviewed by Simon Fraser.

        * fast/images/async-image-background-image.html:
        * fast/images/resources/sprite-sheet-red-green-blue.png: Added.
        * fast/images/sprite-sheet-image-draw-expected.html: Added.
        * fast/images/sprite-sheet-image-draw.html: Added.

2017-03-30  Matt Baker  <mattbaker@apple.com>

        Web Inspector: Assertion failure in InspectorStyleProperty::setRawTextFromStyleDeclaration
        https://bugs.webkit.org/show_bug.cgi?id=170279
        <rdar://problem/30200492>

        Reviewed by David Hyatt.

        * inspector/css/getAllStyleSheets.html:
        Add stylesheet with an "unparsed" property having no final semicolon.

2017-03-30  Youenn Fablet  <youenn@apple.com>

        Clean up RTCDataChannel
        https://bugs.webkit.org/show_bug.cgi?id=169732

        Reviewed by Chris Dumez.

        * webrtc/datachannel/bufferedAmountLowThreshold-expected.txt: Added.
        * webrtc/datachannel/bufferedAmountLowThreshold.html: Added.

2017-03-30  Chris Dumez  <cdumez@apple.com>

        svg/animations/animations-paused-in-background-page.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=170290

        Reviewed by Simon Fraser.

        Fix shouldBecomeEqual() check in the test which was wrong and was passing by chance
        due to a race.

        * svg/animations/animations-paused-in-background-page-expected.txt:
        * svg/animations/animations-paused-in-background-page.html:

2017-03-30  Javier Fernandez  <jfernandez@igalia.com>

        [css-align] Adapt content-alignment properties to the new baseline syntax
        https://bugs.webkit.org/show_bug.cgi?id=170262

        Reviewed by David Hyatt.

        Added new cases to the alignment properties parsing tests so that we can verify the new
        baseline-alignment syntax is parsed as expected.
        Additionally, I modified the tests so that they use the testharness format.

        * css3/parse-align-content-expected.txt:
        * css3/parse-align-content.html:
        * css3/parse-justify-content-expected.txt:
        * css3/parse-justify-content.html:

2017-03-30  James Craig  <jcraig@apple.com>

        AX: Expose a new AXSubrole for explicit ARIA "group" role
        https://bugs.webkit.org/show_bug.cgi?id=169810
        <rdar://problem/31039693>

        Reviewed by Chris Fleizach.

        * accessibility/list-detection2-expected.txt:
        * accessibility/list-detection2.html:
        * accessibility/roles-computedRoleString.html:
        * inspector/dom/getAccessibilityPropertiesForNode-expected.txt:
        * inspector/dom/highlightFrame-expected.txt:
        * inspector/dom/highlightSelector-expected.txt:
        * platform/mac/accessibility/roles-computedRoleString-expected.txt:
        * platform/mac/accessibility/roles-exposed-expected.txt:

2017-03-30  Youenn Fablet  <youenn@apple.com>

        webrtc/video-stats.html and webrtc/video-replace-track.html are flaky
        https://bugs.webkit.org/show_bug.cgi?id=170294

        Unreviewed.

        * TestExpectations: Marking these tests as flaky.

2017-03-30  Eric Carlson  <eric.carlson@apple.com>

        [Crash] WebCore::AudioBuffer::AudioBuffer don't checking illegal value
        https://bugs.webkit.org/show_bug.cgi?id=169956

        Reviewed by Youenn Fablet.

        * webaudio/audiobuffer-crash-expected.txt: Added.
        * webaudio/audiobuffer-crash.html: Added.

2017-03-30  Simon Fraser  <simon.fraser@apple.com>

        Add some tests that dump the touch event regions with various content configurations
        https://bugs.webkit.org/show_bug.cgi?id=170216

        Followup: add missing results files, and tweak iframes.html to show that regions fail to
        take iframe borders into account.

        * fast/events/touch/ios/touch-event-regions/active-passive-nesting-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/columns-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/complex-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/document-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/iframes-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/iframes.html:
        * fast/events/touch/ios/touch-event-regions/overflow-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/range-sliders-expected.txt: Added.

2017-03-30  Per Arne Vollan  <pvollan@apple.com>

        [mac-wk1 debug] LayoutTest media/track/track-cue-rendering-with-padding.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=170188

        Reviewed by Eric Carlson.

        The textTrackDisplayElement call will fail and throw an exception if the text track display element
        has not yet been added to the text track container element. We wait until it has been added.

        * media/track/track-cue-rendering-with-padding.html:

2017-03-30  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] Invalid placard icon is not visible for short video
        https://bugs.webkit.org/show_bug.cgi?id=170277
        <rdar://problem/31327955>

        Reviewed by Eric Carlson.

        Add a new test to check that we correctly hide the invalid icon only when
        there is no space left to display it.

        * media/modern-media-controls/invalid-placard/invalid-placard-constrained-metrics-expected.txt: Added.
        * media/modern-media-controls/invalid-placard/invalid-placard-constrained-metrics.html: Added.

2017-03-27  Sergio Villar Senin  <svillar@igalia.com>

        [css-grid] Clamp the number of autorepeat tracks
        https://bugs.webkit.org/show_bug.cgi?id=170120

        Reviewed by Manuel Rego Casasnovas.

        Added a new test to check the clamping of grid tracks. It's mostly all JavaScript in order
        to allow us to run several test cases over a small number of grids in a single file quite
        fast. The other option was to statically (CSS) create several huge grids, something that
        could potentially be very expensive in terms of memory and CPU leading to timeouts.

        * fast/css-grid-layout/grid-auto-repeat-huge-grid-expected.txt: Added.
        * fast/css-grid-layout/grid-auto-repeat-huge-grid.html: Added.

2017-03-30  Antoine Quint  <graouts@apple.com>

        [mac-wk1] LayoutTest media/modern-media-controls/airplay-button/airplay-button.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=168409
        <rdar://problem/30799198>

        Unreviewed. Add logging related to visibility since document.visibility = hidden would cause the
        requestAnimationFrame() call to suspend the ScriptedAnimationController.

        * media/modern-media-controls/airplay-button/airplay-button.html:

2017-03-30  Per Arne Vollan  <pvollan@apple.com>

        REGRESSION(~r212322): LayoutTest media/track/track-cue-container-rendering-position.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=168660

        Reviewed Eric Carlson.

        The textTrackDisplayElement call will fail and throw an exception if the text track display element
        has not yet been added to the text track container element. We wait until it has been added.

        * media/track/track-cue-container-rendering-position.html:

2017-03-29  Ryosuke Niwa  <rniwa@webkit.org>

        Disconnecting a HTMLObjectElement does not always unload its content document
        https://bugs.webkit.org/show_bug.cgi?id=169606

        Reviewed by Andy Estes.

        Add a regression test.

        * fast/dom/removing-focused-object-element-expected.txt: Added.
        * fast/dom/removing-focused-object-element.html: Added.

2017-03-29  Simon Fraser  <simon.fraser@apple.com>

        Add some tests that dump the touch event regions with various content configurations
        https://bugs.webkit.org/show_bug.cgi?id=170216

        Reviewed by Dean Jackson.

        Tests for touch event regions. Some of these are modeled after tests in tiled-drawing/scrolling/non-fast-region/.

        * fast/events/touch/ios/touch-event-regions/resources/touch-regions-helper.js: Added.
        * fast/events/touch/ios/touch-event-regions/active-passive-nesting-expected.html: Added.
        * fast/events/touch/ios/touch-event-regions/active-passive-nesting.html: Added.
        * fast/events/touch/ios/touch-event-regions/columns-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/columns.html: Added.
        * fast/events/touch/ios/touch-event-regions/complex-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/complex.html: Added.
        * fast/events/touch/ios/touch-event-regions/document-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/document.html: Added.
        * fast/events/touch/ios/touch-event-regions/iframes-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/iframes.html: Added.
        * fast/events/touch/ios/touch-event-regions/overflow-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/overflow.html: Added.
        * fast/events/touch/ios/touch-event-regions/range-sliders-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/range-sliders.html: Added.

2017-03-28  Simon Fraser  <simon.fraser@apple.com>

        Make it possible to dump touch event regions for testing
        https://bugs.webkit.org/show_bug.cgi?id=170209
        <rdar://problem/31309258>

        Reviewed by Tim Horton.

        Simple test that dumps the regions.

        * fast/events/touch/ios/touch-event-regions-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions.html: Added.

2017-03-29  Zalan Bujtas  <zalan@apple.com>

        RenderBlockFlow::addFloatsToNewParent should check if float is already added to the object list.
        https://bugs.webkit.org/show_bug.cgi?id=170259
        <rdar://problem/31300584>

        Reviewed by Simon Fraser.

        * fast/block/float/placing-multiple-floats-crash-expected.txt: Added.
        * fast/block/float/placing-multiple-floats-crash.html: Added.

2017-03-29  Tim Horton  <timothy_horton@apple.com>

        Swipe gesture tests don't work on macOS Sierra
        https://bugs.webkit.org/show_bug.cgi?id=161675
        <rdar://problem/23379930>

        Reviewed by Darin Adler.

        * platform/mac-wk2/TestExpectations:
        * swipe/basic-cached-back-swipe-expected.txt:
        * swipe/basic-cached-back-swipe.html:
        * swipe/main-frame-pinning-requirement-expected.txt:
        * swipe/main-frame-pinning-requirement.html:
        * swipe/pushState-cached-back-swipe-expected.txt:
        * swipe/pushState-cached-back-swipe.html:
        * swipe/pushState-programmatic-back-while-swiping-crash-expected.txt:
        * swipe/pushState-programmatic-back-while-swiping-crash.html:
        * swipe/resources/swipe-test.js:
        (measuredDurationShouldBeLessThan):
        (startSwipeGesture):
        (completeSwipeGesture):
        (playEventStream):
        (eventQueue.enqueueScrollEvent): Deleted.
        (eventQueue.enqueueSwipeEvent): Deleted.
        (eventQueue.hasPendingEvents): Deleted.
        (eventQueue.callAfterEventDispatch): Deleted.
        (eventQueue._processEventQueue): Deleted.
        (eventQueue._processEventQueueSoon): Deleted.
        * swipe/swipe-start-hysteresis-failures-expected.txt: Removed.
        * swipe/swipe-start-hysteresis-failures.html: Removed.

2017-03-29  Myles C. Maxfield  <mmaxfield@apple.com>

        Try to normalize variation ranges
        https://bugs.webkit.org/show_bug.cgi?id=170119

        Reviewed by Simon Fraser.

        * fast/text/variations/font-selection-properties-expected.html:

2017-03-29  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/media/modern-media-controls/time-labels-support/long-time.html as flaky on macOS.
        https://bugs.webkit.org/show_bug.cgi?id=169677

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:
        * platform/mac/TestExpectations:

2017-03-29  Javier Fernandez  <jfernandez@igalia.com>

        [css-align] Adapt self-alignment properties to the new baseline syntax
        https://bugs.webkit.org/show_bug.cgi?id=170235

        Reviewed by David Hyatt.

        Added new cases to the alignment properties parsing tests so that we can verify the new
        baseline-alignment syntax is parsed as expected.
        Additionally, I modified the tests so that they use the testharness format.

        * css3/parse-align-items-expected.txt:
        * css3/parse-align-items.html:
        * css3/parse-align-self-expected.txt:
        * css3/parse-align-self.html:
        * css3/resources/alignment-parsing-utils-th.js:
        (checkValues):
        * fast/css/parse-justify-items-expected.txt:
        * fast/css/parse-justify-items.html:
        * fast/css/parse-justify-self-expected.txt:
        * fast/css/parse-justify-self.html:
        * fast/css/resources/alignment-parsing-utils-th.js: Copied from LayoutTests/css3/resources/alignment-parsing-utils-th.js.
        (checkValues):
        (checkBadValues):
        (checkInitialValues):
        (checkInheritValues):
        (checkLegacyValues):
        (checkSupportedValues):

2017-03-29  Chris Dumez  <cdumez@apple.com>

        Animated SVG images are not paused in pages loaded in the background
        https://bugs.webkit.org/show_bug.cgi?id=170043
        <rdar://problem/31234412>

        Reviewed by Simon Fraser.

        Extend layout test coverage.

        * svg/animations/animations-paused-in-background-page-expected.txt: Added.
        * svg/animations/animations-paused-in-background-page-iframe-expected.txt: Added.
        * svg/animations/animations-paused-in-background-page-iframe.html: Added.
        * svg/animations/animations-paused-in-background-page.html: Added.
        * svg/animations/resources/iframe-with-animated-svg-image.html: Added.

2017-03-29  Myles C. Maxfield  <mmaxfield@apple.com>

        Post-commit test gardening after r214546
        https://bugs.webkit.org/show_bug.cgi?id=169518

        Unreviewed.

        * platform/mac-elcapitan/fast/text/font-selection-font-loading-api-parse-expected.txt:
        * platform/mac-elcapitan/fast/text/font-style-parse-expected.txt:

2017-03-29  Myles C. Maxfield  <mmaxfield@apple.com>

        Post-commit test gardening after r214546
        https://bugs.webkit.org/show_bug.cgi?id=169518

        Unreviewed.

        * platform/mac-elcapitan/fast/text/font-selection-font-loading-api-parse-expected.txt:
        * platform/mac-elcapitan/fast/text/font-style-parse-expected.txt:

2017-03-29  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/events/before-unload-adopt-subframe-to-outside.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170130

        Unreviewed test gardening.

        * TestExpectations:

2017-03-29  Myles C. Maxfield  <mmaxfield@apple.com>

        Variation fonts: Make sure that feature detection and preprocessor macros are right
        https://bugs.webkit.org/show_bug.cgi?id=169518

        Reviewed by Simon Fraser.

        Create platform-specific results for mac-elcapitan which doesn't support variation fonts.

        * fast/text/font-variations-feature-detection-expected.html: Added.
        * fast/text/font-variations-feature-detection.html: Added.
        * platform/ios-simulator/TestExpectations:
        * platform/mac-elcapitan/fast/text/font-selection-font-face-parse-expected.txt:
        * platform/mac-elcapitan/fast/text/font-selection-font-loading-api-parse-expected.txt: Added.
        * platform/mac-elcapitan/fast/text/font-stretch-parse-expected.txt: Added.
        * platform/mac-elcapitan/fast/text/font-style-parse-expected.txt: Added.
        * platform/mac-elcapitan/fast/text/font-weight-parse-expected.txt: Added.
        * platform/mac/TestExpectations:

2017-03-29  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] Controls bar may disappear while captions menu is visible (redux)
        https://bugs.webkit.org/show_bug.cgi?id=170239
        <rdar://problem/31320685>

        Reviewed by Dean Jackson.

        We extend an existing test to cover the case where we would hide the controls bar while the tracks panel
        is up by mousing out of the media. We also add a new test where we check that clicking over the controls
        bar to dismiss the tracks panel does not hide the controls bar. Finally, we make a small change to an
        existing test to listen to "transitionend" event on the tracks panel specifically since with this patch
        the controls bar would disappear and trigger a similar event when disappearing as the tracks panel is dismissed.

        * media/modern-media-controls/tracks-panel/tracks-panel-controls-bar-remains-visible-after-clicking-over-it-expected.txt: Added.
        * media/modern-media-controls/tracks-panel/tracks-panel-controls-bar-remains-visible-after-clicking-over-it.html: Added.
        * media/modern-media-controls/tracks-panel/tracks-panel-prevent-controls-bar-from-fading-expected.txt:
        * media/modern-media-controls/tracks-panel/tracks-panel-prevent-controls-bar-from-fading.html:
        * media/modern-media-controls/tracks-support/tracks-support-click-track-in-panel.html:

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/workers/worker-close-more.html as a flaky timeout.
        https://bugs.webkit.org/show_bug.cgi?id=169838

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-03-29  Youenn Fablet  <youenn@apple.com>

        Move DTMF WebRTC extension behind its own compile flag
        https://bugs.webkit.org/show_bug.cgi?id=170226

        Reviewed by Eric Carlson.

        * TestExpectations:
        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-yosemite/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-03-29  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        [GTK][OWR] Rebaseline fast/mediastream/RTCPeerConnection-addIceCandidate.html after r214527
        https://bugs.webkit.org/show_bug.cgi?id=170192

        Unreviewed test gardening.

        * platform/gtk/fast/mediastream/RTCPeerConnection-addIceCandidate-expected.txt:

2017-03-29  Youenn Fablet  <youenn@apple.com>

        Add test for differentiating camera versus canvas stream
        https://bugs.webkit.org/show_bug.cgi?id=169698
        <rdar://problem/31076026>

        Reviewed by Eric Carlson.

        * fast/mediastream/captureStream/canvas2d.html:

2017-03-28  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        [WebRTC] Update test RTCPeerConnection-overloaded-operations-params.html after r214441
        https://bugs.webkit.org/show_bug.cgi?id=170223

        Reviewed by Youenn Fablet.

        After r214441 the arguments of addIceCandidate() are nullable.

        * fast/mediastream/RTCPeerConnection-overloaded-operations-params-expected.txt:
        * fast/mediastream/RTCPeerConnection-overloaded-operations-params.html:
        * platform/gtk/fast/mediastream/RTCPeerConnection-overloaded-operations-params-expected.txt: Removed. The expected result was the same than the general one.

2017-03-29  Antoine Quint  <graouts@apple.com>

        [mac-wk1] LayoutTest media/modern-media-controls/airplay-button/airplay-button.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=168409
        <rdar://problem/30799198>

        Reviewed by Dean Jackson.

        Opt into ScriptedAnimationController logging.

        * media/modern-media-controls/airplay-button/airplay-button-expected.txt:
        * media/modern-media-controls/airplay-button/airplay-button.html:

2017-03-28  Youenn Fablet  <youenn@apple.com>

        [WebRTC] After r214441 addIceCandidate no longer accepts an RTCIceCandidateInit dictionary
        https://bugs.webkit.org/show_bug.cgi?id=170192

        Reviewed by Jon Lee.

        * fast/mediastream/RTCIceCandidate-expected.txt:
        * fast/mediastream/RTCIceCandidate.html: Removing no longer valid tests.
        * fast/mediastream/RTCPeerConnection-addIceCandidate-expected.txt:
        * fast/mediastream/RTCPeerConnection-addIceCandidate.html: Adding more tests to cover null/undefined cases.
        Ensuring sdpMid has a valid value.
        * fast/mediastream/resources/promise-utils.js: Improving error logging.

2017-03-27  Brent Fulgham  <bfulgham@apple.com>

        Only attach Attributes to a given element one time
        https://bugs.webkit.org/show_bug.cgi?id=170125
        <rdar://problem/31279676>

        Reviewed by Chris Dumez.

        * fast/dom/Attr/make-unique-element-data-while-replacing-attr-expected.txt: Rebaselined.
        * fast/dom/Attr/make-unique-element-data-while-replacing-attr.html: Add check before setting new value.
        * fast/dom/Attr/only-attach-attr-once-expected.txt: Added.
        * fast/dom/Attr/only-attach-attr-once.html: Added.

2017-03-28  Youenn Fablet  <youenn@apple.com>

        Stop RTCDataChannel when closing page
        https://bugs.webkit.org/show_bug.cgi?id=170166

        Reviewed by Eric Carlson.

        * webrtc/datachannel/datachannel-gc-expected.txt: Added.
        * webrtc/datachannel/datachannel-gc.html: Added.

2017-03-28  Myles C. Maxfield  <mmaxfield@apple.com>

        Ranges for variation font properties are not enforced
        https://bugs.webkit.org/show_bug.cgi?id=169979

        Reviewed by David Hyatt.

        * fast/text/font-selection-font-face-parse-expected.txt:
        * fast/text/font-selection-font-face-parse.html:
        * fast/text/font-selection-font-loading-api-parse-expected.txt:
        * fast/text/font-selection-font-loading-api-parse.html:
        * fast/text/font-style-parse-expected.txt:
        * fast/text/font-style-parse.html:
        * fast/text/variations/font-loading-api-parse-ranges-expected.txt:
        * fast/text/variations/font-loading-api-parse-ranges.html:
        * fast/text/variations/out-of-bounds-selection-properties-expected.txt: Added.
        * fast/text/variations/out-of-bounds-selection-properties.html: Added.
        * platform/mac-elcapitan/fast/text/font-selection-font-face-parse-expected.txt:

2017-03-28  Andy Estes  <aestes@apple.com>

        [iOS] Crash in -[WebPreviewLoader failed] when running http/tests/multipart/policy-ignore-crash.php
        https://bugs.webkit.org/show_bug.cgi?id=170197
        <rdar://problem/30314067>

        Reviewed by Brady Eidson.

        * platform/ios/TestExpectations: Unskipped http/tests/multipart/policy-ignore-crash.php.
        * platform/ios/http/tests/multipart/policy-ignore-crash-expected.txt: Added an iOS-specific result.

2017-03-28  Chris Dumez  <cdumez@apple.com>

        Animated SVG images are not paused when outside viewport
        https://bugs.webkit.org/show_bug.cgi?id=170155
        <rdar://problem/31288893>

        Reviewed by Antti Koivisto.

        Add layout test coverage.

        * platform/mac-wk1/TestExpectations:
        * svg/animations/animated-svg-image-outside-viewport-paused-expected.txt: Added.
        * svg/animations/animated-svg-image-outside-viewport-paused.html: Added.
        * svg/animations/animated-svg-image-removed-from-document-paused-expected.txt: Added.
        * svg/animations/animated-svg-image-removed-from-document-paused.html: Added.
        * svg/animations/resources/smilAnimation.svg: Added.

2017-03-28  Antti Koivisto  <antti@apple.com>

        Missing render tree position invalidation when tearing down renderers for display:contents subtree
        https://bugs.webkit.org/show_bug.cgi?id=170199
        <rdar://problem/31260856>

        Reviewed by Zalan Bujtas.

        * fast/shadow-dom/slot-renderer-teardown-expected.txt: Added.
        * fast/shadow-dom/slot-renderer-teardown.html: Added.

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r214485.

        This change caused LayoutTest crashes.

        Reverted changeset:

        "Stop RTCDataChannel when closing page"
        https://bugs.webkit.org/show_bug.cgi?id=170166
        http://trac.webkit.org/changeset/214485

2017-03-28  Brian Burg  <bburg@apple.com>

        Web Inspector: Add "Disable Caches" option that only applies to the inspected page while Web Inspector is open
        https://bugs.webkit.org/show_bug.cgi?id=169865
        <rdar://problem/31250573>

        Reviewed by Joseph Pecoraro.

        Add tests that verify the new command works as expected when it disables resource caching.
        I also manually verified that the override setting is cleared when Web Inspector disconnects.
        This is not easy to check in a layout test since we rely on the Web Inspector to tell whether
        a load happened or not.

        * http/tests/inspector/network/set-resource-caching-disabled-disk-cache-expected.txt: Added.
        * http/tests/inspector/network/set-resource-caching-disabled-disk-cache.html: Added.
        * http/tests/inspector/network/set-resource-caching-disabled-memory-cache-expected.txt: Added.
        * http/tests/inspector/network/set-resource-caching-disabled-memory-cache.html: Added.

2017-03-28  Youenn Fablet  <youenn@apple.com>

        Update LayoutTests/fast/mediastream/RTCPeerConnection-addIceCandidate.html to get more coverage
        https://bugs.webkit.org/show_bug.cgi?id=170194

        Reviewed by Chris Dumez.

        * fast/mediastream/RTCPeerConnection-addIceCandidate-expected.txt:
        * fast/mediastream/RTCPeerConnection-addIceCandidate.html: Making test more robust to failures to get more coverage.

2017-03-28  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Inspecting a Main Resource that is JS/JSON does not format / syntax highlight it properly
        https://bugs.webkit.org/show_bug.cgi?id=166862
        <rdar://problem/29835977>

        Reviewed by Brian Burg.

        * http/tests/inspector/network/resource-mime-type-expected.txt: Added.
        * http/tests/inspector/network/resource-mime-type.html: Added.
        Test resource mime types for different resources.

        * http/tests/inspector/network/resources/json.php: Added.
        * http/tests/inspector/network/resources/script.js: Added.
        * http/tests/inspector/network/resources/script.txt: Added.
        * http/tests/inspector/network/resources/stylesheet.css: Added.
        * http/tests/inspector/network/resources/stylesheet.txt: Added.
        * http/tests/resources/square20.jpg: Added.
        Resources for various requests and different mime types.

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/xmlhttprequest/simple-cross-origin-progress-events.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=168132

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark two fast/scrolling/ios/touch-scroll tests as failing.
        https://bugs.webkit.org/show_bug.cgi?id=170153

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Remove failure expectation for media/modern-media-controls/media-controller/media-controller-scale-factor-audio.html.

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-03-28  Youenn Fablet  <youenn@apple.com>

        Stop RTCDataChannel when closing page
        https://bugs.webkit.org/show_bug.cgi?id=170166

        Reviewed by Eric Carlson.

        * webrtc/datachannel/datachannel-gc-expected.txt: Added.
        * webrtc/datachannel/datachannel-gc.html: Added.

2017-03-28  Antoine Quint  <graouts@apple.com>

        REGRESSION (r214386): [ios-simulator] LayoutTest media/modern-media-controls/media-controller/media-controller-scale-factor-audio.html is failing
        https://bugs.webkit.org/show_bug.cgi?id=170180

        Unreviewed. Restore a value that was mistakenly changed in the fix for webkit.org/b/169962.

        * media/modern-media-controls/media-controller/media-controller-scale-factor-audio-expected.txt:
        * media/modern-media-controls/media-controller/media-controller-scale-factor-audio.html:

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/history/ios/history-scroll-restoration.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=169558

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/media-controller/media-controller-scale-factor-audio.html as failing on ios-simulator.
        https://bugs.webkit.org/show_bug.cgi?id=170180

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-03-28  Youenn Fablet  <youenn@apple.com>

        LayoutTest webrtc/video-getParameters.html is failing
        https://bugs.webkit.org/show_bug.cgi?id=170148

        Unreviewed.

        * TestExpectations: Marking webrtc/video-getParameters.html as failing.

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark webrtc/video-replace-track-to-null.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170178

        Unreviewed test gardening.

        * TestExpectations:

2017-03-28  Jonathan Bedard  <jbedard@apple.com>

        Moved gardened ios-simulator tests to ios folders
        <rdar://problem/30948691>

        Unreviewed test re-organization.

        Moving ios-simulator test expectations to share as many expectations
        as possible with on-device testing.

        * platform/ios: Moved from platform/ios-simulator.
        * platform/ios-device: Added.
        * platform/ios-device-wk1: Added.
        * platform/ios-device-wk2: Added.
        * platform/ios-simulator: Moved to platform/ios.
        * platform/ios-simulator-wk1: Moved to platform/ios-wk1.
        * platform/ios-simulator-wk2: Moved to platform/ios-wk2.
        * platform/ios-wk1: Moved from platform/ios-simulator-wk1.
        * platform/ios-wk2: Moved from platform/ios-simulator-wk2.

2017-03-28  Yoav Weiss  <yoav@yoav.ws>

        Add a warning for unused link preloads.
        https://bugs.webkit.org/show_bug.cgi?id=165670

        Reviewed by Youenn Fablet.

        * TestExpectations: Added a "Failure Pass" for the flaky charset header test.
        * http/tests/preload/download_resources-expected.txt:
        * http/tests/preload/download_resources.html: Added references to preloaded resources.
        * http/tests/preload/onerror_event-expected.txt:
        * http/tests/preload/onerror_event.html: Added references to preloaded resources.
        * http/tests/preload/onload_event-expected.txt:
        * http/tests/preload/onload_event.html: Added references to preloaded resources.
        * http/tests/preload/single_download_preload.html: Deflaked.
        * http/tests/preload/single_download_preload_headers.php: Removed the charset to avoid double download bug.
        * http/tests/preload/single_download_preload_headers_charset-expected.txt: Added.
        * http/tests/preload/single_download_preload_headers_charset.php: Flaky test showing the double download bug when charset is declared.
        * http/tests/preload/unused_preload_warning-expected.txt: Added.
        * http/tests/preload/unused_preload_warning.html: Added.

2017-03-28  Antoine Quint  <graouts@apple.com>

        REGRESSION: Double-clicking the captions button while the captions popover is open prevents the popover from being opened again
        https://bugs.webkit.org/show_bug.cgi?id=170171
        <rdar://problem/31095500>

        Reviewed by Dean Jackson.

        Adding a new test that runs the steps to reproduce the issue, and rebaselining an existing one now that
        the "presented" property returns false immediately after calling hide() on the panel.

        * media/modern-media-controls/tracks-panel/tracks-panel-hide-expected.txt:
        * media/modern-media-controls/tracks-panel/tracks-panel-hide.html:
        * media/modern-media-controls/tracks-support/tracks-support-show-panel-then-double-click-on-tracks-button-expected.txt: Added.
        * media/modern-media-controls/tracks-support/tracks-support-show-panel-then-double-click-on-tracks-button.html: Added.

2017-03-28  Aaron Chu  <aaron_chu@apple.com>

        AX: Media controls should be able to be re-activated after faded away
        https://bugs.webkit.org/show_bug.cgi?id=170048
        <rdar://problem/30157179>

        Reviewed by Antoine Quint.

        * media/modern-media-controls/media-controls/media-controls-appear-when-focus-expected.txt: Added.
        * media/modern-media-controls/media-controls/media-controls-appear-when-focus.html: Added.

2017-03-28  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] Improve media documents across macOS, iPhone and iPad
        https://bugs.webkit.org/show_bug.cgi?id=169145
        <rdar://problem/17048858>

        Reviewed by Dean Jackson.

        We add new tests for media documents and related features that cover the following cases:
        
            - checking <video> with only audio tracks does not show the fullscreen button
            - checking <video> with only audio tracks does not show the picture-in-picture button
            - checking the size used in media documents for audio and video across macOS, iPhone and iPad

        * media/modern-media-controls/fullscreen-support/fullscreen-support-disabled-video-with-audio-tracks-only-expected.txt: Added.
        * media/modern-media-controls/fullscreen-support/fullscreen-support-disabled-video-with-audio-tracks-only.html: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-audio-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-audio-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-video-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-video-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-audio-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-audio-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-audio-mac-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-audio-mac-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-video-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-video-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-video-mac-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-video-mac-sizing.html: Added.
        * media/modern-media-controls/pip-support/pip-support-disabled-video-with-audio-tracks-only-expected.txt: Added.
        * media/modern-media-controls/pip-support/pip-support-disabled-video-with-audio-tracks-only.html: Added.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-03-27  Said Abou-Hallawa  <sabouhallawa@apple.com>

        REGRESSION(213764): Large images should not be decoded asynchronously when they are drawn on a canvas
        https://bugs.webkit.org/show_bug.cgi?id=169771

        Reviewed by Simon Fraser.

        * fast/images/animated-image-different-dest-size-expected.html: Added.
        * fast/images/animated-image-different-dest-size.html: Added.
        This test crashes without this patch.

        * fast/images/animated-image-loop-count.html:
        Clear the memory cache so the test can be not flaky. Running it with -repeat-each was failing.

        * fast/images/async-image-background-image-expected.html: Added.
        * fast/images/async-image-background-image.html: Added.
        Ensures the background image can be drawn asynchronously if it is large.

        * fast/images/async-image-canvas-draw-image-expected.html: Added.
        * fast/images/async-image-canvas-draw-image.html: Added.
        Ensures the image is drawn synchronously on the canvas regardless of its size.

        * fast/images/ordered-animated-image-frames.html:
        Clear the memory cache so the test can be not flaky. Running it with -repeat-each was failing.

        * fast/images/reset-image-animation-expected.txt:
        * fast/images/reset-image-animation.html:
        Change how the steps of the test are ordered so the test can be not flaky.
        Running it with -repeat-each was failing.

        * fast/images/resources/red-green-blue-900-300.png: Added.

2017-03-27  Youenn Fablet  <youenn@apple.com>

        addIceCandidate should not throw if passed null or undefined
        https://bugs.webkit.org/show_bug.cgi?id=170118

        Reviewed by Eric Carlson.

        Updating test to log addIceCandidate rejection.

        * webrtc/datachannel/basic.html:
        * webrtc/routines.js:
        (iceCallback1):
        (iceCallback2):
        (onAddIceCandidateError):

2017-03-27  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline svg/css/getComputedStyle-basic.xhtml for macOS.

        Unreviewed test gardening.

        * platform/mac-elcapitan/svg/css/getComputedStyle-basic-expected.txt: Added.
        * platform/mac/svg/css/getComputedStyle-basic-expected.txt: Added.

2017-03-27  Antti Koivisto  <antti@apple.com>

        Loading in-body stylesheets should not block rendering of elements before them
        https://bugs.webkit.org/show_bug.cgi?id=169345

        Reviewed by Simon Fraser.

        * http/tests/incremental/resources/delayed-css.php: Added.
        * http/tests/incremental/stylesheet-body-incremental-rendering-expected.html: Added.
        * http/tests/incremental/stylesheet-body-incremental-rendering.html: Added.

2017-03-27  Myles C. Maxfield  <mmaxfield@apple.com>

        Test variation font ranges in the CSS Font Loading API
        https://bugs.webkit.org/show_bug.cgi?id=170022

        Reviewed by Dean Jackson.

        * fast/text/variations/font-loading-api-parse-ranges-expected.txt: Added.
        * fast/text/variations/font-loading-api-parse-ranges.html: Added.

2017-03-27  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r214411.

        Two of the LayoutTests for this change time out on ios-
        simulator.

        Reverted changeset:

        "[Modern Media Controls] Improve media documents across macOS,
        iPhone and iPad"
        https://bugs.webkit.org/show_bug.cgi?id=169145
        http://trac.webkit.org/changeset/214411

2017-03-27  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] Clicking on the tracks button when the tracks panel is up in a media document pauses the video
        https://bugs.webkit.org/show_bug.cgi?id=168517
        <rdar://problem/30577636>

        Reviewed by Dean Jackson.

        * media/video-click-dblckick-standalone.html: We disable modern-media-controls here since we know that this test won't pass with them on.

2017-03-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/time-label/time-label-white-space-nowrap.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=169679

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-03-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark inspector/dom-debugger/dom-breakpoints.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170127

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-03-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/time-label/time-label.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=169678

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-03-27  Ryan Haddad  <ryanhaddad@apple.com>

        Marking two modern-media-controls tests as timeouts.
        https://bugs.webkit.org/show_bug.cgi?id=170123

        Unreviewed test gardening.

        * platform/ios-simulator/TestExpectations:

2017-03-27  Youenn Fablet  <youenn@apple.com>

        Tighten RTCDatachannel creation and parameter getters
        https://bugs.webkit.org/show_bug.cgi?id=170081

        Reviewed by Eric Carlson.

        * webrtc/datachannel/basic-expected.txt:
        * webrtc/datachannel/basic.html:

2017-03-27  Youenn Fablet  <youenn@apple.com>

        Add support for RTCRtpReceiver/RTCRtpSender getParameters
        https://bugs.webkit.org/show_bug.cgi?id=170057

        Reviewed by Alex Christensen.

        * webrtc/video-getParameters-expected.txt: Added.
        * webrtc/video-getParameters.html: Added.

2017-03-27  Myles C. Maxfield  <mmaxfield@apple.com>

        font variation properties don't need to accept numbers
        https://bugs.webkit.org/show_bug.cgi?id=169357

        Reviewed by Antti Koivisto.

        * fast/text/font-selection-font-face-parse-expected.txt:
        * fast/text/font-selection-font-face-parse.html:
        * fast/text/font-selection-font-loading-api-parse-expected.txt:
        * fast/text/font-selection-font-loading-api-parse.html:
        * fast/text/font-stretch-parse-expected.txt:
        * fast/text/font-stretch-parse.html:
        * fast/text/font-style-parse-expected.txt:
        * fast/text/font-style-parse.html:
        * fast/text/variations/font-selection-properties.html:
        * platform/mac-elcapitan/fast/text/font-selection-font-face-parse-expected.txt:

2017-03-27  Myles C. Maxfield  <mmaxfield@apple.com>

        Implement format specifier for variation fonts
        https://bugs.webkit.org/show_bug.cgi?id=169327

        Reviewed by Simon Fraser.

        * fast/text/variations/font-face-format-expected.html: Added.
        * fast/text/variations/font-face-format.html: Added.

2017-03-27  Myles C. Maxfield  <mmaxfield@apple.com>

        Make sure animation works for font-weight, font-stretch, and font-style
        https://bugs.webkit.org/show_bug.cgi?id=169683

        Reviewed by Simon Fraser.

        * animations/font-variations/font-stretch-expected.txt: Added.
        * animations/font-variations/font-stretch.html: Added.
        * animations/font-variations/font-style-expected.txt: Added.
        * animations/font-variations/font-style.html: Added.
        * animations/font-variations/font-weight-expected.txt: Added.
        * animations/font-variations/font-weight.html: Added.
        * animations/resources/animation-test-helpers.js:
        (compareFontStyle):
        (getPropertyValue):
        (comparePropertyValue):

2017-03-27  Alex Christensen  <achristensen@webkit.org>

        Make WebSockets work in network process
        https://bugs.webkit.org/show_bug.cgi?id=169930

        Reviewed by Youenn Fablet.

        * http/tests/websocket/tests/hybi/network-process-crash-error-expected.txt: Added.
        * http/tests/websocket/tests/hybi/network-process-crash-error.html: Added.
        * http/tests/websocket/tests/hybi/slow-reply_wsh.py: Added.
        (web_socket_do_extra_handshake):
        (web_socket_transfer_data):
        * platform/ios-simulator-wk1/TestExpectations:
        * platform/mac-wk1/TestExpectations:
        * platform/win/TestExpectations:

2017-03-27  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] Improve media documents across macOS, iPhone and iPad
        https://bugs.webkit.org/show_bug.cgi?id=169145
        <rdar://problem/17048858>

        Reviewed by Dean Jackson.

        We add new tests for media documents and related features that cover the following cases:
        
            - checking <video> with only audio tracks does not show the fullscreen button
            - checking <video> with only audio tracks does not show the picture-in-picture button
            - checking the size used in media documents for audio and video across macOS, iPhone and iPad

        * media/modern-media-controls/fullscreen-support/fullscreen-support-disabled-video-with-audio-tracks-only-expected.txt: Added.
        * media/modern-media-controls/fullscreen-support/fullscreen-support-disabled-video-with-audio-tracks-only.html: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-audio-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-audio-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-video-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-video-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-audio-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-audio-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-audio-mac-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-audio-mac-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-video-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-video-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-video-mac-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-video-mac-sizing.html: Added.
        * media/modern-media-controls/pip-support/pip-support-disabled-video-with-audio-tracks-only-expected.txt: Added.
        * media/modern-media-controls/pip-support/pip-support-disabled-video-with-audio-tracks-only.html: Added.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-03-25  Aaron Chu  <aaron_chu@apple.com>

        AX: Media controls are unlabeled
        https://bugs.webkit.org/show_bug.cgi?id=169947
        <rdar://problem/30153323>

        Reviewed by Antoine Quint.

        * media/modern-media-controls/airplay-button/airplay-button-expected.txt:
        * media/modern-media-controls/airplay-button/airplay-button.html:
        * media/modern-media-controls/forward-button/forward-button-expected.txt:
        * media/modern-media-controls/forward-button/forward-button.html:
        * media/modern-media-controls/fullscreen-button/fullscreen-button-expected.txt:
        * media/modern-media-controls/fullscreen-button/fullscreen-button.html:
        * media/modern-media-controls/icon-button/icon-button-expected.txt:
        * media/modern-media-controls/icon-button/icon-button.html:
        * media/modern-media-controls/icon-service/icon-service-expected.txt:
        * media/modern-media-controls/icon-service/icon-service.html:
        * media/modern-media-controls/mute-button/mute-button-expected.txt:
        * media/modern-media-controls/mute-button/mute-button.html:
        * media/modern-media-controls/pip-button/pip-button-expected.txt:
        * media/modern-media-controls/pip-button/pip-button.html:
        * media/modern-media-controls/play-pause-button/play-pause-button-expected.txt:
        * media/modern-media-controls/play-pause-button/play-pause-button.html:
        * media/modern-media-controls/rewind-button/rewind-button-expected.txt:
        * media/modern-media-controls/rewind-button/rewind-button.html:
        * media/modern-media-controls/skip-back-button/skip-back-button-expected.txt:
        * media/modern-media-controls/skip-back-button/skip-back-button.html:
        * media/modern-media-controls/start-button/start-button-expected.txt:
        * media/modern-media-controls/start-button/start-button.html:
        * media/modern-media-controls/tracks-button/tracks-button-expected.txt:
        * media/modern-media-controls/tracks-button/tracks-button.html:

2017-03-25  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of several tests.

        * platform/gtk/TestExpectations:

2017-03-25  Myles C. Maxfield  <mmaxfield@apple.com>

        Post-commit test fix after r214394
        https://bugs.webkit.org/show_bug.cgi?id=170083

        Unreviewed.

        * fast/text/variations/optical-sizing.html:

2017-03-24  Myles C. Maxfield  <mmaxfield@apple.com>

        Add font-optical-sizing to CSSComputedStyleDeclaration
        https://bugs.webkit.org/show_bug.cgi?id=170083

        Reviewed by Joseph Pecoraro.

        * fast/css/getComputedStyle/computed-style-expected.txt:
        * fast/css/getComputedStyle/computed-style-font-family-expected.txt:
        * fast/css/getComputedStyle/computed-style-without-renderer-expected.txt:
        * fast/css/getComputedStyle/resources/property-names.js:
        * fast/text/variations/optical-sizing-expected.txt:
        * fast/text/variations/optical-sizing.html:
        * platform/mac-elcapitan/fast/css/getComputedStyle/computed-style-expected.txt: Added.
        * platform/mac-elcapitan/fast/css/getComputedStyle/computed-style-font-family-expected.txt: Added.
        * platform/mac-elcapitan/fast/css/getComputedStyle/computed-style-without-renderer-expected.txt: Added.

2017-03-24  Ryan Haddad  <ryanhaddad@apple.com>

        Consolidate TestExpectations for media/restore-from-page-cache.html.

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-03-24  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r214361.

        This change caused flakiness in http/tests/preload tests.

        Reverted changeset:

        "Add a warning for unused link preloads."
        https://bugs.webkit.org/show_bug.cgi?id=165670
        http://trac.webkit.org/changeset/214361

2017-03-24  Antoine Quint  <graouts@webkit.org>

        [Modern Media Controls] Remove placard icon if height is compressed
        https://bugs.webkit.org/show_bug.cgi?id=167935
        <rdar://problem/30397128>

        Reviewed by Dean Jackson.

        We add a new test to check that the various designed constraints to toggle display of a placard's
        icon, title and description are honored. Also, due to the old layout() method now being called
        "commit()", we refactor a relevant test.

        * media/modern-media-controls/layout-node/node-made-dirty-during-commit-expected.txt: Added.
        * media/modern-media-controls/layout-node/node-made-dirty-during-commit.html: Added.
        * media/modern-media-controls/media-controls/media-controls-placard-compressed-metrics-expected.txt: Added.
        * media/modern-media-controls/media-controls/media-controls-placard-compressed-metrics.html: Added.

2017-03-24  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] "ideal" constraints passed to getUserMedia should affect fitness score
        https://bugs.webkit.org/show_bug.cgi?id=170056

        Reviewed by Youenn Fablet.

        * fast/mediastream/MediaStream-video-element-displays-buffer-expected.txt:
        * fast/mediastream/MediaStream-video-element-displays-buffer.html:
        * fast/mediastream/MediaStreamTrack-getCapabilities-expected.txt:
        * fast/mediastream/apply-constraints-advanced-expected.txt:
        * fast/mediastream/apply-constraints-advanced.html:
        * fast/mediastream/apply-constraints-video-expected.txt:
        * fast/mediastream/apply-constraints-video.html:

2017-03-24  Dean Jackson  <dino@apple.com>

        Serialization of custom props in longhand should be "" not value of shorthand
        https://bugs.webkit.org/show_bug.cgi?id=167699
        <rdar://problem/30324200>

        Reviewed by Sam Weinig.

        * fast/css/variables/rule-property-get-expected.html:
        * fast/css/variables/rule-property-get.html:

2017-03-24  Antoine Quint  <graouts@webkit.org>

        [Modern Media Controls] Captions don't move with the appearance of the inline controls
        https://bugs.webkit.org/show_bug.cgi?id=170051
        <rdar://problem/30754428>

        Reviewed by Dean Jackson.

        Add a new test, which would have previously failed, where we check that we account for the controls bar height
        when showing captions with the controls bar visible.

        * media/modern-media-controls/tracks-support/tracks-support-captions-offset-with-controls-bar-expected.txt: Added.
        * media/modern-media-controls/tracks-support/tracks-support-captions-offset-with-controls-bar.html: Added.

2017-03-24  Brent Fulgham  <bfulgham@apple.com>

        Handle recursive calls to ProcessingInstruction::checkStyleSheet
        https://bugs.webkit.org/show_bug.cgi?id=169982
        <rdar://problem/31083051>

        Reviewed by Antti Koivisto.

        * fast/dom/beforeload/image-removed-during-before-load-expected.txt: Copied from LayoutTests/fast/dom/beforeload/image-removed-during-before-load-expected.txt.
        * fast/dom/beforeload/image-removed-during-before-load.html: Copied from LayoutTests/fast/dom/beforeload/image-removed-during-before-load.html.
        * fast/dom/beforeload/recursive-css-pi-before-load-expected.txt: Copied from LayoutTests/fast/dom/beforeload/recursive-css-pi-before-load-expected.txt.
        * fast/dom/beforeload/recursive-css-pi-before-load.html: Copied from LayoutTests/fast/dom/beforeload/recursive-css-pi-before-load.html.
        * fast/dom/beforeload/recursive-link-before-load-expected.txt: Copied from LayoutTests/fast/dom/beforeload/recursive-link-before-load-expected.txt.
        * fast/dom/beforeload/recursive-link-before-load.html: Copied from LayoutTests/fast/dom/beforeload/recursive-link-before-load.html.
        * fast/dom/beforeload/recursive-xsl-pi-before-load-expected.txt: Copied from LayoutTests/fast/dom/beforeload/recursive-xsl-pi-before-load-expected.txt.
        * fast/dom/beforeload/recursive-xsl-pi-before-load.html: Copied from LayoutTests/fast/dom/beforeload/recursive-xsl-pi-before-load.html.
        * fast/dom/beforeload/resources/content.xhtml: Copied from LayoutTests/fast/dom/beforeload/resources/content.xhtml.
        * fast/dom/beforeload/resources/pass.css: Copied from LayoutTests/fast/dom/beforeload/resources/pass.css.
        * fast/dom/beforeload/resources/test.xsl: Copied from LayoutTests/fast/dom/beforeload/resources/test.xsl.

2017-03-24  Brady Eidson  <beidson@apple.com>

        A null compound index value crashes the Databases process.
        <rdar://problem/30499831> and https://bugs.webkit.org/show_bug.cgi?id=170000

        Reviewed by Alex Christensen.

        * storage/indexeddb/modern/resources/single-entry-index-invalid-key-crash.js: Added.
        * storage/indexeddb/modern/single-entry-index-invalid-key-crash-expected.txt: Added.
        * storage/indexeddb/modern/single-entry-index-invalid-key-crash-private-expected.txt: Added.
        * storage/indexeddb/modern/single-entry-index-invalid-key-crash-private.html: Added.
        * storage/indexeddb/modern/single-entry-index-invalid-key-crash.html: Added.

2017-03-24  Ryan Haddad  <ryanhaddad@apple.com>

        Skip svg/animations/animations-paused-when-inserted-in-hidden-document* tests on ios-simulator.
        https://bugs.webkit.org/show_bug.cgi?id=170068

        Unreviewed test gardening.

        * platform/ios-simulator/TestExpectations:

2017-03-24  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r214360.

        This change caused 20+ LayoutTest failures.

        Reverted changeset:

        "Handle recursive calls to
        ProcessingInstruction::checkStyleSheet"
        https://bugs.webkit.org/show_bug.cgi?id=169982
        http://trac.webkit.org/changeset/214360

2017-03-24  Youenn Fablet  <youenn@apple.com>

        Add support for qpSum in WebRTC stats
        https://bugs.webkit.org/show_bug.cgi?id=170060

        Reviewed by Eric Carlson.

        * webrtc/video-stats.html:

2017-03-24  Daniel Bates  <dabates@apple.com>

        Prevent new navigations during document unload
        https://bugs.webkit.org/show_bug.cgi?id=169934
        <rdar://problem/31247584>

        Reviewed by Chris Dumez.

        Add a test to ensure that we do not cause an assertion fail when calling setTimeout
        after starting a navigation from an onunload event handler.

        * fast/frames/frame-unload-navigate-and-setTimeout-assert-fail-expected.txt: Added.
        * fast/frames/frame-unload-navigate-and-setTimeout-assert-fail.html: Added.

2017-03-24  Myles C. Maxfield  <mmaxfield@apple.com>

        Implement font-optical-sizing
        https://bugs.webkit.org/show_bug.cgi?id=168895

        Reviewed by Dean Jackson.

        * fast/text/variations/optical-sizing-expected.txt: Added.
        * fast/text/variations/optical-sizing.html: Added.

2017-03-24  Yoav Weiss  <yoav@yoav.ws>

        Add a warning for unused link preloads.
        https://bugs.webkit.org/show_bug.cgi?id=165670

        Reviewed by Youenn Fablet.

        This adds a test for the unused preload warning, and adapts some of the other preload tests,
        to avoid warnings.

        * http/tests/preload/download_resources-expected.txt: Changed.
        * http/tests/preload/download_resources.html: Added references to preloaded resources.
        * http/tests/preload/onerrer_event-expected.txt: Changed.
        * http/tests/preload/onerror_event.html: Added references to preloaded resources.
        * http/tests/preload/onload_event.html: Added references to preloaded resources.
        * http/tests/preload/resources/single_download_preload.html: Deflaked.
        * http/tests/preload/unused_preload_warning-expected.txt: Added.
        * http/tests/preload/unused_preload_warning.html: Added.

2017-03-24  Brent Fulgham  <bfulgham@apple.com>

        Handle recursive calls to ProcessingInstruction::checkStyleSheet
        https://bugs.webkit.org/show_bug.cgi?id=169982
        <rdar://problem/31083051>

        Reviewed by Antti Koivisto.

        * fast/dom/beforeload/image-removed-during-before-load-expected.txt: Added.
        * fast/dom/beforeload/image-removed-during-before-load.html: Added.
        * fast/dom/beforeload/recursive-css-pi-before-load-expected.txt: Added.
        * fast/dom/beforeload/recursive-css-pi-before-load.html: Added.
        * fast/dom/beforeload/recursive-link-before-load-expected.txt: Added.
        * fast/dom/beforeload/recursive-link-before-load.html: Added.
        * fast/dom/beforeload/recursive-xsl-pi-before-load-expected.txt: Added.
        * fast/dom/beforeload/recursive-xsl-pi-before-load.html: Added.
        * fast/dom/beforeload/resources/content.xhtml: Added.
        * fast/dom/beforeload/resources/pass.css: Added.
        * fast/dom/beforeload/resources/test.xsl: Added.

2017-03-24  Myles C. Maxfield  <mmaxfield@apple.com>

        font-style needs a new CSSValue to make CSSRule.cssText work correctly
        https://bugs.webkit.org/show_bug.cgi?id=169258

        Reviewed by David Hyatt.

        Update tests' expected results.

        * fast/text/font-selection-font-face-parse-expected.txt:
        * fast/text/font-selection-font-face-parse.html:
        * fast/text/font-style-parse-expected.txt:
        * fast/text/font-style-parse.html:
        * platform/mac-elcapitan/fast/text/font-selection-font-face-parse-expected.txt:
        * svg/css/getComputedStyle-basic-expected.txt:

2017-03-24  Youenn Fablet  <youenn@apple.com>

        Add libwebrtc backend support for RTCRtpSender::replaceTrack
        https://bugs.webkit.org/show_bug.cgi?id=169841

        Reviewed by Alex Christensen.

        * webrtc/audio-replace-track-expected.txt: Added.
        * webrtc/audio-replace-track.html: Added.
        * webrtc/video-replace-track-expected.txt: Added.
        * webrtc/video-replace-track.html: Added.
        * webrtc/video-replace-track-to-null-expected.txt: Added.
        * webrtc/video-replace-track-to-null.html: Added.

2017-03-24  Ryan Haddad  <ryanhaddad@apple.com>

        Update TestExpectations for media/restore-from-page-cache.html.

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:
        * platform/mac/TestExpectations:

2017-03-24  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Mark webrtc/video-stats.html as failing.

        * platform/gtk/TestExpectations:

2017-03-24  Youenn Fablet  <youenn@apple.com>

        Add support for DataChannel and MediaStreamTrack stats
        https://bugs.webkit.org/show_bug.cgi?id=170031

        Reviewed by Eric Carlson.

        * webrtc/datachannel/datachannel-stats-expected.txt: Added.
        * webrtc/datachannel/datachannel-stats.html: Added.
        * webrtc/video-mediastreamtrack-stats-expected.txt: Added.
        * webrtc/video-mediastreamtrack-stats.html: Added.

2017-03-24  Chris Dumez  <cdumez@apple.com>

        Extend svg/animations/animations-paused-disconnected-iframe.html
        https://bugs.webkit.org/show_bug.cgi?id=170035

        Reviewed by Andreas Kling.

        Extend svg/animations/animations-paused-disconnected-iframe.html to cover more things.

        * svg/animations/animations-paused-disconnected-iframe-expected.txt:
        * svg/animations/animations-paused-disconnected-iframe.html:

2017-03-24  Youenn Fablet  <youenn@apple.com>

        Fix framesEncoded/framesDecoded RTC stats
        https://bugs.webkit.org/show_bug.cgi?id=170024

        Reviewed by Eric Carlson.

        * webrtc/video-stats-expected.txt: Added.
        * webrtc/video-stats.html: Added.

2017-03-24  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Mark media/video-load-require-user-gesture.html as failing after r214338.

        * platform/gtk/TestExpectations:

2017-03-24  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Rebaseline http/tests/inspector/network/fetch-response-body.html/xhr-response-body.html after r214338.

        We are now getting the right application/json for a file data.json. The soup network backend tries to gess the
        mime type from the extension when sniffing is not allowed and the mime type is not known. See bug
        webkit.org/b/168299, that was added actually to fix these tests, but at that time we also failed to guess the
        mime type and returned application/octet-stream.

        * platform/gtk/TestExpectations:
        * platform/gtk/http/tests/inspector/network/fetch-response-body-expected.txt: Added.
        * platform/gtk/http/tests/inspector/network/xhr-response-body-expected.txt: Added.

2017-03-24  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Rebaseline fast/dom/HTMLAnchorElement/anchor-file-blob-convert-to-download.html after r214338.

        We are now getting a MIME type for otf files.

        * platform/gtk/fast/dom/HTMLAnchorElement/anchor-file-blob-convert-to-download-expected.txt: Added.

2017-03-24  Per Arne Vollan  <pvollan@apple.com>

        Text stroke is sometimes clipped on video captions.
        https://bugs.webkit.org/show_bug.cgi?id=170006

        Reviewed by Eric Carlson.

        * media/track/track-css-stroke-cues-expected.txt:
        * media/track/track-css-stroke-cues.html:

2017-03-24  Carlos Garcia Campos  <cgarcia@igalia.com>

        [GTK] Add MIMETypeRegistry implementation using xdgmime and remove the GTK+ one
        https://bugs.webkit.org/show_bug.cgi?id=170001

        Reviewed by Michael Catanzaro.

        Remove platform specific expectations of two test because now we do the same as other wk2 ports.

        * platform/gtk/TestExpectations:

2017-03-23  Antti Koivisto  <antti@apple.com>

        Revert r213712, caused iPad PLT regression
        https://bugs.webkit.org/show_bug.cgi?id=170040

        Unreviewed.

        * http/tests/incremental/stylesheet-body-incremental-rendering-expected.html: Removed.
        * http/tests/incremental/stylesheet-body-incremental-rendering.html: Removed.

2017-03-23  Chris Dumez  <cdumez@apple.com>

        SVG animations are not paused when their <svg> element is removed from the document
        https://bugs.webkit.org/show_bug.cgi?id=170030
        <rdar://problem/31230252>

        Reviewed by Dean Jackson.

        Add layout test coverage.

        * svg/animations/animations-paused-when-removed-from-document-expected.txt: Added.
        * svg/animations/animations-paused-when-removed-from-document.html: Added.

2017-03-22  Myles C. Maxfield  <mmaxfield@apple.com>

        font shorthand should accept variation values
        https://bugs.webkit.org/show_bug.cgi?id=168998

        Reviewed by Simon Fraser.

        * fast/text/font-style-parse-expected.txt:
        * fast/text/font-style-parse.html:
        * fast/text/font-weight-parse-expected.txt:
        * fast/text/font-weight-parse.html:

2017-03-23  Chris Dumez  <cdumez@apple.com>

        SVG animations are not paused when inserted into a hidden page
        https://bugs.webkit.org/show_bug.cgi?id=170026
        <rdar://problem/31228704>

        Reviewed by Andreas Kling.

        Add layout test coverage.

        * svg/animations/animations-paused-when-inserted-in-hidden-document-expected.txt: Added.
        * svg/animations/animations-paused-when-inserted-in-hidden-document.html: Added.
        * svg/animations/animations-paused-when-inserted-in-hidden-document2-expected.txt: Added.
        * svg/animations/animations-paused-when-inserted-in-hidden-document2.html: Added.

== Rolled over to ChangeLog-2017-03-23 ==
