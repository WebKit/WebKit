<!-- webkit-test-runner [ enableMetalDebugDevice=true ] -->
<script>
async function run() {
    let adapter = await navigator.gpu.requestAdapter();
    let device = await adapter.requestDevice({ requiredFeatures: [ 'texture-compression-etc2' ] })
    let texture = device.createTexture({ size: { width: 400, height: 60 }, mipLevelCount: 2, format: 'etc2-rgb8unorm-srgb', usage: GPUTextureUsage.COPY_DST })
    device.queue.writeTexture({ texture: texture, mipLevel: 1 }, new Uint8Array(186_828), { bytesPerRow: 84 }, { width: 4, height: 32 });
}
globalThis.testRunner?.waitUntilDone();
run().then(() => globalThis.testRunner?.notifyDone());
</script>
