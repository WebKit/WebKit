<!DOCTYPE html>
<html>
<head>
    <script src="/js-test-resources/js-test.js"></script>
    <script src="/js-test-resources/ui-helper.js"></script>
    <script>
        description("Tests that the app-bound-request context string gets properly set for an iframe");
        jsTestIsAsync = true;

        var subFrameHost = "localhost";
        var contextHost = "127.0.0.1";
        function askForContextStringForSubFrame() {
            testRunner.appBoundRequestContextDataForDomain(subFrameHost, function (contextData) {
                if (contextData == null) {
                    askForContextStringForSubFrame();
                    return;
                }

                if (contextData == contextHost)
                    testPassed("Context string for sub frame correctly captured.");
                else
                    testFailed("Context string for sub frame NOT correctly captured.");

                finishJSTest();
            });
        }
    </script>
</head>
<body>
<iframe onload="setTimeout('askForContextStringForSubFrame()', 0)" src="http://localhost:8000/in-app-browser-privacy/resources/basic-iframe.html">
</iframe>
</body>
</html>
